import{d as _,r as t,j as e,a as C,D as H,p as W,q,s as J,S as z,t as G,L as E,v as x,T as K,x as Q,y as f,z as b,G as y,H as v,I as N,J as k,K as S,A as X,w as R,F as T,M as $,O as Y,Q as Z}from"./globals-DXaPY4QX.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=_("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=_("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),B=t.forwardRef(({className:r,...c},n)=>e.jsx("div",{ref:n,className:C("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","border-transparent bg-primary text-secondary-foreground hover:bg-primary/80",r),...c}));B.displayName="Badge";function ae({open:r,onOpenChange:c,logSnippet:n}){const[g,h]=t.useState(!1),[l,m]=t.useState(null);t.useEffect(()=>{r&&n&&p()},[r,n]);const p=async()=>{h(!0),m(null);const o=window.sbwpData||window.sbwpRecoveryData;try{const u=await(await fetch(`${o.restUrl}/ai/analyze`,{method:"POST",headers:{"X-WP-Nonce":o.nonce,"Content-Type":"application/json"},body:JSON.stringify({log_snippet:n})})).json();setTimeout(()=>{m(u.analysis),h(!1)},1500)}catch(d){console.error(d),h(!1)}};return e.jsx(H,{open:r,onOpenChange:c,children:e.jsxs(W,{className:"sm:max-w-[500px]",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-indigo-500"}),"AI Error Analysis"]}),e.jsx(G,{children:"Asking our virtual expert to interpret this error log..."})]}),e.jsx("div",{className:"py-4",children:g?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"h-12 w-12 text-indigo-200"}),e.jsx(E,{className:"h-6 w-6 absolute -bottom-1 -right-1 animate-spin text-indigo-600"})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"font-medium text-indigo-900 dark:text-indigo-100",children:"Analyzing Code..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Identifying patterns and known conflicts"})]})]}):l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 p-4 rounded-lg border border-indigo-100 dark:border-indigo-900",children:[e.jsx("h3",{className:"font-semibold text-indigo-900 dark:text-indigo-200 mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm text-indigo-800 dark:text-indigo-300",children:l.summary})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-muted-foreground",children:"Root Cause"}),e.jsx("p",{className:"text-sm",children:l.cause})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-bold uppercase tracking-wider text-muted-foreground",children:"Suggested Fix"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-emerald-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm",children:l.solution})]})]})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsx(x,{onClick:()=>c(!1),children:"Close Analysis"})})]}):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No analysis available."})})]})})}function te(){const[r,c]=t.useState("restore"),[n,g]=t.useState(!1),[h,l]=t.useState([]),[m,p]=t.useState(!1),[o,d]=t.useState(""),[u,I]=t.useState(""),[j,L]=t.useState(!1),[U,D]=t.useState(!1);t.useEffect(()=>{r==="plugins"?A():r==="logs"&&P()},[r]);const A=async()=>{p(!0);const s=new URLSearchParams;s.append("action","sbwp_recovery_get_plugins"),s.append("nonce",window.sbwpRecoveryData.nonce);try{const a=await(await fetch(window.sbwpRecoveryData.ajaxUrl,{method:"POST",body:s})).json();a.success&&l(a.data)}catch(i){console.error(i)}finally{p(!1)}},O=async(s,i)=>{l(F=>F.map(w=>w.file===s?{...w,active:!i}:w));const a=new URLSearchParams;a.append("action","sbwp_recovery_toggle_plugin"),a.append("nonce",window.sbwpRecoveryData.nonce),a.append("plugin",s),a.append("plugin_action",i?"deactivate":"activate"),await fetch(window.sbwpRecoveryData.ajaxUrl,{method:"POST",body:a})},P=async()=>{L(!0);const s=new URLSearchParams;s.append("action","sbwp_recovery_get_log"),s.append("nonce",window.sbwpRecoveryData.nonce);try{const a=await(await fetch(window.sbwpRecoveryData.ajaxUrl,{method:"POST",body:s})).json();a.success?(d(a.data.content),I(a.data.size)):d(a.data)}catch{d("Failed to load logs.")}finally{L(!1)}},V=async()=>{if(!confirm("Are you sure? This will overwrite your database and files."))return;g(!0);const s=new URLSearchParams;s.append("action","sbwp_recovery_restore"),s.append("nonce",window.sbwpRecoveryData.nonce),s.append("backup_id","1");try{const a=await(await fetch(window.sbwpRecoveryData.ajaxUrl,{method:"POST",body:s})).json();a.success?(alert("Restore Complete!"),window.location.reload()):alert("Error: "+a.data)}catch{alert("Network Error")}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-50 p-8 flex items-start justify-center font-sans antialiased selection:bg-emerald-500/30",children:e.jsxs("div",{className:"w-full max-w-4xl space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight text-white flex items-center gap-2",children:[e.jsx(re,{className:"h-6 w-6 text-emerald-500"}),"Recovery Portal"]}),e.jsx("p",{className:"text-slate-400",children:"Safe Mode Active • Plugins Filtered"})]}),e.jsx(x,{variant:"outline",className:"border-slate-800 bg-slate-900 text-slate-200 hover:bg-slate-800 hover:text-white",onClick:()=>window.location.href="/wp-admin",children:"Exit to WP Admin"})]}),e.jsxs(K,{defaultValue:"restore",onValueChange:c,className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-3 bg-slate-900 border border-slate-800",children:[e.jsx(f,{value:"restore",children:"Restore Backup"}),e.jsx(f,{value:"plugins",children:"Plugin Manager"}),e.jsx(f,{value:"logs",children:"Debug Logs"})]}),e.jsx(b,{value:"restore",children:e.jsxs(y,{className:"bg-slate-900 border-slate-800 text-slate-200",children:[e.jsxs(v,{children:[e.jsx(N,{className:"text-white",children:"System Restore"}),e.jsx(k,{className:"text-slate-400",children:"Restore your site to a previous working state."})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border border-yellow-900/50 bg-yellow-900/10 p-4 text-yellow-200 flex items-start gap-4",children:[e.jsx(X,{className:"h-5 w-5 shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-bold mb-1",children:"Warning: Destructive Action"}),e.jsx("p",{children:"Restoring will overwrite your database and files. Any changes made since the backup will be lost."})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-slate-800 rounded-lg bg-slate-950/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Latest Local Backup"}),e.jsx("div",{className:"text-sm text-slate-500",children:"Dec 26, 2025 • 24.5 MB"})]}),e.jsxs(x,{onClick:V,disabled:n,className:"bg-emerald-600 hover:bg-emerald-500 text-white",children:[n?e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(R,{className:"mr-2 h-4 w-4"}),"Restore Now"]})]})]})]})}),e.jsx(b,{value:"plugins",children:e.jsxs(y,{className:"bg-slate-900 border-slate-800 text-slate-200",children:[e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-white",children:"Plugin Manager"}),e.jsx(x,{variant:"ghost",size:"sm",onClick:A,disabled:m,children:e.jsx(R,{className:C("h-4 w-4",m&&"animate-spin")})})]}),e.jsx(k,{className:"text-slate-400",children:"Disable problematic plugins to regain access to your site."})]}),e.jsx(S,{children:e.jsx(T,{className:"h-[400px] pr-4",children:e.jsx("div",{className:"space-y-2",children:h.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-slate-800 bg-slate-950/30",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-200",children:s.name}),e.jsx("div",{className:"text-xs text-slate-500",children:s.file})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:s.active?"bg-emerald-500/20 text-emerald-500 hover:bg-emerald-500/30":"bg-slate-800 text-slate-500 hover:bg-slate-700",children:s.active?"Active":"Inactive"}),e.jsx($,{checked:s.active,onCheckedChange:()=>O(s.file,s.active)})]})]},s.file))})})})]})}),e.jsx(b,{value:"logs",children:e.jsxs(y,{className:"bg-slate-900 border-slate-800 text-slate-200",children:[e.jsx(ae,{open:U,onOpenChange:D,logSnippet:o.slice(0,2e3)}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-white",children:"Debug Log"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",className:"border-indigo-500/50 text-indigo-400 hover:bg-indigo-500/10",onClick:()=>D(!0),disabled:!o,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Analyze with AI"]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:P,disabled:j,children:e.jsx(R,{className:C("h-4 w-4",j&&"animate-spin")})})]})]}),e.jsxs(k,{className:"text-slate-400",children:["Viewing ",u||"file",". Last 500 lines."]})]}),e.jsx(S,{children:e.jsx(T,{className:"h-[500px] w-full rounded-md border border-slate-800 bg-slate-950 p-4",children:e.jsx("pre",{className:"text-xs font-mono text-slate-300 whitespace-pre-wrap",children:j?"Loading...":o||"debug.log is empty or not found."})})})]})})]})]})})}function re(r){return e.jsxs("svg",{...r,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}document.documentElement.classList.add("dark");const M=document.getElementById("sbwp-recovery-root");M&&Y.createRoot(M).render(e.jsx(Z.StrictMode,{children:e.jsx(te,{})}));
