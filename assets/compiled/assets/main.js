import{r,j as e,c as Ke,a as U,b as Ts,d as T,D as ge,e as we,f as ye,g as je,h as Ee,L as z,B as S,R as He,S as Es,A as De,T as Rt,i as It,k as ds,l as us,m as At,n as Ft,C as G,o as Z,p as ee,q as ne,s as Y,t as Ne,u as Mt,P as oe,v as $t,w as Ot,x as Ds,y as Bt,z as Lt,E as zt,F as te,G as Pe,H as Ut,I as Wt,J as Vt,K as Xt,M as Kt,N as Ht,O as ms,Q as xs}from"./globals-BTwDIQrf.js";var qt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Jt=qt.reduce((s,t)=>{const a=Ke(`Primitive.${t}`),n=r.forwardRef((o,m)=>{const{asChild:i,...c}=o,h=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(h,{...c,ref:m})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{}),Gt="Label",_s=r.forwardRef((s,t)=>e.jsx(Jt.label,{...s,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=s.onMouseDown)==null||o.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));_s.displayName=Gt;var Rs=_s;const Yt=Ts("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),H=r.forwardRef(({className:s,...t},a)=>e.jsx(Rs,{ref:a,className:U(Yt(),s),...t}));H.displayName=Rs.displayName;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=T("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=T("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=T("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=T("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=T("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=T("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=T("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.25V14",key:"re2vv1"}],["path",{d:"M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z",key:"ame013"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=T("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=T("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=T("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=T("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=T("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=T("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=T("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=T("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=T("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=T("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=T("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=T("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=T("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=T("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=T("FileWarning",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=T("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=T("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=T("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=T("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=T("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=T("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=T("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=T("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=T("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=T("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=T("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=T("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=T("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=T("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=T("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=T("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=T("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=T("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=T("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=T("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=T("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function ga(s,t=[]){let a=[];function n(m,i){const c=r.createContext(i);c.displayName=m+"Context";const h=a.length;a=[...a,i];const f=v=>{var b;const{scope:k,children:_,...y}=v,j=((b=k==null?void 0:k[s])==null?void 0:b[h])||c,l=r.useMemo(()=>y,Object.values(y));return e.jsx(j.Provider,{value:l,children:_})};f.displayName=m+"Provider";function d(v,k){var j;const _=((j=k==null?void 0:k[s])==null?void 0:j[h])||c,y=r.useContext(_);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${v}\` must be used within \`${m}\``)}return[f,d]}const o=()=>{const m=a.map(i=>r.createContext(i));return function(c){const h=(c==null?void 0:c[s])||m;return r.useMemo(()=>({[`__scope${s}`]:{...c,[s]:h}}),[c,h])}};return o.scopeName=s,[n,wa(o,...t)]}function wa(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const n=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(m){const i=n.reduce((c,{useScope:h,scopeName:f})=>{const v=h(m)[`__scope${f}`];return{...c,...v}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return a.scopeName=t.scopeName,a}var ya=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Vs=ya.reduce((s,t)=>{const a=Ke(`Primitive.${t}`),n=r.forwardRef((o,m)=>{const{asChild:i,...c}=o,h=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(h,{...c,ref:m})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{}),qe="Progress",Je=100,[ja]=ga(qe),[va,ba]=ja(qe),Xs=r.forwardRef((s,t)=>{const{__scopeProgress:a,value:n=null,max:o,getValueLabel:m=Na,...i}=s;(o||o===0)&&!ys(o)&&console.error(ka(`${o}`,"Progress"));const c=ys(o)?o:Je;n!==null&&!js(n,c)&&console.error(Sa(`${n}`,"Progress"));const h=js(n,c)?n:null,f=Te(h)?m(h,c):void 0;return e.jsx(va,{scope:a,value:h,max:c,children:e.jsx(Vs.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Te(h)?h:void 0,"aria-valuetext":f,role:"progressbar","data-state":qs(h,c),"data-value":h??void 0,"data-max":c,...i,ref:t})})});Xs.displayName=qe;var Ks="ProgressIndicator",Hs=r.forwardRef((s,t)=>{const{__scopeProgress:a,...n}=s,o=ba(Ks,a);return e.jsx(Vs.div,{"data-state":qs(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...n,ref:t})});Hs.displayName=Ks;function Na(s,t){return`${Math.round(s/t*100)}%`}function qs(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function Te(s){return typeof s=="number"}function ys(s){return Te(s)&&!isNaN(s)&&s>0}function js(s,t){return Te(s)&&!isNaN(s)&&s<=t&&s>=0}function ka(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Je}\`.`}function Sa(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Je} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Js=Xs,Ca=Hs;const Gs=r.forwardRef(({className:s,value:t,indicatorClassName:a,...n},o)=>e.jsx(Js,{ref:o,className:U("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:e.jsx(Ca,{className:U("h-full w-full flex-1 bg-primary transition-all",a),style:{transform:`translateX(-${100-(t||0)}%)`}})}));Gs.displayName=Js.displayName;async function Pa(){const s=await fetch(`${window.sbwpData.restUrl}/stats`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch stats");return s.json()}async function Ta(){const s=await fetch(`${window.sbwpData.restUrl}/backups`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch backups");return s.json()}async function Ea(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to delete backup")}return t.json()}async function Da(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}/files`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch backup files");return t.json()}async function _a(s,t="/"){const a=await fetch(`${window.sbwpData.restUrl}/backups/${s}/download?path=${encodeURIComponent(t)}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!a.ok)throw new Error("Failed to get download URL");return a.json()}async function Ra(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}/contents`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch backup contents");return t.json()}async function vs(s,t){const a=await fetch(`${window.sbwpData.restUrl}/backups/${s}/restore`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({items:t})});if(!a.ok){const n=await a.json();throw new Error(n.message||"Failed to restore backup")}return a.json()}async function Ia(){try{const s=await fetch(`${window.sbwpData.restUrl}/backup/progress?t=${Date.now()}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)return{percent:0,message:"Idle"};const t=await s.text();return t?JSON.parse(t):{percent:0,message:"Idle"}}catch{return{percent:0,message:"Idle"}}}async function Aa(){const s=await fetch(`${window.sbwpData.restUrl}/backup/cancel`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to cancel backup");return await s.json()}async function Fa(){const s=await fetch(`${window.sbwpData.restUrl}/cloud/providers`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(s.status===404)return[];if(!s.ok)throw new Error("Failed to fetch cloud providers");return s.json()}async function Fe(s,t,a){const n=await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/connect`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({provider_id:s,action:t,...a})}),o=await n.json();if(!n.ok)throw new Error(o.message||"Failed to connect");return o}async function Ma(){return(await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json()}async function $a(s){await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify(s)})}async function Ys(){const s=await fetch(`${window.sbwpData.restUrl}/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch settings");return s.json()}async function Qs(s){const t=await fetch(`${window.sbwpData.restUrl}/settings`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to save settings");return t.json()}async function Oa(s="full",t=!1,a){const n=await fetch(`${window.sbwpData.restUrl}/backups`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({type:s,resume:t,session_id:a})}),o=await n.text();if(!o)throw console.error(`SBWP Fetch Error: Empty response. Status: ${n.status} ${n.statusText}`),new Error(`Empty response from server (Status ${n.status})`);try{const m=JSON.parse(o);if(!n.ok)throw new Error(m.message||"Failed to create backup");return m}catch{throw console.error("JSON Parse Error:",o),new Error("Invalid server response")}}async function Ba(){const s=await fetch(`${window.sbwpData.restUrl}/safe-update/available`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch available updates");return s.json()}async function La(s,t=[],a=!1){const n=await fetch(`${window.sbwpData.restUrl}/safe-update/session`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({plugins:s,themes:t,core:a})});if(!n.ok)throw new Error("Failed to create safe update session");return n.json()}async function za(s){const t=await fetch(`${window.sbwpData.restUrl}/safe-update/session/${s}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch session");return t.json()}async function Ua(){const s=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch AI settings");return s.json()}async function bs(s){const t=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({api_key:s})});if(!t.ok)throw new Error("Failed to save AI settings");return t.json()}async function Wa(s){const t=await fetch(`${window.sbwpData.restUrl}/ai/humanize-report`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({session_id:s})});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to get AI summary")}return t.json()}async function Va(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch recovery settings");return s.json()}async function Xa(s){const t=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({pin:s})});if(!t.ok)throw new Error("Failed to save recovery PIN");return t.json()}async function Ka(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/regenerate-key`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to regenerate key");return s.json()}async function Ha(){const s=await fetch(`${window.sbwpData.restUrl}/crash-status`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to get crash status");return s.json()}const qa=1,Ja=1e6;let Me=0;function Ga(){return Me=(Me+1)%Number.MAX_SAFE_INTEGER,Me.toString()}const $e=new Map,Ns=s=>{if($e.has(s))return;const t=setTimeout(()=>{$e.delete(s),fe({type:"REMOVE_TOAST",toastId:s})},Ja);$e.set(s,t)},Ya=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,qa)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ns(a):s.toasts.forEach(n=>{Ns(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||t.toastId===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},ke=[];let Se={toasts:[]};function fe(s){Se=Ya(Se,s),ke.forEach(t=>{t(Se)})}function Qa({...s}){const t=Ga(),a=o=>fe({type:"UPDATE_TOAST",toast:{...o,id:t}}),n=()=>fe({type:"DISMISS_TOAST",toastId:t});return fe({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:o=>{o||n()}}}),{id:t,dismiss:n,update:a}}function ie(){const[s,t]=r.useState(Se);return r.useEffect(()=>(ke.push(t),()=>{const a=ke.indexOf(t);a>-1&&ke.splice(a,1)}),[s]),{...s,toast:Qa,dismiss:a=>fe({type:"DISMISS_TOAST",toastId:a})}}function Za({open:s,onOpenChange:t}){const[a,n]=r.useState("loading"),[o,m]=r.useState([]),[i,c]=r.useState([]),[h,f]=r.useState(null),[d,v]=r.useState(""),[k,_]=r.useState(0),[y,j]=r.useState([]),[l,b]=r.useState(null),[x,E]=r.useState(""),[p,u]=r.useState(""),[N,F]=r.useState(!1);r.useEffect(()=>{s?M():(n("loading"),c([]),f(null),b(null),u(""),F(!1),E(""),_(0),j([]))},[s]),r.useEffect(()=>{let g=null;return a==="running"&&h&&(g=setInterval(async()=>{try{const D=await za(h);if(D.progress){const $=D.progress.message;v($),_(D.progress.percent||0),j(C=>C.length===0||C[C.length-1]!==$?[...C,$]:C)}D.status==="completed"?(b(D.result),n("complete")):D.status==="failed"&&(E(D.error_message||"Unknown error"),n("failed"))}catch(D){console.error("Polling error:",D)}},1500)),()=>{g&&clearInterval(g)}},[a,h]);const M=async()=>{n("loading");try{const g=await Ba();m(g.plugins),c(g.plugins.map(D=>D.file||D.slug||"").filter(Boolean)),n("select")}catch{E("Failed to load available updates"),n("error")}},V=g=>{c(D=>D.includes(g)?D.filter($=>$!==g):[...D,g])},R=()=>{c(o.map(g=>g.file||g.slug||"").filter(Boolean))},I=()=>{c([])},W=async()=>{if(i.length!==0){n("running"),v("Creating test environment...");try{const g=await La(i);f(g.session_id),v("Test session created, waiting for results...")}catch{E("Failed to start safe update test"),n("error")}}},X=g=>{switch(g){case"safe":return e.jsx(le,{className:"h-4 w-4 text-emerald-500"});case"risky":return e.jsx(De,{className:"h-4 w-4 text-yellow-500"});case"unsafe":return e.jsx(he,{className:"h-4 w-4 text-red-500"});default:return e.jsx(z,{className:"h-4 w-4 animate-spin text-muted-foreground"})}},P=g=>{switch(g){case"safe":return"bg-emerald-100 text-emerald-700";case"risky":return"bg-yellow-100 text-yellow-700";case"unsafe":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return e.jsx(ge,{open:s,onOpenChange:t,children:e.jsxs(we,{className:"sm:max-w-[550px] max-h-[80vh] flex flex-col overflow-hidden",children:[e.jsxs(ye,{children:[e.jsx(je,{children:"Safe Update Tester"}),e.jsx(Ee,{children:"Test updates in a temporary sandbox before applying them to your live site."})]}),e.jsxs("div",{className:"py-4 space-y-4 flex-1 overflow-y-auto",children:[a==="loading"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(z,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading available updates..."})]}),a==="select"&&e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"h-6 w-6 text-emerald-600"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All plugins and themes are up to date!"}),e.jsx(S,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o.length," update",o.length!==1?"s":""," available"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"ghost",size:"sm",onClick:R,children:"Select All"}),e.jsx(S,{variant:"ghost",size:"sm",onClick:I,children:"Select None"})]})]}),e.jsx("div",{className:"border rounded-lg divide-y max-h-60 overflow-y-auto",children:o.map(g=>{const D=g.file||g.slug||"",$=i.includes(D);return e.jsxs("label",{className:`flex items-center gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors ${$?"bg-blue-50/50":""}`,children:[e.jsx("input",{type:"checkbox",checked:$,onChange:()=>V(D),className:"rounded border-slate-300"}),e.jsx(Us,{className:"h-4 w-4 text-slate-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:g.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[g.current_version," → ",g.new_version]})]}),g.requires_php&&e.jsxs("span",{className:"text-[10px] bg-slate-100 px-1.5 py-0.5 rounded",children:["PHP ",g.requires_php,"+"]})]},D)})}),e.jsxs(S,{className:"w-full",disabled:i.length===0,onClick:W,children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),"Test ",i.length," Update",i.length!==1?"s":""]})]})}),a==="running"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(He,{className:"h-8 w-8 text-blue-600 animate-spin"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold",children:"Running Safe Update Test"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d||"Starting..."})]})]}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out",style:{width:`${k}%`}})}),e.jsxs("div",{className:"bg-slate-950 text-slate-50 p-3 rounded-md font-mono text-xs h-32 overflow-y-auto border border-slate-800",children:[y.map((g,D)=>{const $=D===y.length-1;return e.jsxs("div",{className:`flex items-start gap-1 ${$?"text-emerald-400":"text-slate-500"}`,children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:$?"animate-pulse":"",children:g}),$&&e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]},D)}),y.length===0&&e.jsxs("div",{className:"flex items-center gap-1 text-emerald-400",children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:"animate-pulse",children:"Initializing..."}),e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]})]}),e.jsxs("p",{className:"text-xs text-center text-muted-foreground",children:[k<50?"Downloading updates...":"Testing updates..."," Please don't close this window."]})]}),a==="complete"&&l&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${P(l.summary.overall_status)}`,children:[l.summary.overall_status==="safe"&&"✓ Safe to Update",l.summary.overall_status==="risky"&&"⚠ Proceed with Caution",l.summary.overall_status==="unsafe"&&"✗ Issues Detected"]})}),e.jsx("div",{className:"border rounded-lg divide-y",children:l.items.plugins.map(g=>e.jsxs("div",{className:"p-3 flex items-start gap-3",children:[X(g.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:g.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[g.from_version," → ",g.to_version]}),g.issues.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:g.issues.map((D,$)=>e.jsx("div",{className:"text-xs bg-red-50 text-red-700 p-2 rounded",children:D.message},$))})]})]},g.slug))}),l.health_checks.length>0&&e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Health Checks"}),e.jsx("div",{className:"space-y-1",children:l.health_checks.map((g,D)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[g.status_code===200&&!g.wsod_detected?e.jsx(le,{className:"h-3 w-3 text-emerald-500"}):e.jsx(he,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{children:g.label}),e.jsxs("span",{className:"text-muted-foreground",children:["(",g.status_code,")"]})]},D))})]}),window.sbwpData.isPro&&h&&e.jsxs("div",{className:"border border-violet-200 rounded-lg p-3 bg-violet-50/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Es,{className:"h-4 w-4 text-violet-500"}),e.jsx("span",{className:"text-sm font-medium",children:"AI Explanation"})]}),p?e.jsx("p",{className:"text-sm text-slate-700",children:p}):e.jsx(S,{size:"sm",variant:"outline",className:"text-violet-600 border-violet-200 hover:bg-violet-100",onClick:async()=>{F(!0);try{const g=await Wa(h);u(g.summary)}catch{u("Could not generate AI summary. Please check your API key in Settings.")}finally{F(!1)}},disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 animate-spin mr-2"})," Generating..."]}):e.jsx(e.Fragment,{children:"Explain in Plain English"})})]}),e.jsxs("div",{className:"flex gap-2",children:[l.summary.overall_status==="safe"&&e.jsx(S,{className:"flex-1 bg-emerald-600 hover:bg-emerald-700",onClick:()=>window.location.href="/wp-admin/update-core.php",children:"Apply Updates"}),e.jsx(S,{variant:"outline",className:l.summary.overall_status==="safe"?"":"flex-1",onClick:()=>t(!1),children:"Close"})]})]}),(a==="failed"||a==="error")&&e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(he,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Test Failed"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:x})]}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(S,{variant:"outline",onClick:M,children:"Try Again"}),e.jsx(S,{variant:"ghost",onClick:()=>t(!1),children:"Close"})]})]})]})]})})}const Zs=r.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:U("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));Zs.displayName="Textarea";function en({open:s,onOpenChange:t}){var de,es,ss,ts,as,ns,rs,os,is,ls,cs;const[a,n]=r.useState("idle"),[o,m]=r.useState("quick"),[i,c]=r.useState(""),[h,f]=r.useState({message:"",percent:0}),[d,v]=r.useState(null),[k,_]=r.useState(null),[y,j]=r.useState([]),[l,b]=r.useState(!1),[x,E]=r.useState(!1),[p,u]=r.useState(!1),[N,F]=r.useState([]),M=r.useRef(null),V=[{id:"js",label:"Checking JavaScript errors",status:"pending"},{id:"php",label:"Scanning PHP errors",status:"pending"},{id:"code",label:"Analyzing custom code",status:"pending"},{id:"conflicts",label:"Checking known conflicts",status:"pending"},{id:"ai",label:"AI diagnosis",status:"pending"}],R=[{id:"prep",label:"Preparing sandbox",status:"pending"},{id:"clone",label:"Creating test environment",status:"pending"},{id:"baseline",label:"Capturing baseline",status:"pending"},{id:"isolation",label:"Isolating conflict",status:"pending"},{id:"ai",label:"AI diagnosis",status:"pending"}];r.useEffect(()=>(s&&window.sbwpData.isPro&&I(),()=>{M.current&&clearInterval(M.current)}),[s]);const I=async()=>{try{const O=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/check-outdated`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();j(O.plugins||[]),O.count>0&&b(!0)}catch(w){console.error("Failed to check outdated plugins:",w)}},W=async()=>{o==="quick"?X():g()},X=async()=>{var w,O,L,ue,se;n("quick_scanning"),v(null),_(null),b(!1),F(V);try{const K=(J,Et,Dt)=>{F(_t=>_t.map(Ie=>Ie.id===J?{...Ie,status:Et,detail:Dt}:Ie))};K("js","running"),await new Promise(J=>setTimeout(J,300));const ae=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/quick`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({user_context:i})})).json();K("js","done",(w=ae.js_errors)!=null&&w.count?`${ae.js_errors.count} errors`:"No errors"),await new Promise(J=>setTimeout(J,200)),K("php","running"),await new Promise(J=>setTimeout(J,200)),K("php","done",(O=ae.php_errors)!=null&&O.count?`${ae.php_errors.count} errors`:"No errors"),K("code","running"),await new Promise(J=>setTimeout(J,200)),K("code","done",(ue=(L=ae.custom_code)==null?void 0:L.summary)!=null&&ue.custom_code_sources?`${ae.custom_code.summary.custom_code_sources} sources`:"None found"),K("conflicts","running"),await new Promise(J=>setTimeout(J,200)),K("conflicts","done",(se=ae.known_conflicts)!=null&&se.length?`${ae.known_conflicts.length} found`:"None"),K("ai","running"),await new Promise(J=>setTimeout(J,300)),K("ai","done"),P(ae)}catch(K){console.error("Quick scan error:",K),n("idle")}},P=w=>{if(v(w),w.issues&&w.issues.length>0){const O=w.issues.some(L=>L.severity==="error");n(O?"found":"clean")}else n("clean")},g=async()=>{n("scanning"),f({message:"Starting deep scan...",percent:5}),v(null),_(null),b(!1),F(R);try{const O=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/start`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({user_context:i})})).json();if(!O.session_id)throw new Error("Failed to start scan");D(O.session_id)}catch(w){console.error("Scan start error:",w),n("idle")}},D=w=>{M.current=setInterval(async()=>{try{const L=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/session/${w}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();L.progress&&(f({message:L.progress.message||"Scanning...",percent:L.progress.percent||0}),$(L.progress.step)),L.status==="completed"?(clearInterval(M.current),C(L.result)):L.status==="failed"&&(clearInterval(M.current),n("idle"),console.error("Scan failed:",L.error_message))}catch(O){console.error("Poll error:",O)}},1500)},$=w=>{const O=["prep","clone","baseline","isolation","ai"],L=O.indexOf(w)!==-1?O.indexOf(w):0;F(ue=>ue.map(se=>{const K=O.indexOf(se.id);return K<L?{...se,status:"done"}:K===L?{...se,status:"running"}:{...se,status:"pending"}}))},C=w=>{v({...w,type:"deep"}),F(O=>O.map(L=>({...L,status:"done"}))),w.culprit?w.culprit.type==="core_or_server"?n("core_issue"):n("found"):w.multi_plugin_conflict?n("found"):n("clean")},B=async()=>{if(d)try{const L=(await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/sessions`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json())[0];if(!L)return;const se=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/generate-email/${L.id}`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();se.error||(_(se),n("email_ready"))}catch(w){console.error("Email generation error:",w)}},A=()=>{if(!k)return;const w=`Subject: ${k.subject}

${k.body}`;navigator.clipboard.writeText(w),E(!0),setTimeout(()=>E(!1),2e3)},re=async w=>{console.log("Disable plugin:",w)},ce=()=>{n("idle"),c(""),f({message:"",percent:0}),v(null),_(null),b(!1),F([]),u(!1)},q=()=>{var w;return(w=d==null?void 0:d.issues)!=null&&w.length?d.issues.find(O=>O.severity==="error")||d.issues[0]:null};return e.jsx(ge,{open:s,onOpenChange:w=>{w||ce(),t(w)},children:e.jsxs(we,{className:"sm:max-w-[550px]",children:[e.jsxs(ye,{children:[e.jsxs(je,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-orange-500 to-red-500 rounded-lg",children:e.jsx(ea,{className:"h-4 w-4 text-white"})}),"AI Conflict Scanner"]}),e.jsx(Ee,{children:"Find and fix what's breaking your site"})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[a==="idle"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"What's wrong?"}),e.jsx(Zs,{placeholder:"e.g., The Elementor editor shows a blank popup when I try to edit widgets...",value:i,onChange:w=>c(w.target.value),rows:2,className:"resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Choose scan type:"}),e.jsxs("button",{onClick:()=>m("quick"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${o==="quick"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:`h-5 w-5 ${o==="quick"?"text-orange-500":"text-gray-400"}`}),e.jsx("span",{className:"font-semibold",children:"Quick Check"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"~10 seconds"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 ml-7",children:[e.jsx("strong",{children:"Best for:"})," JavaScript errors, console errors, broken page builders, frontend issues"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-7",children:"Scans error logs, captures live JS errors from your browser, checks Code Snippets & custom code"})]}),e.jsxs("button",{onClick:()=>m("deep"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${o==="deep"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:`h-5 w-5 ${o==="deep"?"text-orange-500":"text-gray-400"}`}),e.jsx("span",{className:"font-semibold",children:"Deep Scan"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"~2 minutes"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 ml-7",children:[e.jsx("strong",{children:"Best for:"})," PHP fatal errors, white screen of death, 500 errors, complete site crashes"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-7",children:"Creates a sandbox and tests each plugin one-by-one to find which one crashes your site"})]})]}),l&&y.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ps,{className:"h-5 w-5 text-yellow-600 mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:[y.length," plugin",y.length>1?"s need":" needs"," updates"]}),e.jsx("p",{className:"text-xs text-yellow-700 mt-0.5",children:"Outdated plugins often cause conflicts"})]})]})}),e.jsx(S,{size:"lg",onClick:W,className:"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600",children:o==="quick"?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Start Quick Check"]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Start Deep Scan"]})}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:o==="quick"?"Checks logs and recent errors instantly":"Creates a sandbox to test each plugin safely"})]}),a==="quick_scanning"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:N.map(w=>e.jsxs("div",{className:"flex items-center gap-3 py-1.5",children:[e.jsxs("div",{className:"w-5 h-5 flex items-center justify-center",children:[w.status==="pending"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-200"}),w.status==="running"&&e.jsx(z,{className:"w-4 h-4 animate-spin text-orange-500"}),w.status==="done"&&e.jsx(le,{className:"w-4 h-4 text-emerald-500"}),w.status==="error"&&e.jsx(he,{className:"w-4 h-4 text-red-500"})]}),e.jsx("span",{className:`text-sm flex-1 ${w.status==="pending"?"text-gray-400":w.status==="running"?"text-orange-600 font-medium":"text-gray-700"}`,children:w.label}),w.detail&&e.jsx("span",{className:"text-xs text-muted-foreground",children:w.detail})]},w.id))})}),a==="scanning"&&e.jsxs("div",{className:"space-y-4 text-center py-4",children:[e.jsxs("div",{className:"relative mx-auto w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 bg-orange-100 rounded-full animate-ping opacity-25"}),e.jsx("div",{className:"relative bg-orange-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(me,{className:"h-8 w-8 text-orange-500"})})]}),e.jsx("h3",{className:"font-semibold text-lg",children:"Deep Scanning..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.message}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden w-full",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 to-red-500 transition-all duration-300",style:{width:`${h.percent}%`}})}),e.jsx("div",{className:"space-y-1",children:N.map(w=>e.jsxs("div",{className:"flex items-center gap-2 justify-center text-xs",children:[w.status==="done"&&e.jsx(le,{className:"w-3 h-3 text-emerald-500"}),w.status==="running"&&e.jsx(z,{className:"w-3 h-3 animate-spin text-orange-500"}),w.status==="pending"&&e.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300"}),e.jsx("span",{className:w.status==="running"?"text-orange-600":"text-gray-500",children:w.label})]},w.id))})]}),a==="found"&&d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 border border-red-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700 mb-3",children:[e.jsx(De,{className:"h-5 w-5"}),e.jsxs("h3",{className:"font-bold",children:[((de=d.issues)==null?void 0:de.length)||0," Issue",(((es=d.issues)==null?void 0:es.length)||0)!==1?"s":""," Found"]}),((ss=d.ai_analysis)==null?void 0:ss.confidence)&&e.jsxs("span",{className:"ml-auto text-xs bg-red-100 px-2 py-0.5 rounded-full",children:[d.ai_analysis.confidence," confidence"]})]}),(d.culprit||q())&&e.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3 mb-3 border border-red-100",children:[e.jsx("div",{className:"flex items-center gap-2",children:d.culprit?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-semibold",children:d.culprit.name}),d.culprit.is_outdated&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full",children:"Update available"})]}):q()&&e.jsxs(e.Fragment,{children:[((ts=q())==null?void 0:ts.type)==="javascript"&&e.jsx(na,{className:"h-4 w-4 text-red-500"}),((as=q())==null?void 0:as.type)==="php"&&e.jsx(oa,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-semibold",children:((rs=(ns=q())==null?void 0:ns.source)==null?void 0:rs.name)||((is=(os=q())==null?void 0:os.source)==null?void 0:is.slug)||"Unknown source"})]})}),q()&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:(ls=q())==null?void 0:ls.message})]}),d.ai_analysis&&e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"💡 Diagnosis:"})," ",d.ai_analysis.diagnosis]}),d.ai_analysis.recommendation&&e.jsx("p",{className:"text-red-700",children:d.ai_analysis.recommendation})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[((cs=d.culprit)==null?void 0:cs.is_outdated)&&e.jsxs(S,{variant:"outline",className:"flex-1 text-sm",size:"sm",children:[e.jsx(Be,{className:"h-3 w-3 mr-1.5"}),"Update Plugin"]}),d.culprit&&e.jsxs(S,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:()=>re(d.culprit.slug),children:[e.jsx(ws,{className:"h-3 w-3 mr-1.5"}),"Disable Plugin"]}),e.jsxs(S,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:B,children:[e.jsx(fs,{className:"h-3 w-3 mr-1.5"}),"Email Developer"]}),d.type==="quick"&&e.jsxs(S,{variant:"outline",className:"flex-1 text-sm",size:"sm",onClick:()=>{m("deep"),g()},children:[e.jsx(me,{className:"h-3 w-3 mr-1.5"}),"Deep Scan"]})]}),d.issues&&d.issues.length>1&&e.jsxs("button",{onClick:()=>u(!p),className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground w-full justify-center",children:[p?e.jsx(Fs,{className:"h-4 w-4"}):e.jsx(_e,{className:"h-4 w-4"}),p?"Hide":"Show"," all ",d.issues.length," issues"]}),p&&d.issues&&e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1 text-xs",children:d.issues.map((w,O)=>e.jsxs("div",{className:`p-2 rounded flex items-start gap-2 ${w.severity==="error"?"bg-red-50":w.severity==="warning"?"bg-yellow-50":"bg-gray-50"}`,children:[e.jsx("span",{className:`font-mono uppercase text-[10px] px-1 rounded ${w.severity==="error"?"bg-red-100 text-red-700":w.severity==="warning"?"bg-yellow-100 text-yellow-700":"bg-gray-100"}`,children:w.type}),e.jsx("span",{className:"flex-1 line-clamp-2",children:w.message})]},O))}),e.jsx(S,{variant:"outline",onClick:()=>t(!1),className:"w-full",children:"Close"})]}),a==="core_issue"&&d&&e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ps,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Not a Plugin Conflict"}),e.jsx("p",{className:"text-muted-foreground",children:"The issue persists even with all plugins disabled. This suggests a server, WordPress core, or theme issue."}),d.ai_analysis&&e.jsx("p",{className:"text-sm",children:d.ai_analysis.recommendation}),e.jsx(S,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}),a==="clean"&&e.jsxs("div",{className:"text-center space-y-4 py-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"h-8 w-8 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Looking Good!"}),e.jsxs("p",{className:"text-muted-foreground",children:["No obvious conflicts detected",d!=null&&d.scan_duration?` in ${d.scan_duration}s`:"","."]}),(d==null?void 0:d.type)==="quick"&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Run a ",e.jsx("button",{onClick:()=>{m("deep"),g()},className:"text-orange-600 underline",children:"deep scan"})," for thorough analysis."]}),e.jsx(S,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}),a==="email_ready"&&k&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-700",children:[e.jsx(fs,{className:"h-5 w-5"}),e.jsx("h3",{className:"font-semibold",children:"Developer Email Ready"})]}),e.jsxs("div",{className:"bg-slate-50 border rounded-lg p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Subject:"}),e.jsx("p",{className:"text-sm font-medium",children:k.subject})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Body:"}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap max-h-48 overflow-y-auto",children:k.body})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:A,className:"flex-1",children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),x?"Copied!":"Copy to Clipboard"]}),e.jsx(S,{variant:"outline",onClick:()=>n("found"),children:"Back"})]})]})]})]})})}const et=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"w-full overflow-auto",children:e.jsx("table",{ref:a,className:U("w-full caption-bottom text-sm",s),...t})}));et.displayName="Table";const st=r.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:U("[&_tr]:border-b",s),...t}));st.displayName="TableHeader";const tt=r.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:U("[&_tr:last-child]:border-0",s),...t}));tt.displayName="TableBody";const sn=r.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:U("bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));sn.displayName="TableFooter";const Ue=r.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:U("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));Ue.displayName="TableRow";const xe=r.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:U("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));xe.displayName="TableHead";const pe=r.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:U("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));pe.displayName="TableCell";const tn=r.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:U("mt-4 text-sm text-muted-foreground",s),...t}));tn.displayName="TableCaption";function an(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,n=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+n[o]}function nn({backup:s,open:t,onOpenChange:a,onComplete:n}){const[o,m]=r.useState("initial"),[i,c]=r.useState("full"),[h,f]=r.useState(!1),[d,v]=r.useState(null),[k,_]=r.useState([]),[y,j]=r.useState([]),{toast:l}=ie();r.useEffect(()=>{t&&(m("initial"),c("full"),f(!1),v(null),_([]),j([]))},[t]);const b=async()=>{if(s){f(!0);try{const u=await Ra(s.id);v(u),m("select")}catch{l({title:"Error",description:"Failed to load backup contents.",variant:"destructive"})}finally{f(!1)}}},x=async()=>{if(s){m("restoring");try{i==="full"?await vs(s.id):await vs(s.id,{plugins:k,themes:y}),l({title:"Restore Complete",description:"The backup has been restored successfully."}),n(),a(!1),setTimeout(()=>window.location.reload(),1500)}catch(u){m("initial"),l({title:"Restore Failed",description:u.message||"An error occurred during restore.",variant:"destructive"})}}},E=u=>{_(N=>N.includes(u)?N.filter(F=>F!==u):[...N,u])},p=u=>{j(N=>N.includes(u)?N.filter(F=>F!==u):[...N,u])};return s?e.jsx(ge,{open:t,onOpenChange:u=>!h&&a(u),children:e.jsxs(we,{className:"sm:max-w-2xl",children:[e.jsxs(ye,{children:[e.jsx(je,{children:"Restore Backup"}),e.jsxs(Ee,{children:["Created on ",s.created_at," • ",an(s.size_bytes)]})]}),o==="initial"&&e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-4 text-red-900 dark:text-red-100 flex gap-3",children:[e.jsx(De,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-1",children:"Warning"}),e.jsx("div",{className:"text-sm opacity-90",children:"Restoring will overwrite existing files and database. This action cannot be undone."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="full"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>c("full"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Le,{className:"h-5 w-5 text-emerald-500"}),e.jsx("h3",{className:"font-semibold",children:"Full Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restore everything: Files, Database, Plugins, and Themes."})]}),e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="partial"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>c("partial"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Us,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-semibold",children:"Partial Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select specific Plugins or Themes to restore. Database is NOT restored."})]})]})]}),o==="select"&&d&&e.jsxs("div",{className:"py-4",children:[e.jsxs(Rt,{defaultValue:"plugins",children:[e.jsxs(It,{children:[e.jsxs(ds,{value:"plugins",children:["Plugins (",d.plugins.length,")"]}),e.jsxs(ds,{value:"themes",children:["Themes (",d.themes.length,")"]})]}),e.jsx(us,{value:"plugins",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:d.plugins.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No plugins found in backup."}):e.jsx("div",{className:"space-y-2",children:d.plugins.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`plugin-${u}`,checked:k.includes(u),onChange:()=>E(u),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(H,{htmlFor:`plugin-${u}`,className:"flex-1 cursor-pointer font-medium",children:u})]},u))})}),e.jsx(us,{value:"themes",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:d.themes.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No themes found in backup."}):e.jsx("div",{className:"space-y-2",children:d.themes.map(u=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`theme-${u}`,checked:y.includes(u),onChange:()=>p(u),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(H,{htmlFor:`theme-${u}`,className:"flex-1 cursor-pointer font-medium",children:u})]},u))})})]}),e.jsx("div",{className:"flex justify-between items-center mt-4 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Selected: ",k.length," plugins, ",y.length," themes"]})})]}),o==="restoring"&&e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(z,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Restoring Backup..."}),e.jsxs("p",{className:"text-muted-foreground max-w-sm mx-auto",children:["Please wait while we restore your ",i==="full"?"site":"items",". Do not close this window."]})]}),e.jsxs(At,{children:[o==="initial"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(S,{onClick:()=>i==="full"?x():b(),disabled:h,children:[h&&e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),i==="full"?"Start Restore":"Next Step"]})]}),o==="select"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:"outline",onClick:()=>m("initial"),children:"Back"}),e.jsxs(S,{onClick:x,disabled:k.length===0&&y.length===0,children:["Start Restore (",k.length+y.length," items)"]})]})]})]})}):null}function rn(s){if(s===0)return"0 B";const t=1024,a=["B","KB","MB","GB"],n=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,n)).toFixed(1))+" "+a[n]}function on(s){return s.type==="folder"?e.jsx(la,{className:"h-4 w-4 text-yellow-500"}):s.category==="database"||s.name.endsWith(".sql")?e.jsx(Os,{className:"h-4 w-4 text-blue-500"}):s.name.endsWith(".php")?e.jsx(Ae,{className:"h-4 w-4 text-purple-500"}):s.name.endsWith(".js")||s.name.endsWith(".ts")?e.jsx(Ae,{className:"h-4 w-4 text-yellow-600"}):s.name.endsWith(".css")?e.jsx(Ae,{className:"h-4 w-4 text-blue-400"}):s.name.endsWith(".json")||s.name.endsWith(".txt")||s.name.endsWith(".md")?e.jsx(ra,{className:"h-4 w-4 text-gray-500"}):e.jsx(Ls,{className:"h-4 w-4 text-gray-400"})}function ln({backup:s,open:t,onOpenChange:a}){const[n,o]=r.useState([]),[m,i]=r.useState(!1),[c,h]=r.useState(null),[f,d]=r.useState(new Set),{toast:v}=ie();r.useEffect(()=>{t&&s&&k()},[t,s]);const k=async()=>{if(s){i(!0);try{const l=await Da(s.id);o(l.files);const b=new Set;l.files.forEach(x=>{x.depth===0&&x.type==="folder"&&b.add(x.path)}),d(b)}catch(l){console.error(l),v({title:"Error",description:"Failed to load backup files",variant:"destructive"})}finally{i(!1)}}},_=async l=>{if(s){h(l);try{const b=await _a(s.id,l),x=document.createElement("a");x.href=b.download_url,x.download=b.filename,document.body.appendChild(x),x.click(),document.body.removeChild(x),v({title:"Download Started",description:b.filename})}catch(b){console.error(b),v({title:"Error",description:"Failed to download file",variant:"destructive"})}finally{h(null)}}},y=l=>{const b=new Set(f);b.has(l)?b.delete(l):b.add(l),d(b)},j=l=>{if(l.depth===0)return!0;const b=l.path.split("/").filter(Boolean);for(let x=0;x<b.length-1;x++){const E="/"+b.slice(0,x+1).join("/");if(!f.has(E))return!1}return!0};return e.jsx(ge,{open:t,onOpenChange:a,children:e.jsxs(we,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsx(ye,{children:e.jsx(je,{children:"Browse Backup"})}),e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(S,{size:"sm",onClick:()=>_("/"),disabled:c==="/",children:[c==="/"?e.jsx(z,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Download All"]})}),m?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsx(Ft,{className:"h-[400px] border rounded-lg",children:e.jsxs("div",{className:"p-2",children:[n.filter(j).map(l=>e.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-muted/50 rounded group",style:{paddingLeft:`${l.depth*20+8}px`},children:[l.type==="folder"&&l.hasChildren?e.jsx("button",{onClick:()=>y(l.path),className:"p-0.5 hover:bg-muted rounded",children:f.has(l.path)?e.jsx(_e,{className:"h-3 w-3 text-muted-foreground"}):e.jsx(As,{className:"h-3 w-3 text-muted-foreground"})}):e.jsx("div",{className:"w-4"}),on(l),e.jsx("span",{className:"flex-1 text-sm truncate",children:l.name}),l.type==="file"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:rn(l.size)}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>_(l.path),disabled:c===l.path,children:c===l.path?e.jsx(z,{className:"h-3 w-3 animate-spin"}):e.jsx(Be,{className:"h-3 w-3"})})]},l.path)),n.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ls,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"No files found in this backup"})]})]})})]})})}function cn(s){return s?new Date(s).toLocaleString():"Unknown"}function dn(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,n=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+n[o]}function un({refreshTrigger:s}){const[t,a]=r.useState([]),[n,o]=r.useState(!0),[m,i]=r.useState(null),[c,h]=r.useState(null),[f,d]=r.useState(!1),[v,k]=r.useState(!1),{toast:_}=ie(),y=async()=>{o(!0);try{const x=await Ta();console.log("SBWP: Backups loaded:",x),a(x)}catch(x){console.error(x)}finally{o(!1)}};r.useEffect(()=>{y()},[s]);const j=async x=>{if(confirm("Permanently delete this backup?")){i(x);try{await Ea(x.toString()),_({title:"Backup Deleted",description:"The backup has been removed."}),y()}catch{_({title:"Error",description:"Failed to delete backup.",variant:"destructive"})}finally{i(null)}}},l=x=>{h(x),d(!0)},b=x=>{h(x),k(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(nn,{backup:c,open:f,onOpenChange:d,onComplete:y}),e.jsx(ln,{backup:c,open:v,onOpenChange:k}),e.jsxs(G,{className:"col-span-3",children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Existing Backups"}),e.jsx(ne,{children:"Manage your local backup points."})]}),e.jsx(Y,{children:n?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-muted/20 rounded-lg",children:[e.jsx(zs,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No backups found."})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(et,{children:[e.jsx(st,{children:e.jsxs(Ue,{children:[e.jsx(xe,{children:"Date"}),e.jsx(xe,{children:"Type"}),e.jsx(xe,{children:"Size"}),e.jsx(xe,{className:"text-right",children:"Actions"})]})}),e.jsx(tt,{children:t.map(x=>e.jsxs(Ue,{children:[e.jsx(pe,{className:"font-medium",children:cn(x.created_at)}),e.jsx(pe,{className:"capitalize",children:e.jsxs("span",{className:"flex items-center gap-1",children:[x.type,Number(x.is_locked)===1?e.jsx("span",{title:"Locked - required for incremental restores",children:e.jsx(da,{className:"h-3 w-3 text-orange-500"})}):null]})}),e.jsx(pe,{children:dn(x.size_bytes)}),e.jsxs(pe,{className:"text-right",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>b(x),title:"Browse Files",children:e.jsx(ia,{className:"h-4 w-4 text-yellow-600 hover:text-yellow-700"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>l(x),title:"Restore",children:e.jsx(ma,{className:"h-4 w-4 text-blue-500 hover:text-blue-700"})}),e.jsx(S,{variant:"ghost",size:"icon",disabled:m===x.id||Number(x.is_locked)===1,onClick:()=>j(x.id),title:Number(x.is_locked)===1?"Locked - required for incremental restores":"Delete",children:m===x.id?e.jsx(z,{className:"h-4 w-4 animate-spin"}):e.jsx(Ws,{className:`h-4 w-4 ${Number(x.is_locked)===1?"text-gray-300":"text-red-500 hover:text-red-700"}`})})]})]},x.id))})]})})})]})]})}function mn({onNavigate:s}){const[t,a]=r.useState(null),[n,o]=r.useState(!0),[m,i]=r.useState(!1),[c,h]=r.useState(!1),[f,d]=r.useState(!1),[v,k]=r.useState(0),[_,y]=r.useState(0),[j,l]=r.useState(""),[b,x]=r.useState(null),[E,p]=r.useState(!0),[u,N]=r.useState(!1),[F,M]=r.useState(!1),[V,R]=r.useState(!1),[I,W]=r.useState(null),{toast:X}=ie(),P=async()=>{try{const C=await Pa();a(C)}catch(C){console.error("Failed to load stats",C)}finally{o(!1)}};r.useEffect(()=>{P(),Ha().then(x).catch(console.error),Ys().then(C=>p(C.incremental_enabled??!0)).catch(console.error)},[]);const g=async()=>{let C="full";V?C="db_only":E&&!F&&(C="incremental");const B=Date.now().toString();W(B),i(!0),y(1),l("Initializing backup process...");try{const A=await Oa(C,!1,B);if(A.code)throw new Error(A.message);X({title:"Backup Started",description:"Your backup is running in the background. You can leave this page."})}catch(A){console.error(A),i(!1),W(null),X({title:"Backup Failed to Start",description:A.message||"Could not initiate backup.",variant:"destructive"})}finally{M(!1),R(!1)}};r.useEffect(()=>{let C;const B=async()=>{try{const A=await Ia();if(I){if(A.session_id&&A.session_id!==I)return}else if(A.active&&A.percent>0&&A.percent<100){W(A.session_id||"legacy"),i(!0),y(A.percent),A.message&&l(A.message);return}else return;if(!A.active&&A.percent>=100){i(!1),W(null),y(100),l("Backup Complete"),await P(),k(re=>re+1),C&&clearInterval(C),X({title:"Backup Complete",description:"Background backup finished successfully."});return}A.active&&(A.percent>_&&y(A.percent),A.message&&l(A.message),(A.percent>=100||A.message&&A.message.includes("Complete"))&&(i(!1),W(null),y(100),l("Backup Complete"),await P(),k(re=>re+1),C&&clearInterval(C),X({title:"Backup Complete",description:"Background backup finished successfully."})))}catch(A){console.error("Backup progress poll error",A)}};return B(),C=setInterval(B,2e3),()=>{C&&clearInterval(C)}},[m,I,_]);const D=async C=>{console.log("SBWP: Toggling incremental to:",C),p(C);try{const B=await Qs({retention_limit:5,incremental_enabled:C});console.log("SBWP: Settings saved, result:",B),k(A=>A+1)}catch(B){console.error("SBWP: Failed to save incremental setting:",(B==null?void 0:B.message)||B),X({title:"Error",description:(B==null?void 0:B.message)||"Failed to save setting",variant:"destructive"}),p(!C)}},$=async()=>{try{await Aa(),i(!1),y(0),l("IDLE"),k(C=>C+1),X({title:"Backup Cancelled",description:"The backup process was stopped."})}catch(C){console.error("Cancel failed",C),X({title:"Error",description:"Failed to stop backup",variant:"destructive"})}};return n?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Za,{open:c,onOpenChange:h}),e.jsx(en,{open:f,onOpenChange:d}),(b==null?void 0:b.has_crash)&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-500/20 p-2 rounded-full",children:e.jsx(De,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-800 dark:text-red-200",children:"Site Issues Detected"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 truncate max-w-lg",children:"Recent errors found in debug.log"})]})]}),e.jsxs(S,{variant:"destructive",size:"sm",onClick:()=>window.open(b.recovery_url,"_blank"),children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Open Recovery Portal"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(G,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Last Backup"}),e.jsx(Le,{className:"h-4 w-4 text-emerald-500"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.last_backup)||"Never"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t==null?void 0:t.count)||0," total backups"]})]})]}),e.jsxs(G,{children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:"Storage Usage"}),e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total_size)||"0 B"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Local storage used"})]})]}),e.jsxs(G,{className:"lg:col-span-2",children:[e.jsxs(Z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(ee,{className:"text-sm font-medium",children:m?"Backing up...":"Backup"}),e.jsx(He,{className:`h-4 w-4 text-muted-foreground ${m?"animate-spin":""}`})]}),e.jsx(Y,{className:"space-y-3",children:m?e.jsxs("div",{className:"relative overflow-hidden rounded-md bg-zinc-950 p-4 border border-zinc-800 shadow-inner",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-zinc-500 to-transparent opacity-50"}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("span",{className:"text-xs font-mono text-zinc-300 uppercase tracking-wider",children:"Processing Backup"}),e.jsx("button",{onClick:$,className:"ml-2 text-zinc-600 hover:text-red-400 transition-colors",title:"Stop Backup",children:e.jsx(he,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"text-xs font-mono text-emerald-500 font-bold",children:[_,"%"]})]}),e.jsxs("div",{className:"space-y-1 py-1",children:[e.jsxs("div",{className:"font-mono text-[10px] text-zinc-400 flex gap-2",children:[e.jsx("span",{className:"text-emerald-500",children:"➜"}),e.jsxs("span",{children:["Task: ",j.split("(")[0]]})]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-300 flex gap-2 truncate",children:[e.jsx("span",{className:"text-blue-400",children:"ℹ"}),e.jsx("span",{className:"opacity-90 break-all",children:j})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Gs,{value:_,className:"h-1 bg-zinc-800",indicatorClassName:"bg-gradient-to-r from-emerald-600 to-emerald-400"}),e.jsxs("div",{className:"flex justify-between text-[9px] text-zinc-600 uppercase font-mono",children:[e.jsx("span",{children:"Start"}),e.jsx("span",{children:"End"})]})]}),e.jsxs("div",{className:"text-[10px] text-zinc-700 font-mono mt-2 bg-zinc-900/50 p-1 rounded border border-zinc-800 break-all",children:["RAW: ",JSON.stringify({p:_,m:j})]})]}),e.jsx("div",{className:"absolute -bottom-4 -right-4 text-zinc-800 opacity-20",children:e.jsx(Le,{className:"w-24 h-24"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{size:"lg",onClick:g,className:"w-full",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Backup Now"]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx(H,{htmlFor:"incremental",className:"text-sm font-medium cursor-pointer",children:"Smart Incremental"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Only backup changed files"})]})]}),e.jsx(Ne,{id:"incremental",checked:E,onCheckedChange:D})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>N(!u),className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1",children:[u?e.jsx(Fs,{className:"h-3 w-3"}):e.jsx(_e,{className:"h-3 w-3"}),u?"Less options":"More options"]}),u&&e.jsxs("div",{className:"mt-2 space-y-2 p-3 border rounded-lg bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"Force full backup"})]}),e.jsx(Ne,{checked:F,onCheckedChange:C=>{M(C),C&&R(!1)},disabled:!E})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"Database only"})]}),e.jsx(Ne,{checked:V,onCheckedChange:C=>{R(C),C&&M(!1)}})]})]})]})]})})]}),e.jsx(G,{className:"lg:col-span-4 md:col-span-2",children:e.jsx(Y,{className:"p-0",children:e.jsxs("div",{className:"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x",children:[e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Safe Update"})]}),window.sbwpData.isPro&&e.jsx("span",{className:"text-[10px] bg-blue-500/20 text-blue-600 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-1",children:"Test updates safely in a sandbox before applying to production."}),e.jsx(S,{size:"sm",className:"mt-3 w-full bg-blue-600 hover:bg-blue-500 text-white",onClick:()=>{window.sbwpData.isPro?h(!0):window.location.href="/wp-admin/update-core.php"},children:window.sbwpData.isPro?"Test Updates":"Go to Updates"})]}),e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Conflict Scanner"})]}),window.sbwpData.isPro&&e.jsx("span",{className:"text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-1",children:"Find buggy plugins auto-magically."}),e.jsx(S,{size:"sm",variant:"outline",className:"mt-3 w-full",onClick:()=>window.sbwpData.isPro&&d(!0),children:window.sbwpData.isPro?"Start Scan":"Get Pro"})]})]})})})]}),e.jsx(un,{refreshTrigger:v})]})}const Q=r.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:U("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...a}));Q.displayName="Input";var xn=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],pn=xn.reduce((s,t)=>{const a=Ke(`Primitive.${t}`),n=r.forwardRef((o,m)=>{const{asChild:i,...c}=o,h=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(h,{...c,ref:m})});return n.displayName=`Primitive.${t}`,{...s,[t]:n}},{}),hn="Separator",ks="horizontal",fn=["horizontal","vertical"],at=r.forwardRef((s,t)=>{const{decorative:a,orientation:n=ks,...o}=s,m=gn(n)?n:ks,c=a?{role:"none"}:{"aria-orientation":m==="vertical"?m:void 0,role:"separator"};return e.jsx(pn.div,{"data-orientation":m,...c,...o,ref:t})});at.displayName=hn;function gn(s){return fn.includes(s)}var nt=at;const Ce=r.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...n},o)=>e.jsx(nt,{ref:o,decorative:a,orientation:t,className:U("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...n}));Ce.displayName=nt.displayName;function wn({open:s,onOpenChange:t}){const[a,n]=r.useState([]),[o,m]=r.useState(!1),[i,c]=r.useState(null),[h,f]=r.useState(null),[d,v]=r.useState(""),[k,_]=r.useState(""),[y,j]=r.useState({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""}),[l,b]=r.useState(5),x=()=>{m(!0),Promise.all([Fa(),Ma()]).then(([p,u])=>{n(p),u.retention_count&&b(u.retention_count)}).catch(console.error).finally(()=>m(!1))};r.useEffect(()=>{s&&x()},[s]);const E=async p=>{c(p);try{await Fe(p,"disconnect"),x()}catch(u){console.error(u)}finally{c(null)}};return e.jsx(ge,{open:s,onOpenChange:t,children:e.jsxs(we,{className:"sm:max-w-[500px]",children:[e.jsxs(ye,{children:[e.jsx(je,{children:"Cloud Storage Settings"}),e.jsx(Ee,{children:"Connect Google Drive to enable automatic off-site backups."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(H,{className:"text-sm font-medium",children:"Retention Limit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of backups to keep per provider."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Q,{type:"number",min:"1",max:"100",className:"w-20 text-right h-8",value:l,onChange:p=>{b(parseInt(p.target.value)||5)},onBlur:()=>$a({retention_count:l})})})]}),o&&a.length===0?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-4",children:[a.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"No providers available."}),a.map(p=>{var u;return e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800",children:e.jsx(Ms,{className:"h-5 w-5 text-slate-500"})}),e.jsxs("div",{className:"grid gap-0.5",children:[e.jsx("div",{className:"font-medium text-sm",children:p.name}),e.jsx("div",{className:"text-[10px] text-muted-foreground uppercase flex items-center gap-1",children:p.connected?e.jsxs("span",{className:"text-emerald-600 flex items-center gap-1",children:["Connected ",((u=p.user_info)==null?void 0:u.email)&&`as ${p.user_info.email}`]}):"Not Connected"})]})]}),p.connected?e.jsx(S,{size:"sm",variant:"outline",onClick:()=>E(p.id),disabled:i===p.id,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:i===p.id?e.jsx(z,{className:"h-4 w-4 animate-spin"}):"Disconnect"}):e.jsxs(S,{size:"sm",variant:"ghost",onClick:()=>f(h===p.id?null:p.id),children:[h===p.id?"Cancel":"Setup",h===p.id?e.jsx(_e,{className:"ml-2 h-4 w-4"}):e.jsx(As,{className:"ml-2 h-4 w-4"})]})]}),h===p.id&&p.id==="gdrive"&&!p.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[p.global_creds?e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"rounded-md bg-emerald-50 dark:bg-emerald-900/20 p-3 text-xs text-emerald-800 dark:text-emerald-200 flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"✓ Ready to Connect"}),e.jsx("span",{children:"(Secure configuration active)"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Click below to authorize this site to save backups to ",e.jsx("strong",{children:"YOUR"})," Google Drive account."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-900/20 p-3 text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Setup Instructions:"}),e.jsxs("ol",{className:"list-decimal pl-4 space-y-1",children:[e.jsxs("li",{children:["Create a project in ",e.jsx("a",{href:"https://console.cloud.google.com/projectcreate",target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-600 dark:text-blue-400",children:"Google Cloud Console"}),"."]}),e.jsxs("li",{children:["Add this ",e.jsx("strong",{children:"Authorized Redirect URI"}),":"]})]}),e.jsx("div",{className:"mt-2 flex gap-2",children:e.jsxs("code",{className:"flex-1 bg-white dark:bg-black/20 p-1.5 rounded border font-mono text-[10px] break-all",children:[window.sbwpData.root,"wp-admin/admin-ajax.php?action=sbwp_oauth_callback"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"client_id",children:"Client ID"}),e.jsx(Q,{id:"client_id",placeholder:"xxxx.apps.googleusercontent.com",value:d,onChange:N=>v(N.target.value),className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"client_secret",children:"Client Secret"}),e.jsx(Q,{id:"client_secret",type:"password",placeholder:"Client Secret",value:k,onChange:N=>_(N.target.value),className:"font-mono text-xs"})]})]}),e.jsxs(S,{className:"w-full",onClick:async()=>{c("gdrive");try{const N=await Fe("gdrive","prepare",{client_id:d,client_secret:k});console.log("SBWP: Prepare result:",N);let F=N.auth_url;if(!F&&N.success){console.warn("SBWP: Server missing auth_url, using fallback.");const R=encodeURIComponent(`${window.sbwpData.root}wp-admin/admin-ajax.php?action=sbwp_oauth_callback`),I=encodeURIComponent("https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email");F=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${d}&redirect_uri=${R}&response_type=code&scope=${I}&access_type=offline&prompt=consent`}if(!F)throw new Error("Prepare failed - could not generate auth URL");const M=window.open(F,"sbwp_auth","width=600,height=700"),V=setInterval(()=>{M!=null&&M.closed&&(clearInterval(V),x(),c(null))},1e3);window.addEventListener("message",R=>{var I;((I=R.data)==null?void 0:I.type)==="sbwp_auth_success"&&(clearInterval(V),M==null||M.close(),x(),c(null),f(null))},{once:!0})}catch(N){console.error("SBWP Auth Error:",N),c(null),alert(N.message||"Failed to initialize authentication.")}},disabled:i===p.id||!p.global_creds&&(!d||!k),children:[i===p.id?e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Bs,{className:"mr-2 h-4 w-4"}),p.global_creds?"Connect YOUR Google Drive":"Connect Google Drive"]})]}),h===p.id&&["aws","do_spaces","wasabi"].includes(p.id)&&!p.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Access Key"}),e.jsx(Q,{value:y.accessKey,onChange:N=>j({...y,accessKey:N.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Secret Key"}),e.jsx(Q,{value:y.secretKey,onChange:N=>j({...y,secretKey:N.target.value}),type:"password",className:"font-mono text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Bucket Name"}),e.jsx(Q,{value:y.bucket,onChange:N=>j({...y,bucket:N.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{children:"Region"}),e.jsx(Q,{value:y.region,onChange:N=>j({...y,region:N.target.value}),placeholder:p.id==="do_spaces"?"nyc3":"us-east-1",type:"text",className:"font-mono text-xs"})]})]}),e.jsx(S,{className:"w-full",disabled:i===p.id||!y.accessKey||!y.secretKey||!y.bucket,onClick:async()=>{c(p.id);try{await Fe(p.id,"connect",{access_key:y.accessKey,secret_key:y.secretKey,bucket:y.bucket,region:y.region||"us-east-1",endpoint:y.endpoint}),x(),f(null),j({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""})}catch(N){console.error(N),alert(N.message||"Connection failed")}finally{c(null)}},children:i===p.id?e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}):"Connect Storage"})]})]},p.id)})]})]})]})})}function yn({onBack:s,onNavigate:t}){const[a,n]=r.useState({retention_limit:5}),[o,m]=r.useState(null),[i,c]=r.useState(null),[h,f]=r.useState(""),[d,v]=r.useState(""),[k,_]=r.useState(!0),[y,j]=r.useState(!1),[l,b]=r.useState(!1),[x,E]=r.useState(!1),{toast:p}=ie(),u=window.sbwpData.isPro;r.useEffect(()=>{(async()=>{try{const[I,W]=await Promise.all([Ys(),Va()]);if(n(I),c(W),u){const X=await Ua();m(X)}}catch(I){console.error(I),p({title:"Error",description:"Failed to load settings.",variant:"destructive"})}finally{_(!1)}})()},[u,p]);const N=async()=>{i!=null&&i.url&&(await Mt(i.url)?(E(!0),setTimeout(()=>E(!1),2e3),p({title:"Copied!",description:"Recovery URL copied to clipboard."})):p({title:"Copy Failed",description:"Please copy the URL manually.",variant:"destructive"}))},F=async()=>{if(confirm("Are you sure? This will invalidate your old recovery URL.")){j(!0);try{const R=await Ka();c(R),p({title:"Key Regenerated",description:"Your recovery URL has been updated."})}catch{p({title:"Error",description:"Failed to regenerate key.",variant:"destructive"})}finally{j(!1)}}},M=async()=>{if(confirm("Remove OpenAI API Key?")){j(!0);try{const R=await bs("");m(R),f(""),p({title:"API Key Removed"})}catch{p({title:"Error",description:"Failed to remove API key.",variant:"destructive"})}finally{j(!1)}}},V=async()=>{j(!0);const R=[];R.push(Qs(a)),d?R.push(Xa(d).then(I=>(c(I),v(""),I))):d===""&&(i==null||i.has_pin),u&&h&&R.push(bs(h).then(I=>(m(I),f(""),I)));try{await Promise.all(R),p({title:"Settings Saved",description:"All changes have been applied successfully."})}catch(I){console.error(I),p({title:"Error",description:"Some settings failed to save.",variant:"destructive"})}finally{j(!1)}};return k?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-8 pb-24",children:[e.jsx(wn,{open:l,onOpenChange:b}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(S,{variant:"ghost",className:"pl-0 gap-2 text-muted-foreground hover:text-foreground -ml-2 mb-2",onClick:s,children:[e.jsx(Is,{className:"h-4 w-4"}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(pa,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure backup preferences and security options"})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"General"}),e.jsx(Ce,{className:"flex-1"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(G,{children:[e.jsxs(Z,{className:"pb-4",children:[e.jsx(ee,{className:"text-base",children:"Backup Retention"}),e.jsx(ne,{children:"Number of recent backups to keep on the server."})]}),e.jsx(Y,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Q,{id:"retention",type:"number",min:1,max:50,className:"w-24",value:a.retention_limit,onChange:R=>n(I=>({...I,retention_limit:parseInt(R.target.value)||1}))}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"backups"})]})})]}),e.jsxs(G,{className:a.alerts_enabled?"ring-1 ring-red-500/20 bg-red-500/5":"",children:[e.jsxs(Z,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{className:"text-base flex items-center gap-2",children:[e.jsx(Zt,{className:"h-4 w-4"}),"Crash Alerts"]}),e.jsx(Ne,{id:"alerts-enabled",checked:a.alerts_enabled||!1,onCheckedChange:R=>n(I=>({...I,alerts_enabled:R}))})]}),e.jsx(ne,{children:"Receive an email with a recovery link if your site crashes."})]}),a.alerts_enabled&&e.jsx(Y,{className:"pt-0",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"alert-email",className:"text-sm",children:"Notification Email"}),e.jsx(Q,{id:"alert-email",type:"email",placeholder:"admin@example.com",value:a.alert_email||"",onChange:R=>n(I=>({...I,alert_email:R.target.value}))})]})})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Security"}),e.jsx(Ce,{className:"flex-1"})]}),e.jsxs(G,{className:"ring-1 ring-orange-500/20 bg-gradient-to-br from-orange-500/5 to-transparent",children:[e.jsxs(Z,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{className:"text-lg flex items-center gap-2",children:[e.jsx(ha,{className:"h-5 w-5 text-orange-600"}),"Recovery Portal"]}),(i==null?void 0:i.has_pin)&&e.jsxs("span",{className:"text-xs bg-emerald-500/10 text-emerald-600 px-2.5 py-1 rounded-full font-medium flex items-center gap-1.5 border border-emerald-500/20",children:[e.jsx(ca,{className:"h-3 w-3"}),"PIN Protected"]})]}),e.jsx(ne,{children:"Emergency access to your site when WordPress is down."})]}),e.jsxs(Y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-sm",children:"Recovery URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2 bg-muted/50 p-3 rounded-md border",children:[e.jsx("code",{className:"flex-1 text-xs font-mono truncate text-muted-foreground",children:i==null?void 0:i.url}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0",onClick:N,children:x?e.jsx(aa,{className:"h-3.5 w-3.5 text-emerald-600"}):e.jsx($s,{className:"h-3.5 w-3.5"})})]}),e.jsxs(S,{variant:"outline",size:"sm",className:"shrink-0 text-muted-foreground hover:text-destructive",onClick:F,children:[e.jsx(He,{className:"h-3.5 w-3.5 mr-2"}),"Reset"]})]})]}),e.jsxs("div",{className:"space-y-2 max-w-sm",children:[e.jsx(H,{className:"text-sm",children:i!=null&&i.has_pin?"Update PIN":"Set PIN (Optional)"}),e.jsx(Q,{type:"password",placeholder:i!=null&&i.has_pin?"Enter new PIN to change":"Enter PIN to protect portal",value:d,onChange:R=>v(R.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i!=null&&i.has_pin?"Leave blank to keep your current PIN.":"Add an extra layer of security to your recovery portal."})]})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Pro Features"}),e.jsx(Ce,{className:"flex-1"}),!u&&e.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-gradient-to-r from-violet-500/10 to-purple-500/10 text-violet-600 border border-violet-500/20",children:"Upgrade to Pro"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(G,{className:u?"":"opacity-60",children:[e.jsxs(Z,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{className:"text-base flex items-center gap-2",children:[e.jsx(Ms,{className:"h-4 w-4"}),"Cloud Storage"]}),!u&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded bg-slate-100 text-slate-500",children:"PRO"})]}),e.jsx(ne,{children:"Sync backups to Google Drive or AWS S3."})]}),e.jsx(Y,{children:e.jsx(S,{variant:u?"outline":"secondary",size:"sm",className:"w-full",onClick:()=>u&&b(!0),disabled:!u,children:u?"Configure Cloud":"Requires Pro"})})]}),e.jsxs(G,{className:u?"":"opacity-60",children:[e.jsxs(Z,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{className:"text-base flex items-center gap-2",children:[e.jsx(ta,{className:"h-4 w-4"}),"Schedules"]}),!u&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded bg-slate-100 text-slate-500",children:"PRO"})]}),e.jsx(ne,{children:"Automated daily or weekly backups."})]}),e.jsx(Y,{children:e.jsx(S,{variant:u?"outline":"secondary",size:"sm",className:"w-full",onClick:()=>u&&t("schedules"),disabled:!u,children:u?"Manage Schedules":"Requires Pro"})})]}),e.jsxs(G,{className:u?o!=null&&o.is_configured?"ring-1 ring-violet-500/20 bg-violet-500/5":"":"opacity-60",children:[e.jsxs(Z,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ee,{className:"text-base flex items-center gap-2",children:[e.jsx(Es,{className:"h-4 w-4 text-violet-500"}),"AI Assistant"]}),!u&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded bg-slate-100 text-slate-500",children:"PRO"}),u&&(o==null?void 0:o.is_configured)&&e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded bg-emerald-100 text-emerald-600",children:"ACTIVE"})]}),e.jsx(ne,{children:"AI-powered crash analysis and explanations."})]}),e.jsx(Y,{children:u?o!=null&&o.is_configured?e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-muted/50 rounded-md border",children:[e.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:o.masked_key}),e.jsx(S,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-destructive",onClick:M,children:e.jsx(fa,{className:"h-3.5 w-3.5"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{type:"password",className:"font-mono text-xs",placeholder:"sk-...",value:h,onChange:R=>f(R.target.value)}),e.jsx("p",{className:"text-[10px] text-muted-foreground text-right",children:"Enter your OpenAI API Key"})]}):e.jsx(S,{variant:"secondary",size:"sm",className:"w-full",disabled:!0,children:"Requires Pro"})})]})]})]}),e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:e.jsxs(S,{size:"lg",onClick:V,disabled:y,className:"shadow-xl rounded-full px-6 hover:scale-105 transition-transform",children:[y&&e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx(xa,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]})}function jn({onBack:s}){const[t,a]=r.useState([]),[n,o]=r.useState(!1),[m,i]=r.useState(!1),{toast:c}=ie(),h=async()=>{o(!0);try{const k=await(await fetch(`${window.sbwpData.restUrl}/schedules`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();a(k)}catch(v){console.error(v)}finally{o(!1)}};r.useEffect(()=>{h()},[]);const f=async v=>{i(!0);try{(await fetch(`${window.sbwpData.restUrl}/schedules`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({frequency:v,time:"00:00"})})).ok&&(c({title:"Schedule Created",description:`New ${v} schedule added.`}),h())}catch{c({title:"Error",variant:"destructive",description:"Failed to create schedule."})}finally{i(!1)}},d=async v=>{if(confirm("Delete this schedule?"))try{await fetch(`${window.sbwpData.restUrl}/schedules/${v}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}}),c({title:"Schedule Deleted"}),h()}catch{c({title:"Error",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(S,{variant:"ghost",size:"sm",onClick:s,children:[e.jsx(Is,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Scheduled Backups"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your automated backup routines."})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(G,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Create Schedule"}),e.jsx(ne,{children:"Add a new automated backup task."})]}),e.jsxs(Y,{className:"space-y-4",children:[e.jsxs(S,{className:"w-full justify-start",onClick:()=>f("daily"),disabled:m,children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),"Add Daily Backup"]}),e.jsxs(S,{className:"w-full justify-start",variant:"secondary",onClick:()=>f("weekly"),disabled:m,children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),"Add Weekly Backup"]})]})]}),e.jsxs(G,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Active Schedules"}),e.jsx(ne,{children:"Your currently running backup jobs."})]}),e.jsx(Y,{children:n?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No active schedules."}):e.jsx("div",{className:"space-y-2",children:t.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium capitalize",children:[v.frequency," Backup"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Next run: calculated by WP Cron"})]})]}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>d(v.id),children:e.jsx(Ws,{className:"h-4 w-4 text-red-500"})})]},v.id))})})]})]})]})}var vn=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),bn="VisuallyHidden",Ge=r.forwardRef((s,t)=>e.jsx(oe.span,{...s,ref:t,style:{...vn,...s.style}}));Ge.displayName=bn;var Ye="ToastProvider",[Qe,Nn,kn]=Ot("Toast"),[rt]=$t("Toast",[kn]),[Sn,Re]=rt(Ye),ot=s=>{const{__scopeToast:t,label:a="Notification",duration:n=5e3,swipeDirection:o="right",swipeThreshold:m=50,children:i}=s,[c,h]=r.useState(null),[f,d]=r.useState(0),v=r.useRef(!1),k=r.useRef(!1);return a.trim()||console.error(`Invalid prop \`label\` supplied to \`${Ye}\`. Expected non-empty \`string\`.`),e.jsx(Qe.Provider,{scope:t,children:e.jsx(Sn,{scope:t,label:a,duration:n,swipeDirection:o,swipeThreshold:m,toastCount:f,viewport:c,onViewportChange:h,onToastAdd:r.useCallback(()=>d(_=>_+1),[]),onToastRemove:r.useCallback(()=>d(_=>_-1),[]),isFocusedToastEscapeKeyDownRef:v,isClosePausedRef:k,children:i})})};ot.displayName=Ye;var it="ToastViewport",Cn=["F8"],We="toast.viewportPause",Ve="toast.viewportResume",lt=r.forwardRef((s,t)=>{const{__scopeToast:a,hotkey:n=Cn,label:o="Notifications ({hotkey})",...m}=s,i=Re(it,a),c=Nn(a),h=r.useRef(null),f=r.useRef(null),d=r.useRef(null),v=r.useRef(null),k=Ds(t,v,i.onViewportChange),_=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=i.toastCount>0;r.useEffect(()=>{const l=b=>{var E;n.length!==0&&n.every(p=>b[p]||b.code===p)&&((E=v.current)==null||E.focus())};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[n]),r.useEffect(()=>{const l=h.current,b=v.current;if(y&&l&&b){const x=()=>{if(!i.isClosePausedRef.current){const N=new CustomEvent(We);b.dispatchEvent(N),i.isClosePausedRef.current=!0}},E=()=>{if(i.isClosePausedRef.current){const N=new CustomEvent(Ve);b.dispatchEvent(N),i.isClosePausedRef.current=!1}},p=N=>{!l.contains(N.relatedTarget)&&E()},u=()=>{l.contains(document.activeElement)||E()};return l.addEventListener("focusin",x),l.addEventListener("focusout",p),l.addEventListener("pointermove",x),l.addEventListener("pointerleave",u),window.addEventListener("blur",x),window.addEventListener("focus",E),()=>{l.removeEventListener("focusin",x),l.removeEventListener("focusout",p),l.removeEventListener("pointermove",x),l.removeEventListener("pointerleave",u),window.removeEventListener("blur",x),window.removeEventListener("focus",E)}}},[y,i.isClosePausedRef]);const j=r.useCallback(({tabbingDirection:l})=>{const x=c().map(E=>{const p=E.ref.current,u=[p,...Bn(p)];return l==="forwards"?u:u.reverse()});return(l==="forwards"?x.reverse():x).flat()},[c]);return r.useEffect(()=>{const l=v.current;if(l){const b=x=>{var u,N,F;const E=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!E){const M=document.activeElement,V=x.shiftKey;if(x.target===l&&V){(u=f.current)==null||u.focus();return}const W=j({tabbingDirection:V?"backwards":"forwards"}),X=W.findIndex(P=>P===M);Oe(W.slice(X+1))?x.preventDefault():V?(N=f.current)==null||N.focus():(F=d.current)==null||F.focus()}};return l.addEventListener("keydown",b),()=>l.removeEventListener("keydown",b)}},[c,j]),e.jsxs(Bt,{ref:h,role:"region","aria-label":o.replace("{hotkey}",_),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&e.jsx(Xe,{ref:f,onFocusFromOutsideViewport:()=>{const l=j({tabbingDirection:"forwards"});Oe(l)}}),e.jsx(Qe.Slot,{scope:a,children:e.jsx(oe.ol,{tabIndex:-1,...m,ref:k})}),y&&e.jsx(Xe,{ref:d,onFocusFromOutsideViewport:()=>{const l=j({tabbingDirection:"backwards"});Oe(l)}})]})});lt.displayName=it;var ct="ToastFocusProxy",Xe=r.forwardRef((s,t)=>{const{__scopeToast:a,onFocusFromOutsideViewport:n,...o}=s,m=Re(ct,a);return e.jsx(Ge,{tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{var f;const c=i.relatedTarget;!((f=m.viewport)!=null&&f.contains(c))&&n()}})});Xe.displayName=ct;var ve="Toast",Pn="toast.swipeStart",Tn="toast.swipeMove",En="toast.swipeCancel",Dn="toast.swipeEnd",dt=r.forwardRef((s,t)=>{const{forceMount:a,open:n,defaultOpen:o,onOpenChange:m,...i}=s,[c,h]=Lt({prop:n,defaultProp:o??!0,onChange:m,caller:ve});return e.jsx(zt,{present:a||c,children:e.jsx(In,{open:c,...i,ref:t,onClose:()=>h(!1),onPause:Pe(s.onPause),onResume:Pe(s.onResume),onSwipeStart:te(s.onSwipeStart,f=>{f.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:te(s.onSwipeMove,f=>{const{x:d,y:v}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","move"),f.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${v}px`)}),onSwipeCancel:te(s.onSwipeCancel,f=>{f.currentTarget.setAttribute("data-swipe","cancel"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:te(s.onSwipeEnd,f=>{const{x:d,y:v}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","end"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${v}px`),h(!1)})})})});dt.displayName=ve;var[_n,Rn]=rt(ve,{onClose(){}}),In=r.forwardRef((s,t)=>{const{__scopeToast:a,type:n="foreground",duration:o,open:m,onClose:i,onEscapeKeyDown:c,onPause:h,onResume:f,onSwipeStart:d,onSwipeMove:v,onSwipeCancel:k,onSwipeEnd:_,...y}=s,j=Re(ve,a),[l,b]=r.useState(null),x=Ds(t,P=>b(P)),E=r.useRef(null),p=r.useRef(null),u=o||j.duration,N=r.useRef(0),F=r.useRef(u),M=r.useRef(0),{onToastAdd:V,onToastRemove:R}=j,I=Pe(()=>{var g;(l==null?void 0:l.contains(document.activeElement))&&((g=j.viewport)==null||g.focus()),i()}),W=r.useCallback(P=>{!P||P===1/0||(window.clearTimeout(M.current),N.current=new Date().getTime(),M.current=window.setTimeout(I,P))},[I]);r.useEffect(()=>{const P=j.viewport;if(P){const g=()=>{W(F.current),f==null||f()},D=()=>{const $=new Date().getTime()-N.current;F.current=F.current-$,window.clearTimeout(M.current),h==null||h()};return P.addEventListener(We,D),P.addEventListener(Ve,g),()=>{P.removeEventListener(We,D),P.removeEventListener(Ve,g)}}},[j.viewport,u,h,f,W]),r.useEffect(()=>{m&&!j.isClosePausedRef.current&&W(u)},[m,u,j.isClosePausedRef,W]),r.useEffect(()=>(V(),()=>R()),[V,R]);const X=r.useMemo(()=>l?gt(l):null,[l]);return j.viewport?e.jsxs(e.Fragment,{children:[X&&e.jsx(An,{__scopeToast:a,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:X}),e.jsx(_n,{scope:a,onClose:I,children:Ut.createPortal(e.jsx(Qe.ItemSlot,{scope:a,children:e.jsx(Wt,{asChild:!0,onEscapeKeyDown:te(c,()=>{j.isFocusedToastEscapeKeyDownRef.current||I(),j.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(oe.li,{tabIndex:0,"data-state":m?"open":"closed","data-swipe-direction":j.swipeDirection,...y,ref:x,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:te(s.onKeyDown,P=>{P.key==="Escape"&&(c==null||c(P.nativeEvent),P.nativeEvent.defaultPrevented||(j.isFocusedToastEscapeKeyDownRef.current=!0,I()))}),onPointerDown:te(s.onPointerDown,P=>{P.button===0&&(E.current={x:P.clientX,y:P.clientY})}),onPointerMove:te(s.onPointerMove,P=>{if(!E.current)return;const g=P.clientX-E.current.x,D=P.clientY-E.current.y,$=!!p.current,C=["left","right"].includes(j.swipeDirection),B=["left","up"].includes(j.swipeDirection)?Math.min:Math.max,A=C?B(0,g):0,re=C?0:B(0,D),ce=P.pointerType==="touch"?10:2,q={x:A,y:re},de={originalEvent:P,delta:q};$?(p.current=q,be(Tn,v,de,{discrete:!1})):Ss(q,j.swipeDirection,ce)?(p.current=q,be(Pn,d,de,{discrete:!1}),P.target.setPointerCapture(P.pointerId)):(Math.abs(g)>ce||Math.abs(D)>ce)&&(E.current=null)}),onPointerUp:te(s.onPointerUp,P=>{const g=p.current,D=P.target;if(D.hasPointerCapture(P.pointerId)&&D.releasePointerCapture(P.pointerId),p.current=null,E.current=null,g){const $=P.currentTarget,C={originalEvent:P,delta:g};Ss(g,j.swipeDirection,j.swipeThreshold)?be(Dn,_,C,{discrete:!0}):be(En,k,C,{discrete:!0}),$.addEventListener("click",B=>B.preventDefault(),{once:!0})}})})})}),j.viewport)})]}):null}),An=s=>{const{__scopeToast:t,children:a,...n}=s,o=Re(ve,t),[m,i]=r.useState(!1),[c,h]=r.useState(!1);return $n(()=>i(!0)),r.useEffect(()=>{const f=window.setTimeout(()=>h(!0),1e3);return()=>window.clearTimeout(f)},[]),c?null:e.jsx(Vt,{asChild:!0,children:e.jsx(Ge,{...n,children:m&&e.jsxs(e.Fragment,{children:[o.label," ",a]})})})},Fn="ToastTitle",ut=r.forwardRef((s,t)=>{const{__scopeToast:a,...n}=s;return e.jsx(oe.div,{...n,ref:t})});ut.displayName=Fn;var Mn="ToastDescription",mt=r.forwardRef((s,t)=>{const{__scopeToast:a,...n}=s;return e.jsx(oe.div,{...n,ref:t})});mt.displayName=Mn;var xt="ToastAction",pt=r.forwardRef((s,t)=>{const{altText:a,...n}=s;return a.trim()?e.jsx(ft,{altText:a,asChild:!0,children:e.jsx(Ze,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${xt}\`. Expected non-empty \`string\`.`),null)});pt.displayName=xt;var ht="ToastClose",Ze=r.forwardRef((s,t)=>{const{__scopeToast:a,...n}=s,o=Rn(ht,a);return e.jsx(ft,{asChild:!0,children:e.jsx(oe.button,{type:"button",...n,ref:t,onClick:te(s.onClick,o.onClose)})})});Ze.displayName=ht;var ft=r.forwardRef((s,t)=>{const{__scopeToast:a,altText:n,...o}=s;return e.jsx(oe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...o,ref:t})});function gt(s){const t=[];return Array.from(s.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),On(n)){const o=n.ariaHidden||n.hidden||n.style.display==="none",m=n.dataset.radixToastAnnounceExclude==="";if(!o)if(m){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...gt(n))}}),t}function be(s,t,a,{discrete:n}){const o=a.originalEvent.currentTarget,m=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:a});t&&o.addEventListener(s,t,{once:!0}),n?Xt(o,m):o.dispatchEvent(m)}var Ss=(s,t,a=0)=>{const n=Math.abs(s.x),o=Math.abs(s.y),m=n>o;return t==="left"||t==="right"?m&&n>a:!m&&o>a};function $n(s=()=>{}){const t=Pe(s);Kt(()=>{let a=0,n=0;return a=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(n)}},[t])}function On(s){return s.nodeType===s.ELEMENT_NODE}function Bn(s){const t=[],a=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)t.push(a.currentNode);return t}function Oe(s){const t=document.activeElement;return s.some(a=>a===t?!0:(a.focus(),document.activeElement!==t))}var Ln=ot,wt=lt,yt=dt,jt=ut,vt=mt,bt=pt,Nt=Ze;const zn=Ln,kt=r.forwardRef(({className:s,...t},a)=>e.jsx(wt,{ref:a,className:U("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));kt.displayName=wt.displayName;const Un=Ts("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),St=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(yt,{ref:n,className:U(Un({variant:t}),s),...a}));St.displayName=yt.displayName;const Wn=r.forwardRef(({className:s,...t},a)=>e.jsx(bt,{ref:a,className:U("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Wn.displayName=bt.displayName;const Ct=r.forwardRef(({className:s,...t},a)=>e.jsx(Nt,{ref:a,className:U("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Ht,{className:"h-4 w-4"})}));Ct.displayName=Nt.displayName;const Pt=r.forwardRef(({className:s,...t},a)=>e.jsx(jt,{ref:a,className:U("text-sm font-semibold",s),...t}));Pt.displayName=jt.displayName;const Tt=r.forwardRef(({className:s,...t},a)=>e.jsx(vt,{ref:a,className:U("text-sm opacity-90",s),...t}));Tt.displayName=vt.displayName;function Vn(){const{toasts:s}=ie();return e.jsxs(zn,{children:[s.map(function({id:t,title:a,description:n,action:o,...m}){return e.jsxs(St,{...m,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(Pt,{children:a}),n&&e.jsx(Tt,{children:n})]}),o,e.jsx(Ct,{})]},t)}),e.jsx(kt,{})]})}function Cs(){const[s,t]=r.useState("dashboard");return e.jsxs(e.Fragment,{children:[e.jsx(Vn,{}),e.jsx("div",{className:"min-h-screen bg-background p-8 font-sans antialiased text-foreground",children:e.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"SafeBackup & Repair"}),e.jsxs("div",{className:"flex items-center gap-2",children:[window.sbwpData.isPro?e.jsx("span",{className:"text-xs font-medium text-emerald-600 bg-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-400 px-2 py-1 rounded-full border border-emerald-200 dark:border-emerald-800",children:"Pro Active"}):e.jsx("span",{className:"text-xs font-medium text-slate-600 bg-slate-100 dark:bg-slate-900/30 dark:text-slate-400 px-2 py-1 rounded-full border border-slate-200 dark:border-slate-800",children:"Free Edition"}),e.jsx("button",{onClick:()=>t("settings"),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Settings"})]})]}),s==="dashboard"&&e.jsx(mn,{onNavigate:t}),s==="settings"&&e.jsx(yn,{onBack:()=>t("dashboard"),onNavigate:t}),s==="schedules"&&e.jsx(jn,{onBack:()=>t("dashboard")})]})})]})}const Ps=document.getElementById("sbwp-admin-root");if(Ps)ms.createRoot(Ps).render(e.jsx(xs.StrictMode,{children:e.jsx(Cs,{})}));else{const s=document.getElementById("root");s&&ms.createRoot(s).render(e.jsx(xs.StrictMode,{children:e.jsx(Cs,{})}))}
