import{r as n,j as e,c as ns,a as U,b as rs,d as D,P as J,e as tt,f as at,u as os,B as nt,g as rt,h as ot,i as G,k as pe,l as it,R as lt,m as ct,n as dt,o as ut,C as mt,D as ae,p as ne,q as re,s as oe,t as we,L as O,v as N,w as _e,S as is,A as ge,T as xt,x as ht,y as Le,z as Ue,E as pt,F as ft,G as K,H,I as q,J as Y,K as X,M as de,N as wt,O as ze,Q as We}from"./globals-DXaPY4QX.js";var gt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],yt=gt.reduce((s,t)=>{const a=ns(`Primitive.${t}`),r=n.forwardRef((o,x)=>{const{asChild:i,...u}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...u,ref:x})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),jt="Label",ls=n.forwardRef((s,t)=>e.jsx(yt.label,{...s,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=s.onMouseDown)==null||o.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));ls.displayName=jt;var cs=ls;const vt=rs("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),W=n.forwardRef(({className:s,...t},a)=>e.jsx(cs,{ref:a,className:U(vt(),s),...t}));W.displayName=cs.displayName;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=D("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=D("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=D("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=D("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=D("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=D("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.25V14",key:"re2vv1"}],["path",{d:"M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z",key:"ame013"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=D("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=D("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=D("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=D("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=D("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=D("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=D("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=D("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=D("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=D("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=D("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=D("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=D("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=D("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=D("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=D("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=D("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=D("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=D("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=D("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=D("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=D("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=D("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=D("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=D("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=D("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=D("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=D("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=D("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=D("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Bt(s,t=[]){let a=[];function r(x,i){const u=n.createContext(i);u.displayName=x+"Context";const d=a.length;a=[...a,i];const h=v=>{var y;const{scope:k,children:_,...w}=v,g=((y=k==null?void 0:k[s])==null?void 0:y[d])||u,l=n.useMemo(()=>w,Object.values(w));return e.jsx(g.Provider,{value:l,children:_})};h.displayName=x+"Provider";function j(v,k){var g;const _=((g=k==null?void 0:k[s])==null?void 0:g[d])||u,w=n.useContext(_);if(w)return w;if(i!==void 0)return i;throw new Error(`\`${v}\` must be used within \`${x}\``)}return[h,j]}const o=()=>{const x=a.map(i=>n.createContext(i));return function(u){const d=(u==null?void 0:u[s])||x;return n.useMemo(()=>({[`__scope${s}`]:{...u,[s]:d}}),[u,d])}};return o.scopeName=s,[r,Lt(o,...t)]}function Lt(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const r=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(x){const i=r.reduce((u,{useScope:d,scopeName:h})=>{const v=d(x)[`__scope${h}`];return{...u,...v}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return a.scopeName=t.scopeName,a}var Ut=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ys=Ut.reduce((s,t)=>{const a=ns(`Primitive.${t}`),r=n.forwardRef((o,x)=>{const{asChild:i,...u}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...u,ref:x})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),Ie="Progress",Ae=100,[zt]=Bt(Ie),[Wt,Vt]=zt(Ie),js=n.forwardRef((s,t)=>{const{__scopeProgress:a,value:r=null,max:o,getValueLabel:x=Kt,...i}=s;(o||o===0)&&!Ye(o)&&console.error(Xt(`${o}`,"Progress"));const u=Ye(o)?o:Ae;r!==null&&!Je(r,u)&&console.error(Ht(`${r}`,"Progress"));const d=Je(r,u)?r:null,h=fe(d)?x(d,u):void 0;return e.jsx(Wt,{scope:a,value:d,max:u,children:e.jsx(ys.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":fe(d)?d:void 0,"aria-valuetext":h,role:"progressbar","data-state":Ns(d,u),"data-value":d??void 0,"data-max":u,...i,ref:t})})});js.displayName=Ie;var vs="ProgressIndicator",bs=n.forwardRef((s,t)=>{const{__scopeProgress:a,...r}=s,o=Vt(vs,a);return e.jsx(ys.div,{"data-state":Ns(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...r,ref:t})});bs.displayName=vs;function Kt(s,t){return`${Math.round(s/t*100)}%`}function Ns(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function fe(s){return typeof s=="number"}function Ye(s){return fe(s)&&!isNaN(s)&&s>0}function Je(s,t){return fe(s)&&!isNaN(s)&&s<=t&&s>=0}function Xt(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ae}\`.`}function Ht(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ae} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ks=js,qt=bs;const Ss=n.forwardRef(({className:s,value:t,indicatorClassName:a,...r},o)=>e.jsx(ks,{ref:o,className:U("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(qt,{className:U("h-full w-full flex-1 bg-primary transition-all",a),style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ss.displayName=ks.displayName;async function Gt(){const s=await fetch(`${window.sbwpData.restUrl}/stats`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch stats");return s.json()}async function Yt(){const s=await fetch(`${window.sbwpData.restUrl}/backups`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch backups");return s.json()}async function Jt(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to delete backup")}return t.json()}async function Zt(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}/files`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch backup files");return t.json()}async function Qt(s,t="/"){const a=await fetch(`${window.sbwpData.restUrl}/backups/${s}/download?path=${encodeURIComponent(t)}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!a.ok)throw new Error("Failed to get download URL");return a.json()}async function ea(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}/contents`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch backup contents");return t.json()}async function Ze(s,t){const a=await fetch(`${window.sbwpData.restUrl}/backups/${s}/restore`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({items:t})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to restore backup")}return a.json()}async function sa(){try{const s=await fetch(`${window.sbwpData.restUrl}/backup/progress?t=${Date.now()}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)return{percent:0,message:"Idle"};const t=await s.text();return t?JSON.parse(t):{percent:0,message:"Idle"}}catch{return{percent:0,message:"Idle"}}}async function ta(){const s=await fetch(`${window.sbwpData.restUrl}/backup/cancel`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to cancel backup");return await s.json()}async function aa(){const s=await fetch(`${window.sbwpData.restUrl}/cloud/providers`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(s.status===404)return[];if(!s.ok)throw new Error("Failed to fetch cloud providers");return s.json()}async function be(s,t,a){const r=await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/connect`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({provider_id:s,action:t,...a})}),o=await r.json();if(!r.ok)throw new Error(o.message||"Failed to connect");return o}async function na(){return(await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json()}async function ra(s){await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify(s)})}async function Cs(){const s=await fetch(`${window.sbwpData.restUrl}/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch settings");return s.json()}async function Ts(s){const t=await fetch(`${window.sbwpData.restUrl}/settings`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to save settings");return t.json()}async function oa(s="full",t=!1,a){const r=await fetch(`${window.sbwpData.restUrl}/backups`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({type:s,resume:t,session_id:a})}),o=await r.text();if(!o)throw console.error(`SBWP Fetch Error: Empty response. Status: ${r.status} ${r.statusText}`),new Error(`Empty response from server (Status ${r.status})`);try{const x=JSON.parse(o);if(!r.ok)throw new Error(x.message||"Failed to create backup");return x}catch{throw console.error("JSON Parse Error:",o),new Error("Invalid server response")}}async function ia(){const s=await fetch(`${window.sbwpData.restUrl}/safe-update/available`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch available updates");return s.json()}async function la(s,t=[],a=!1){const r=await fetch(`${window.sbwpData.restUrl}/safe-update/session`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({plugins:s,themes:t,core:a})});if(!r.ok)throw new Error("Failed to create safe update session");return r.json()}async function ca(s){const t=await fetch(`${window.sbwpData.restUrl}/safe-update/session/${s}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch session");return t.json()}async function da(){const s=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch AI settings");return s.json()}async function Qe(s){const t=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({api_key:s})});if(!t.ok)throw new Error("Failed to save AI settings");return t.json()}async function ua(s){const t=await fetch(`${window.sbwpData.restUrl}/ai/humanize-report`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({session_id:s})});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to get AI summary")}return t.json()}async function ma(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch recovery settings");return s.json()}async function xa(s){const t=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({pin:s})});if(!t.ok)throw new Error("Failed to save recovery PIN");return t.json()}async function ha(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/regenerate-key`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to regenerate key");return s.json()}async function pa(){const s=await fetch(`${window.sbwpData.restUrl}/crash-status`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to get crash status");return s.json()}const fa=1,wa=1e6;let Ne=0;function ga(){return Ne=(Ne+1)%Number.MAX_SAFE_INTEGER,Ne.toString()}const ke=new Map,es=s=>{if(ke.has(s))return;const t=setTimeout(()=>{ke.delete(s),te({type:"REMOVE_TOAST",toastId:s})},wa);ke.set(s,t)},ya=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,fa)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?es(a):s.toasts.forEach(r=>{es(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===a||t.toastId===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},xe=[];let he={toasts:[]};function te(s){he=ya(he,s),xe.forEach(t=>{t(he)})}function ja({...s}){const t=ga(),a=o=>te({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>te({type:"DISMISS_TOAST",toastId:t});return te({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:a}}function Z(){const[s,t]=n.useState(he);return n.useEffect(()=>(xe.push(t),()=>{const a=xe.indexOf(t);a>-1&&xe.splice(a,1)}),[s]),{...s,toast:ja,dismiss:a=>te({type:"DISMISS_TOAST",toastId:a})}}var va=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),ba="VisuallyHidden",Fe=n.forwardRef((s,t)=>e.jsx(J.span,{...s,ref:t,style:{...va,...s.style}}));Fe.displayName=ba;var Me="ToastProvider",[Oe,Na,ka]=at("Toast"),[Ps]=tt("Toast",[ka]),[Sa,ye]=Ps(Me),Es=s=>{const{__scopeToast:t,label:a="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:x=50,children:i}=s,[u,d]=n.useState(null),[h,j]=n.useState(0),v=n.useRef(!1),k=n.useRef(!1);return a.trim()||console.error(`Invalid prop \`label\` supplied to \`${Me}\`. Expected non-empty \`string\`.`),e.jsx(Oe.Provider,{scope:t,children:e.jsx(Sa,{scope:t,label:a,duration:r,swipeDirection:o,swipeThreshold:x,toastCount:h,viewport:u,onViewportChange:d,onToastAdd:n.useCallback(()=>j(_=>_+1),[]),onToastRemove:n.useCallback(()=>j(_=>_-1),[]),isFocusedToastEscapeKeyDownRef:v,isClosePausedRef:k,children:i})})};Es.displayName=Me;var Ds="ToastViewport",Ca=["F8"],Te="toast.viewportPause",Pe="toast.viewportResume",_s=n.forwardRef((s,t)=>{const{__scopeToast:a,hotkey:r=Ca,label:o="Notifications ({hotkey})",...x}=s,i=ye(Ds,a),u=Na(a),d=n.useRef(null),h=n.useRef(null),j=n.useRef(null),v=n.useRef(null),k=os(t,v,i.onViewportChange),_=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),w=i.toastCount>0;n.useEffect(()=>{const l=y=>{var P;r.length!==0&&r.every(p=>y[p]||y.code===p)&&((P=v.current)==null||P.focus())};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[r]),n.useEffect(()=>{const l=d.current,y=v.current;if(w&&l&&y){const m=()=>{if(!i.isClosePausedRef.current){const b=new CustomEvent(Te);y.dispatchEvent(b),i.isClosePausedRef.current=!0}},P=()=>{if(i.isClosePausedRef.current){const b=new CustomEvent(Pe);y.dispatchEvent(b),i.isClosePausedRef.current=!1}},p=b=>{!l.contains(b.relatedTarget)&&P()},f=()=>{l.contains(document.activeElement)||P()};return l.addEventListener("focusin",m),l.addEventListener("focusout",p),l.addEventListener("pointermove",m),l.addEventListener("pointerleave",f),window.addEventListener("blur",m),window.addEventListener("focus",P),()=>{l.removeEventListener("focusin",m),l.removeEventListener("focusout",p),l.removeEventListener("pointermove",m),l.removeEventListener("pointerleave",f),window.removeEventListener("blur",m),window.removeEventListener("focus",P)}}},[w,i.isClosePausedRef]);const g=n.useCallback(({tabbingDirection:l})=>{const m=u().map(P=>{const p=P.ref.current,f=[p,...Ba(p)];return l==="forwards"?f:f.reverse()});return(l==="forwards"?m.reverse():m).flat()},[u]);return n.useEffect(()=>{const l=v.current;if(l){const y=m=>{var f,b,M;const P=m.altKey||m.ctrlKey||m.metaKey;if(m.key==="Tab"&&!P){const A=document.activeElement,$=m.shiftKey;if(m.target===l&&$){(f=h.current)==null||f.focus();return}const I=g({tabbingDirection:$?"backwards":"forwards"}),F=I.findIndex(S=>S===A);Se(I.slice(F+1))?m.preventDefault():$?(b=h.current)==null||b.focus():(M=j.current)==null||M.focus()}};return l.addEventListener("keydown",y),()=>l.removeEventListener("keydown",y)}},[u,g]),e.jsxs(nt,{ref:d,role:"region","aria-label":o.replace("{hotkey}",_),tabIndex:-1,style:{pointerEvents:w?void 0:"none"},children:[w&&e.jsx(Ee,{ref:h,onFocusFromOutsideViewport:()=>{const l=g({tabbingDirection:"forwards"});Se(l)}}),e.jsx(Oe.Slot,{scope:a,children:e.jsx(J.ol,{tabIndex:-1,...x,ref:k})}),w&&e.jsx(Ee,{ref:j,onFocusFromOutsideViewport:()=>{const l=g({tabbingDirection:"backwards"});Se(l)}})]})});_s.displayName=Ds;var Rs="ToastFocusProxy",Ee=n.forwardRef((s,t)=>{const{__scopeToast:a,onFocusFromOutsideViewport:r,...o}=s,x=ye(Rs,a);return e.jsx(Fe,{tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{var h;const u=i.relatedTarget;!((h=x.viewport)!=null&&h.contains(u))&&r()}})});Ee.displayName=Rs;var ie="Toast",Ta="toast.swipeStart",Pa="toast.swipeMove",Ea="toast.swipeCancel",Da="toast.swipeEnd",Is=n.forwardRef((s,t)=>{const{forceMount:a,open:r,defaultOpen:o,onOpenChange:x,...i}=s,[u,d]=rt({prop:r,defaultProp:o??!0,onChange:x,caller:ie});return e.jsx(ot,{present:a||u,children:e.jsx(Ia,{open:u,...i,ref:t,onClose:()=>d(!1),onPause:pe(s.onPause),onResume:pe(s.onResume),onSwipeStart:G(s.onSwipeStart,h=>{h.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:G(s.onSwipeMove,h=>{const{x:j,y:v}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","move"),h.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${j}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${v}px`)}),onSwipeCancel:G(s.onSwipeCancel,h=>{h.currentTarget.setAttribute("data-swipe","cancel"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:G(s.onSwipeEnd,h=>{const{x:j,y:v}=h.detail.delta;h.currentTarget.setAttribute("data-swipe","end"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),h.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),h.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${j}px`),h.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${v}px`),d(!1)})})})});Is.displayName=ie;var[_a,Ra]=Ps(ie,{onClose(){}}),Ia=n.forwardRef((s,t)=>{const{__scopeToast:a,type:r="foreground",duration:o,open:x,onClose:i,onEscapeKeyDown:u,onPause:d,onResume:h,onSwipeStart:j,onSwipeMove:v,onSwipeCancel:k,onSwipeEnd:_,...w}=s,g=ye(ie,a),[l,y]=n.useState(null),m=os(t,S=>y(S)),P=n.useRef(null),p=n.useRef(null),f=o||g.duration,b=n.useRef(0),M=n.useRef(f),A=n.useRef(0),{onToastAdd:$,onToastRemove:z}=g,E=pe(()=>{var c;(l==null?void 0:l.contains(document.activeElement))&&((c=g.viewport)==null||c.focus()),i()}),I=n.useCallback(S=>{!S||S===1/0||(window.clearTimeout(A.current),b.current=new Date().getTime(),A.current=window.setTimeout(E,S))},[E]);n.useEffect(()=>{const S=g.viewport;if(S){const c=()=>{I(M.current),h==null||h()},C=()=>{const B=new Date().getTime()-b.current;M.current=M.current-B,window.clearTimeout(A.current),d==null||d()};return S.addEventListener(Te,C),S.addEventListener(Pe,c),()=>{S.removeEventListener(Te,C),S.removeEventListener(Pe,c)}}},[g.viewport,f,d,h,I]),n.useEffect(()=>{x&&!g.isClosePausedRef.current&&I(f)},[x,f,g.isClosePausedRef,I]),n.useEffect(()=>($(),()=>z()),[$,z]);const F=n.useMemo(()=>l?Ls(l):null,[l]);return g.viewport?e.jsxs(e.Fragment,{children:[F&&e.jsx(Aa,{__scopeToast:a,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:F}),e.jsx(_a,{scope:a,onClose:E,children:it.createPortal(e.jsx(Oe.ItemSlot,{scope:a,children:e.jsx(lt,{asChild:!0,onEscapeKeyDown:G(u,()=>{g.isFocusedToastEscapeKeyDownRef.current||E(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(J.li,{tabIndex:0,"data-state":x?"open":"closed","data-swipe-direction":g.swipeDirection,...w,ref:m,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:G(s.onKeyDown,S=>{S.key==="Escape"&&(u==null||u(S.nativeEvent),S.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,E()))}),onPointerDown:G(s.onPointerDown,S=>{S.button===0&&(P.current={x:S.clientX,y:S.clientY})}),onPointerMove:G(s.onPointerMove,S=>{if(!P.current)return;const c=S.clientX-P.current.x,C=S.clientY-P.current.y,B=!!p.current,T=["left","right"].includes(g.swipeDirection),L=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,R=T?L(0,c):0,Q=T?0:L(0,C),je=S.pointerType==="touch"?10:2,le={x:R,y:Q},Be={originalEvent:S,delta:le};B?(p.current=le,ce(Pa,v,Be,{discrete:!1})):ss(le,g.swipeDirection,je)?(p.current=le,ce(Ta,j,Be,{discrete:!1}),S.target.setPointerCapture(S.pointerId)):(Math.abs(c)>je||Math.abs(C)>je)&&(P.current=null)}),onPointerUp:G(s.onPointerUp,S=>{const c=p.current,C=S.target;if(C.hasPointerCapture(S.pointerId)&&C.releasePointerCapture(S.pointerId),p.current=null,P.current=null,c){const B=S.currentTarget,T={originalEvent:S,delta:c};ss(c,g.swipeDirection,g.swipeThreshold)?ce(Da,_,T,{discrete:!0}):ce(Ea,k,T,{discrete:!0}),B.addEventListener("click",L=>L.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Aa=s=>{const{__scopeToast:t,children:a,...r}=s,o=ye(ie,t),[x,i]=n.useState(!1),[u,d]=n.useState(!1);return Oa(()=>i(!0)),n.useEffect(()=>{const h=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(h)},[]),u?null:e.jsx(ct,{asChild:!0,children:e.jsx(Fe,{...r,children:x&&e.jsxs(e.Fragment,{children:[o.label," ",a]})})})},Fa="ToastTitle",As=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s;return e.jsx(J.div,{...r,ref:t})});As.displayName=Fa;var Ma="ToastDescription",Fs=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s;return e.jsx(J.div,{...r,ref:t})});Fs.displayName=Ma;var Ms="ToastAction",Os=n.forwardRef((s,t)=>{const{altText:a,...r}=s;return a.trim()?e.jsx(Bs,{altText:a,asChild:!0,children:e.jsx($e,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Ms}\`. Expected non-empty \`string\`.`),null)});Os.displayName=Ms;var $s="ToastClose",$e=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s,o=Ra($s,a);return e.jsx(Bs,{asChild:!0,children:e.jsx(J.button,{type:"button",...r,ref:t,onClick:G(s.onClick,o.onClose)})})});$e.displayName=$s;var Bs=n.forwardRef((s,t)=>{const{__scopeToast:a,altText:r,...o}=s;return e.jsx(J.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function Ls(s){const t=[];return Array.from(s.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),$a(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",x=r.dataset.radixToastAnnounceExclude==="";if(!o)if(x){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...Ls(r))}}),t}function ce(s,t,a,{discrete:r}){const o=a.originalEvent.currentTarget,x=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:a});t&&o.addEventListener(s,t,{once:!0}),r?dt(o,x):o.dispatchEvent(x)}var ss=(s,t,a=0)=>{const r=Math.abs(s.x),o=Math.abs(s.y),x=r>o;return t==="left"||t==="right"?x&&r>a:!x&&o>a};function Oa(s=()=>{}){const t=pe(s);ut(()=>{let a=0,r=0;return a=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(r)}},[t])}function $a(s){return s.nodeType===s.ELEMENT_NODE}function Ba(s){const t=[],a=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)t.push(a.currentNode);return t}function Se(s){const t=document.activeElement;return s.some(a=>a===t?!0:(a.focus(),document.activeElement!==t))}var La=Es,Us=_s,zs=Is,Ws=As,Vs=Fs,Ks=Os,Xs=$e;const Ua=La,Hs=n.forwardRef(({className:s,...t},a)=>e.jsx(Us,{ref:a,className:U("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));Hs.displayName=Us.displayName;const za=rs("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),qs=n.forwardRef(({className:s,variant:t,...a},r)=>e.jsx(zs,{ref:r,className:U(za({variant:t}),s),...a}));qs.displayName=zs.displayName;const Wa=n.forwardRef(({className:s,...t},a)=>e.jsx(Ks,{ref:a,className:U("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Wa.displayName=Ks.displayName;const Gs=n.forwardRef(({className:s,...t},a)=>e.jsx(Xs,{ref:a,className:U("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(mt,{className:"h-4 w-4"})}));Gs.displayName=Xs.displayName;const Ys=n.forwardRef(({className:s,...t},a)=>e.jsx(Ws,{ref:a,className:U("text-sm font-semibold",s),...t}));Ys.displayName=Ws.displayName;const Js=n.forwardRef(({className:s,...t},a)=>e.jsx(Vs,{ref:a,className:U("text-sm opacity-90",s),...t}));Js.displayName=Vs.displayName;function Va(){const{toasts:s}=Z();return e.jsxs(Ua,{children:[s.map(function({id:t,title:a,description:r,action:o,...x}){return e.jsxs(qs,{...x,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(Ys,{children:a}),r&&e.jsx(Js,{children:r})]}),o,e.jsx(Gs,{})]},t)}),e.jsx(Hs,{})]})}function Ka({open:s,onOpenChange:t}){const[a,r]=n.useState("loading"),[o,x]=n.useState([]),[i,u]=n.useState([]),[d,h]=n.useState(null),[j,v]=n.useState(""),[k,_]=n.useState(0),[w,g]=n.useState([]),[l,y]=n.useState(null),[m,P]=n.useState(""),[p,f]=n.useState(""),[b,M]=n.useState(!1);n.useEffect(()=>{s?A():(r("loading"),u([]),h(null),y(null),f(""),M(!1),P(""),_(0),g([]))},[s]),n.useEffect(()=>{let c=null;return a==="running"&&d&&(c=setInterval(async()=>{try{const C=await ca(d);if(C.progress){const B=C.progress.message;v(B),_(C.progress.percent||0),g(T=>T.length===0||T[T.length-1]!==B?[...T,B]:T)}C.status==="completed"?(y(C.result),r("complete")):C.status==="failed"&&(P(C.error_message||"Unknown error"),r("failed"))}catch(C){console.error("Polling error:",C)}},1500)),()=>{c&&clearInterval(c)}},[a,d]);const A=async()=>{r("loading");try{const c=await ia();x(c.plugins),u(c.plugins.map(C=>C.file||C.slug||"").filter(Boolean)),r("select")}catch{P("Failed to load available updates"),r("error")}},$=c=>{u(C=>C.includes(c)?C.filter(B=>B!==c):[...C,c])},z=()=>{u(o.map(c=>c.file||c.slug||"").filter(Boolean))},E=()=>{u([])},I=async()=>{if(i.length!==0){r("running"),v("Creating test environment...");try{const c=await la(i);h(c.session_id),v("Test session created, waiting for results...")}catch{P("Failed to start safe update test"),r("error")}}},F=c=>{switch(c){case"safe":return e.jsx(ue,{className:"h-4 w-4 text-emerald-500"});case"risky":return e.jsx(ge,{className:"h-4 w-4 text-yellow-500"});case"unsafe":return e.jsx(me,{className:"h-4 w-4 text-red-500"});default:return e.jsx(O,{className:"h-4 w-4 animate-spin text-muted-foreground"})}},S=c=>{switch(c){case"safe":return"bg-emerald-100 text-emerald-700";case"risky":return"bg-yellow-100 text-yellow-700";case"unsafe":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return e.jsx(ae,{open:s,onOpenChange:t,children:e.jsxs(ne,{className:"sm:max-w-[550px] max-h-[85vh] overflow-y-auto",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Safe Update Tester"}),e.jsx(we,{children:"Test updates in a temporary sandbox before applying them to your live site."})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[a==="loading"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(O,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading available updates..."})]}),a==="select"&&e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"h-6 w-6 text-emerald-600"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All plugins and themes are up to date!"}),e.jsx(N,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o.length," update",o.length!==1?"s":""," available"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{variant:"ghost",size:"sm",onClick:z,children:"Select All"}),e.jsx(N,{variant:"ghost",size:"sm",onClick:E,children:"Select None"})]})]}),e.jsx("div",{className:"border rounded-lg divide-y max-h-60 overflow-y-auto",children:o.map(c=>{const C=c.file||c.slug||"",B=i.includes(C);return e.jsxs("label",{className:`flex items-center gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors ${B?"bg-blue-50/50":""}`,children:[e.jsx("input",{type:"checkbox",checked:B,onChange:()=>$(C),className:"rounded border-slate-300"}),e.jsx(ws,{className:"h-4 w-4 text-slate-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:c.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.current_version," → ",c.new_version]})]}),c.requires_php&&e.jsxs("span",{className:"text-[10px] bg-slate-100 px-1.5 py-0.5 rounded",children:["PHP ",c.requires_php,"+"]})]},C)})}),e.jsxs(N,{className:"w-full",disabled:i.length===0,onClick:I,children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Test ",i.length," Update",i.length!==1?"s":""]})]})}),a==="running"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(_e,{className:"h-8 w-8 text-blue-600 animate-spin"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold",children:"Running Safe Update Test"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:j||"Starting..."})]})]}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out",style:{width:`${k}%`}})}),e.jsxs("div",{className:"bg-slate-950 text-slate-50 p-3 rounded-md font-mono text-xs h-32 overflow-y-auto border border-slate-800",children:[w.map((c,C)=>{const B=C===w.length-1;return e.jsxs("div",{className:`flex items-start gap-1 ${B?"text-emerald-400":"text-slate-500"}`,children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:B?"animate-pulse":"",children:c}),B&&e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]},C)}),w.length===0&&e.jsxs("div",{className:"flex items-center gap-1 text-emerald-400",children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:"animate-pulse",children:"Initializing..."}),e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]})]}),e.jsxs("p",{className:"text-xs text-center text-muted-foreground",children:[k<50?"Downloading updates...":"Testing updates..."," Please don't close this window."]})]}),a==="complete"&&l&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${S(l.summary.overall_status)}`,children:[l.summary.overall_status==="safe"&&"✓ Safe to Update",l.summary.overall_status==="risky"&&"⚠ Proceed with Caution",l.summary.overall_status==="unsafe"&&"✗ Issues Detected"]})}),e.jsx("div",{className:"border rounded-lg divide-y",children:l.items.plugins.map(c=>e.jsxs("div",{className:"p-3 flex items-start gap-3",children:[F(c.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:c.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.from_version," → ",c.to_version]}),c.issues.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:c.issues.map((C,B)=>e.jsx("div",{className:"text-xs bg-red-50 text-red-700 p-2 rounded",children:C.message},B))})]})]},c.slug))}),l.health_checks.length>0&&e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Health Checks"}),e.jsx("div",{className:"space-y-1",children:l.health_checks.map((c,C)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[c.status_code===200&&!c.wsod_detected?e.jsx(ue,{className:"h-3 w-3 text-emerald-500"}):e.jsx(me,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{children:c.label}),e.jsxs("span",{className:"text-muted-foreground",children:["(",c.status_code,")"]})]},C))})]}),window.sbwpData.isPro&&d&&e.jsxs("div",{className:"border border-violet-200 rounded-lg p-3 bg-violet-50/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(is,{className:"h-4 w-4 text-violet-500"}),e.jsx("span",{className:"text-sm font-medium",children:"AI Explanation"})]}),p?e.jsx("p",{className:"text-sm text-slate-700",children:p}):e.jsx(N,{size:"sm",variant:"outline",className:"text-violet-600 border-violet-200 hover:bg-violet-100",onClick:async()=>{M(!0);try{const c=await ua(d);f(c.summary)}catch{f("Could not generate AI summary. Please check your API key in Settings.")}finally{M(!1)}},disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 animate-spin mr-2"})," Generating..."]}):e.jsx(e.Fragment,{children:"Explain in Plain English"})})]}),e.jsxs("div",{className:"flex gap-2",children:[l.summary.overall_status==="safe"&&e.jsx(N,{className:"flex-1 bg-emerald-600 hover:bg-emerald-700",onClick:()=>window.location.href="/wp-admin/update-core.php",children:"Apply Updates"}),e.jsx(N,{variant:"outline",className:l.summary.overall_status==="safe"?"":"flex-1",onClick:()=>t(!1),children:"Close"})]})]}),(a==="failed"||a==="error")&&e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(me,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Test Failed"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m})]}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(N,{variant:"outline",onClick:A,children:"Try Again"}),e.jsx(N,{variant:"ghost",onClick:()=>t(!1),children:"Close"})]})]})]})]})})}const Zs=n.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:U("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...t}));Zs.displayName="Textarea";function Xa({open:s,onOpenChange:t}){var z;const[a,r]=n.useState("idle"),[o,x]=n.useState(""),[i,u]=n.useState({message:"",percent:0}),[d,h]=n.useState(null),[j,v]=n.useState(null),[k,_]=n.useState([]),[w,g]=n.useState(!1),[l,y]=n.useState(!1),m=n.useRef(null);n.useEffect(()=>(s&&window.sbwpData.isPro&&P(),()=>{m.current&&clearInterval(m.current)}),[s]);const P=async()=>{try{const I=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/check-outdated`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();_(I.plugins||[]),I.count>0&&g(!0)}catch(E){console.error("Failed to check outdated plugins:",E)}},p=async()=>{r("scanning"),u({message:"Starting conflict scan...",percent:5}),h(null),v(null),g(!1);try{const I=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/start`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({user_context:o})})).json();if(!I.session_id)throw new Error("Failed to start scan");f(I.session_id)}catch(E){console.error("Scan start error:",E),r("idle")}},f=E=>{m.current=setInterval(async()=>{try{const F=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/session/${E}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();F.progress&&u({message:F.progress.message||"Scanning...",percent:F.progress.percent||0}),F.status==="completed"?(clearInterval(m.current),b(F.result)):F.status==="failed"&&(clearInterval(m.current),r("idle"),console.error("Scan failed:",F.error_message))}catch(I){console.error("Poll error:",I)}},1500)},b=E=>{h(E),E.culprit?E.culprit.type==="core_or_server"?r("core_issue"):r("found"):E.multi_plugin_conflict?r("found"):r("clean")},M=async()=>{if(d)try{const F=(await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/sessions`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json())[0];if(!F)return;const c=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/generate-email/${F.id}`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();c.subject&&c.body&&(v(c),r("email_ready"))}catch(E){console.error("Email generation error:",E)}},A=()=>{if(!j)return;const E=`Subject: ${j.subject}

${j.body}`;navigator.clipboard.writeText(E),y(!0),setTimeout(()=>y(!1),2e3)},$=()=>{r("idle"),x(""),u({message:"",percent:0}),h(null),v(null),g(!1)};return e.jsx(ae,{open:s,onOpenChange:E=>{E||$(),t(E)},children:e.jsxs(ne,{className:"sm:max-w-[550px]",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"AI Conflict Scanner"}),e.jsx(we,{children:"Automatically identify which plugin is causing issues on your site."})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[a==="idle"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(kt,{className:"h-8 w-8 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Describe the issue you're experiencing (optional):"}),e.jsx(Zs,{placeholder:"e.g., When I try to edit block settings, the page crashes with a white screen...",value:o,onChange:E=>x(E.target.value),rows:3})]}),w&&k.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:[k.length," plugin",k.length>1?"s have":" has"," updates available"]}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Consider updating before scanning. Outdated plugins often cause conflicts."})]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"This runs in a sandbox—your live site won't be affected."}),e.jsx(N,{size:"lg",onClick:p,className:"w-full bg-orange-600 hover:bg-orange-700",children:"Start Conflict Scan"})]}),a==="scanning"&&e.jsxs("div",{className:"space-y-4 text-center py-4",children:[e.jsx(O,{className:"h-12 w-12 animate-spin text-orange-500 mx-auto"}),e.jsx("h3",{className:"font-semibold text-lg",children:"Scanning..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.message}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden w-full",children:e.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300",style:{width:`${i.percent}%`}})})]}),a==="found"&&d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-800 mb-3",children:[e.jsx(ge,{className:"h-6 w-6"}),e.jsx("h3",{className:"font-bold text-lg",children:"Conflict Detected"})]}),d.culprit&&e.jsxs("div",{className:"bg-white p-3 rounded border border-red-100 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-semibold",children:d.culprit.name}),d.culprit.is_outdated&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full",children:"Outdated"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Version ",d.culprit.version,d.culprit.is_outdated&&` → ${d.culprit.latest_version} available`]})]}),d.theme_conflict&&e.jsx("p",{className:"text-sm text-red-700 mb-2",children:"⚠️ This conflict only occurs with your current theme."}),d.ai_analysis&&e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Diagnosis:"})," ",d.ai_analysis.diagnosis]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Recommendation:"})," ",d.ai_analysis.recommendation]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{variant:"outline",className:"flex-1",onClick:M,children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Generate Developer Email"]}),e.jsx(N,{variant:"outline",onClick:()=>t(!1),children:"Close"})]})]}),a==="core_issue"&&d&&e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ve,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Not a Plugin Conflict"}),e.jsx("p",{className:"text-muted-foreground",children:"The issue persists even with all plugins disabled. This suggests a server configuration, WordPress core, or theme issue."}),d.ai_analysis&&e.jsx("p",{className:"text-sm",children:d.ai_analysis.recommendation}),e.jsx(N,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}),a==="clean"&&e.jsxs("div",{className:"text-center space-y-4 py-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"h-8 w-8 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-lg",children:"No Conflicts Found"}),e.jsxs("p",{className:"text-muted-foreground",children:["All ",((z=d==null?void 0:d.environment)==null?void 0:z.active_plugins_count)||0," plugins tested successfully."]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"If you're still experiencing issues, they may be caused by your theme, server configuration, or browser."}),e.jsx(N,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}),a==="email_ready"&&j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-700",children:[e.jsx(qe,{className:"h-5 w-5"}),e.jsx("h3",{className:"font-semibold",children:"Developer Email Ready"})]}),e.jsxs("div",{className:"bg-slate-50 border rounded-lg p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Subject:"}),e.jsx("p",{className:"text-sm font-medium",children:j.subject})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Body:"}),e.jsx("pre",{className:"text-sm whitespace-pre-wrap max-h-48 overflow-y-auto",children:j.body})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{onClick:A,className:"flex-1",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),l?"Copied!":"Copy to Clipboard"]}),e.jsx(N,{variant:"outline",onClick:()=>r("found"),children:"Back"})]})]})]})]})})}const Qs=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"w-full overflow-auto",children:e.jsx("table",{ref:a,className:U("w-full caption-bottom text-sm",s),...t})}));Qs.displayName="Table";const et=n.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:U("[&_tr]:border-b",s),...t}));et.displayName="TableHeader";const st=n.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:U("[&_tr:last-child]:border-0",s),...t}));st.displayName="TableBody";const Ha=n.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:U("bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Ha.displayName="TableFooter";const De=n.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:U("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));De.displayName="TableRow";const ee=n.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:U("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));ee.displayName="TableHead";const se=n.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:U("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));se.displayName="TableCell";const qa=n.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:U("mt-4 text-sm text-muted-foreground",s),...t}));qa.displayName="TableCaption";function Ga(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+r[o]}function Ya({backup:s,open:t,onOpenChange:a,onComplete:r}){const[o,x]=n.useState("initial"),[i,u]=n.useState("full"),[d,h]=n.useState(!1),[j,v]=n.useState(null),[k,_]=n.useState([]),[w,g]=n.useState([]),{toast:l}=Z();n.useEffect(()=>{t&&(x("initial"),u("full"),h(!1),v(null),_([]),g([]))},[t]);const y=async()=>{if(s){h(!0);try{const f=await ea(s.id);v(f),x("select")}catch{l({title:"Error",description:"Failed to load backup contents.",variant:"destructive"})}finally{h(!1)}}},m=async()=>{if(s){x("restoring");try{i==="full"?await Ze(s.id):await Ze(s.id,{plugins:k,themes:w}),l({title:"Restore Complete",description:"The backup has been restored successfully."}),r(),a(!1),setTimeout(()=>window.location.reload(),1500)}catch(f){x("initial"),l({title:"Restore Failed",description:f.message||"An error occurred during restore.",variant:"destructive"})}}},P=f=>{_(b=>b.includes(f)?b.filter(M=>M!==f):[...b,f])},p=f=>{g(b=>b.includes(f)?b.filter(M=>M!==f):[...b,f])};return s?e.jsx(ae,{open:t,onOpenChange:f=>!d&&a(f),children:e.jsxs(ne,{className:"sm:max-w-2xl",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Restore Backup"}),e.jsxs(we,{children:["Created on ",s.created_at," • ",Ga(s.size_bytes)]})]}),o==="initial"&&e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-4 text-red-900 dark:text-red-100 flex gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-1",children:"Warning"}),e.jsx("div",{className:"text-sm opacity-90",children:"Restoring will overwrite existing files and database. This action cannot be undone."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="full"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>u("full"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-emerald-500"}),e.jsx("h3",{className:"font-semibold",children:"Full Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restore everything: Files, Database, Plugins, and Themes."})]}),e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="partial"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>u("partial"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ws,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-semibold",children:"Partial Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select specific Plugins or Themes to restore. Database is NOT restored."})]})]})]}),o==="select"&&j&&e.jsxs("div",{className:"py-4",children:[e.jsxs(xt,{defaultValue:"plugins",children:[e.jsxs(ht,{children:[e.jsxs(Le,{value:"plugins",children:["Plugins (",j.plugins.length,")"]}),e.jsxs(Le,{value:"themes",children:["Themes (",j.themes.length,")"]})]}),e.jsx(Ue,{value:"plugins",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:j.plugins.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No plugins found in backup."}):e.jsx("div",{className:"space-y-2",children:j.plugins.map(f=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`plugin-${f}`,checked:k.includes(f),onChange:()=>P(f),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(W,{htmlFor:`plugin-${f}`,className:"flex-1 cursor-pointer font-medium",children:f})]},f))})}),e.jsx(Ue,{value:"themes",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:j.themes.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No themes found in backup."}):e.jsx("div",{className:"space-y-2",children:j.themes.map(f=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`theme-${f}`,checked:w.includes(f),onChange:()=>p(f),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(W,{htmlFor:`theme-${f}`,className:"flex-1 cursor-pointer font-medium",children:f})]},f))})})]}),e.jsx("div",{className:"flex justify-between items-center mt-4 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Selected: ",k.length," plugins, ",w.length," themes"]})})]}),o==="restoring"&&e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(O,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Restoring Backup..."}),e.jsxs("p",{className:"text-muted-foreground max-w-sm mx-auto",children:["Please wait while we restore your ",i==="full"?"site":"items",". Do not close this window."]})]}),e.jsxs(pt,{children:[o==="initial"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(N,{onClick:()=>i==="full"?m():y(),disabled:d,children:[d&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),i==="full"?"Start Restore":"Next Step"]})]}),o==="select"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{variant:"outline",onClick:()=>x("initial"),children:"Back"}),e.jsxs(N,{onClick:m,disabled:k.length===0&&w.length===0,children:["Start Restore (",k.length+w.length," items)"]})]})]})]})}):null}function Ja(s){if(s===0)return"0 B";const t=1024,a=["B","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,r)).toFixed(1))+" "+a[r]}function Za(s){return s.type==="folder"?e.jsx(Dt,{className:"h-4 w-4 text-yellow-500"}):s.category==="database"||s.name.endsWith(".sql")?e.jsx(xs,{className:"h-4 w-4 text-blue-500"}):s.name.endsWith(".php")?e.jsx(ve,{className:"h-4 w-4 text-purple-500"}):s.name.endsWith(".js")||s.name.endsWith(".ts")?e.jsx(ve,{className:"h-4 w-4 text-yellow-600"}):s.name.endsWith(".css")?e.jsx(ve,{className:"h-4 w-4 text-blue-400"}):s.name.endsWith(".json")||s.name.endsWith(".txt")||s.name.endsWith(".md")?e.jsx(Pt,{className:"h-4 w-4 text-gray-500"}):e.jsx(ps,{className:"h-4 w-4 text-gray-400"})}function Qa({backup:s,open:t,onOpenChange:a}){const[r,o]=n.useState([]),[x,i]=n.useState(!1),[u,d]=n.useState(null),[h,j]=n.useState(new Set),{toast:v}=Z();n.useEffect(()=>{t&&s&&k()},[t,s]);const k=async()=>{if(s){i(!0);try{const l=await Zt(s.id);o(l.files);const y=new Set;l.files.forEach(m=>{m.depth===0&&m.type==="folder"&&y.add(m.path)}),j(y)}catch(l){console.error(l),v({title:"Error",description:"Failed to load backup files",variant:"destructive"})}finally{i(!1)}}},_=async l=>{if(s){d(l);try{const y=await Qt(s.id,l),m=document.createElement("a");m.href=y.download_url,m.download=y.filename,document.body.appendChild(m),m.click(),document.body.removeChild(m),v({title:"Download Started",description:y.filename})}catch(y){console.error(y),v({title:"Error",description:"Failed to download file",variant:"destructive"})}finally{d(null)}}},w=l=>{const y=new Set(h);y.has(l)?y.delete(l):y.add(l),j(y)},g=l=>{if(l.depth===0)return!0;const y=l.path.split("/").filter(Boolean);for(let m=0;m<y.length-1;m++){const P="/"+y.slice(0,m+1).join("/");if(!h.has(P))return!1}return!0};return e.jsx(ae,{open:t,onOpenChange:a,children:e.jsxs(ne,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsx(re,{children:e.jsx(oe,{children:"Browse Backup"})}),e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(N,{size:"sm",onClick:()=>_("/"),disabled:u==="/",children:[u==="/"?e.jsx(O,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(He,{className:"h-4 w-4 mr-2"}),"Download All"]})}),x?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsx(ft,{className:"h-[400px] border rounded-lg",children:e.jsxs("div",{className:"p-2",children:[r.filter(g).map(l=>e.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-muted/50 rounded group",style:{paddingLeft:`${l.depth*20+8}px`},children:[l.type==="folder"&&l.hasChildren?e.jsx("button",{onClick:()=>w(l.path),className:"p-0.5 hover:bg-muted rounded",children:h.has(l.path)?e.jsx(Re,{className:"h-3 w-3 text-muted-foreground"}):e.jsx(us,{className:"h-3 w-3 text-muted-foreground"})}):e.jsx("div",{className:"w-4"}),Za(l),e.jsx("span",{className:"flex-1 text-sm truncate",children:l.name}),l.type==="file"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:Ja(l.size)}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>_(l.path),disabled:u===l.path,children:u===l.path?e.jsx(O,{className:"h-3 w-3 animate-spin"}):e.jsx(He,{className:"h-3 w-3"})})]},l.path)),r.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ps,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{children:"No files found in this backup"})]})]})})]})})}function en(s){return s?new Date(s).toLocaleString():"Unknown"}function sn(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+r[o]}function tn({refreshTrigger:s}){const[t,a]=n.useState([]),[r,o]=n.useState(!0),[x,i]=n.useState(null),[u,d]=n.useState(null),[h,j]=n.useState(!1),[v,k]=n.useState(!1),{toast:_}=Z(),w=async()=>{o(!0);try{const m=await Yt();console.log("SBWP: Backups loaded:",m),a(m)}catch(m){console.error(m)}finally{o(!1)}};n.useEffect(()=>{w()},[s]);const g=async m=>{if(confirm("Permanently delete this backup?")){i(m);try{await Jt(m.toString()),_({title:"Backup Deleted",description:"The backup has been removed."}),w()}catch{_({title:"Error",description:"Failed to delete backup.",variant:"destructive"})}finally{i(null)}}},l=m=>{d(m),j(!0)},y=m=>{d(m),k(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{backup:u,open:h,onOpenChange:j,onComplete:w}),e.jsx(Qa,{backup:u,open:v,onOpenChange:k}),e.jsxs(K,{className:"col-span-3",children:[e.jsxs(H,{children:[e.jsx(q,{children:"Existing Backups"}),e.jsx(Y,{children:"Manage your local backup points."})]}),e.jsx(X,{children:r?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(O,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-muted/20 rounded-lg",children:[e.jsx(fs,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No backups found."})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(Qs,{children:[e.jsx(et,{children:e.jsxs(De,{children:[e.jsx(ee,{children:"Date"}),e.jsx(ee,{children:"Type"}),e.jsx(ee,{children:"Size"}),e.jsx(ee,{className:"text-right",children:"Actions"})]})}),e.jsx(st,{children:t.map(m=>e.jsxs(De,{children:[e.jsx(se,{className:"font-medium",children:en(m.created_at)}),e.jsx(se,{className:"capitalize",children:e.jsxs("span",{className:"flex items-center gap-1",children:[m.type,Number(m.is_locked)===1?e.jsx("span",{title:"Locked - required for incremental restores",children:e.jsx(Rt,{className:"h-3 w-3 text-orange-500"})}):null]})}),e.jsx(se,{children:sn(m.size_bytes)}),e.jsxs(se,{className:"text-right",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>y(m),title:"Browse Files",children:e.jsx(Et,{className:"h-4 w-4 text-yellow-600 hover:text-yellow-700"})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>l(m),title:"Restore",children:e.jsx(At,{className:"h-4 w-4 text-blue-500 hover:text-blue-700"})}),e.jsx(N,{variant:"ghost",size:"icon",disabled:x===m.id||Number(m.is_locked)===1,onClick:()=>g(m.id),title:Number(m.is_locked)===1?"Locked - required for incremental restores":"Delete",children:x===m.id?e.jsx(O,{className:"h-4 w-4 animate-spin"}):e.jsx(gs,{className:`h-4 w-4 ${Number(m.is_locked)===1?"text-gray-300":"text-red-500 hover:text-red-700"}`})})]})]},m.id))})]})})})]})]})}function an({onNavigate:s}){const[t,a]=n.useState(null),[r,o]=n.useState(!0),[x,i]=n.useState(!1),[u,d]=n.useState(!1),[h,j]=n.useState(!1),[v,k]=n.useState(0),[_,w]=n.useState(0),[g,l]=n.useState(""),[y,m]=n.useState(null),[P,p]=n.useState(!0),[f,b]=n.useState(!1),[M,A]=n.useState(!1),[$,z]=n.useState(!1),[E,I]=n.useState(null),{toast:F}=Z(),S=async()=>{try{const T=await Gt();a(T)}catch(T){console.error("Failed to load stats",T)}finally{o(!1)}};n.useEffect(()=>{S(),pa().then(m).catch(console.error),Cs().then(T=>p(T.incremental_enabled??!0)).catch(console.error)},[]);const c=async()=>{let T="full";$?T="db_only":P&&!M&&(T="incremental");const L=Date.now().toString();I(L),i(!0),w(1),l("Initializing backup process...");try{const R=await oa(T,!1,L);if(R.code)throw new Error(R.message);F({title:"Backup Started",description:"Your backup is running in the background. You can leave this page."})}catch(R){console.error(R),i(!1),I(null),F({title:"Backup Failed to Start",description:R.message||"Could not initiate backup.",variant:"destructive"})}finally{A(!1),z(!1)}};n.useEffect(()=>{let T;const L=async()=>{try{const R=await sa();if(E){if(R.session_id&&R.session_id!==E)return}else if(R.active&&R.percent>0&&R.percent<100){I(R.session_id||"legacy"),i(!0),w(R.percent),R.message&&l(R.message);return}else return;if(!R.active&&R.percent>=100){i(!1),I(null),w(100),l("Backup Complete"),await S(),k(Q=>Q+1),T&&clearInterval(T),F({title:"Backup Complete",description:"Background backup finished successfully."});return}R.active&&(R.percent>_&&w(R.percent),R.message&&l(R.message),(R.percent>=100||R.message&&R.message.includes("Complete"))&&(i(!1),I(null),w(100),l("Backup Complete"),await S(),k(Q=>Q+1),T&&clearInterval(T),F({title:"Backup Complete",description:"Background backup finished successfully."})))}catch(R){console.error("Backup progress poll error",R)}};return L(),T=setInterval(L,2e3),()=>{T&&clearInterval(T)}},[x,E,_]);const C=async T=>{console.log("SBWP: Toggling incremental to:",T),p(T);try{const L=await Ts({retention_limit:5,incremental_enabled:T});console.log("SBWP: Settings saved, result:",L),k(R=>R+1)}catch(L){console.error("SBWP: Failed to save incremental setting:",(L==null?void 0:L.message)||L),F({title:"Error",description:(L==null?void 0:L.message)||"Failed to save setting",variant:"destructive"}),p(!T)}},B=async()=>{try{await ta(),i(!1),w(0),l("IDLE"),k(T=>T+1),F({title:"Backup Cancelled",description:"The backup process was stopped."})}catch(T){console.error("Cancel failed",T),F({title:"Error",description:"Failed to stop backup",variant:"destructive"})}};return r?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Va,{}),e.jsx(Ka,{open:u,onOpenChange:d}),e.jsx(Xa,{open:h,onOpenChange:j}),(y==null?void 0:y.has_crash)&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-500/20 p-2 rounded-full",children:e.jsx(ge,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-800 dark:text-red-200",children:"Site Issues Detected"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 truncate max-w-lg",children:"Recent errors found in debug.log"})]})]}),e.jsxs(N,{variant:"destructive",size:"sm",onClick:()=>window.open(y.recovery_url,"_blank"),children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Open Recovery Portal"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(K,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Last Backup"}),e.jsx(Ce,{className:"h-4 w-4 text-emerald-500"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.last_backup)||"Never"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t==null?void 0:t.count)||0," total backups"]})]})]}),e.jsxs(K,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Storage Usage"}),e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total_size)||"0 B"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Local storage used"})]})]}),e.jsxs(K,{className:"lg:col-span-2",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:x?"Backing up...":"Backup"}),e.jsx(_e,{className:`h-4 w-4 text-muted-foreground ${x?"animate-spin":""}`})]}),e.jsx(X,{className:"space-y-3",children:x?e.jsxs("div",{className:"relative overflow-hidden rounded-md bg-zinc-950 p-4 border border-zinc-800 shadow-inner",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-zinc-500 to-transparent opacity-50"}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("span",{className:"text-xs font-mono text-zinc-300 uppercase tracking-wider",children:"Processing Backup"}),e.jsx("button",{onClick:B,className:"ml-2 text-zinc-600 hover:text-red-400 transition-colors",title:"Stop Backup",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"text-xs font-mono text-emerald-500 font-bold",children:[_,"%"]})]}),e.jsxs("div",{className:"space-y-1 py-1",children:[e.jsxs("div",{className:"font-mono text-[10px] text-zinc-400 flex gap-2",children:[e.jsx("span",{className:"text-emerald-500",children:"➜"}),e.jsxs("span",{children:["Task: ",g.split("(")[0]]})]}),e.jsxs("div",{className:"font-mono text-[10px] text-zinc-300 flex gap-2 truncate",children:[e.jsx("span",{className:"text-blue-400",children:"ℹ"}),e.jsx("span",{className:"opacity-90 break-all",children:g})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ss,{value:_,className:"h-1 bg-zinc-800",indicatorClassName:"bg-gradient-to-r from-emerald-600 to-emerald-400"}),e.jsxs("div",{className:"flex justify-between text-[9px] text-zinc-600 uppercase font-mono",children:[e.jsx("span",{children:"Start"}),e.jsx("span",{children:"End"})]})]}),e.jsxs("div",{className:"text-[10px] text-zinc-700 font-mono mt-2 bg-zinc-900/50 p-1 rounded border border-zinc-800 break-all",children:["RAW: ",JSON.stringify({p:_,m:g})]})]}),e.jsx("div",{className:"absolute -bottom-4 -right-4 text-zinc-800 opacity-20",children:e.jsx(Ce,{className:"w-24 h-24"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(N,{size:"lg",onClick:c,className:"w-full",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Backup Now"]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx(W,{htmlFor:"incremental",className:"text-sm font-medium cursor-pointer",children:"Smart Incremental"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Only backup changed files"})]})]}),e.jsx(de,{id:"incremental",checked:P,onCheckedChange:C})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>b(!f),className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full justify-center py-1",children:[f?e.jsx(Ct,{className:"h-3 w-3"}):e.jsx(Re,{className:"h-3 w-3"}),f?"Less options":"More options"]}),f&&e.jsxs("div",{className:"mt-2 space-y-2 p-3 border rounded-lg bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"Force full backup"})]}),e.jsx(de,{checked:M,onCheckedChange:T=>{A(T),T&&z(!1)},disabled:!P})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"Database only"})]}),e.jsx(de,{checked:$,onCheckedChange:T=>{z(T),T&&A(!1)}})]})]})]})]})})]}),e.jsx(K,{className:"lg:col-span-4 md:col-span-2",children:e.jsx(X,{className:"p-0",children:e.jsxs("div",{className:"grid md:grid-cols-2 divide-y md:divide-y-0 md:divide-x",children:[e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bt,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Safe Update"})]}),window.sbwpData.isPro&&e.jsx("span",{className:"text-[10px] bg-blue-500/20 text-blue-600 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-1",children:"Test updates safely in a sandbox before applying to production."}),e.jsx(N,{size:"sm",className:"mt-3 w-full bg-blue-600 hover:bg-blue-500 text-white",onClick:()=>{window.sbwpData.isPro?d(!0):window.location.href="/wp-admin/update-core.php"},children:window.sbwpData.isPro?"Test Updates":"Go to Updates"})]}),e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Conflict Scanner"})]}),window.sbwpData.isPro&&e.jsx("span",{className:"text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-1",children:"Find buggy plugins auto-magically."}),e.jsx(N,{size:"sm",variant:"outline",className:"mt-3 w-full",onClick:()=>window.sbwpData.isPro&&j(!0),children:window.sbwpData.isPro?"Start Scan":"Get Pro"})]})]})})})]}),e.jsx(tn,{refreshTrigger:v})]})}const V=n.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:U("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...a}));V.displayName="Input";function nn({open:s,onOpenChange:t}){const[a,r]=n.useState([]),[o,x]=n.useState(!1),[i,u]=n.useState(null),[d,h]=n.useState(null),[j,v]=n.useState(""),[k,_]=n.useState(""),[w,g]=n.useState({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""}),[l,y]=n.useState(5),m=()=>{x(!0),Promise.all([aa(),na()]).then(([p,f])=>{r(p),f.retention_count&&y(f.retention_count)}).catch(console.error).finally(()=>x(!1))};n.useEffect(()=>{s&&m()},[s]);const P=async p=>{u(p);try{await be(p,"disconnect"),m()}catch(f){console.error(f)}finally{u(null)}};return e.jsx(ae,{open:s,onOpenChange:t,children:e.jsxs(ne,{className:"sm:max-w-[500px]",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Cloud Storage Settings"}),e.jsx(we,{children:"Connect Google Drive to enable automatic off-site backups."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(W,{className:"text-sm font-medium",children:"Retention Limit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of backups to keep per provider."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(V,{type:"number",min:"1",max:"100",className:"w-20 text-right h-8",value:l,onChange:p=>{y(parseInt(p.target.value)||5)},onBlur:()=>ra({retention_count:l})})})]}),o&&a.length===0?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(O,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-4",children:[a.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"No providers available."}),a.map(p=>{var f;return e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800",children:e.jsx(Tt,{className:"h-5 w-5 text-slate-500"})}),e.jsxs("div",{className:"grid gap-0.5",children:[e.jsx("div",{className:"font-medium text-sm",children:p.name}),e.jsx("div",{className:"text-[10px] text-muted-foreground uppercase flex items-center gap-1",children:p.connected?e.jsxs("span",{className:"text-emerald-600 flex items-center gap-1",children:["Connected ",((f=p.user_info)==null?void 0:f.email)&&`as ${p.user_info.email}`]}):"Not Connected"})]})]}),p.connected?e.jsx(N,{size:"sm",variant:"outline",onClick:()=>P(p.id),disabled:i===p.id,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:i===p.id?e.jsx(O,{className:"h-4 w-4 animate-spin"}):"Disconnect"}):e.jsxs(N,{size:"sm",variant:"ghost",onClick:()=>h(d===p.id?null:p.id),children:[d===p.id?"Cancel":"Setup",d===p.id?e.jsx(Re,{className:"ml-2 h-4 w-4"}):e.jsx(us,{className:"ml-2 h-4 w-4"})]})]}),d===p.id&&p.id==="gdrive"&&!p.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[p.global_creds?e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"rounded-md bg-emerald-50 dark:bg-emerald-900/20 p-3 text-xs text-emerald-800 dark:text-emerald-200 flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"✓ Ready to Connect"}),e.jsx("span",{children:"(Secure configuration active)"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Click below to authorize this site to save backups to ",e.jsx("strong",{children:"YOUR"})," Google Drive account."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-900/20 p-3 text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Setup Instructions:"}),e.jsxs("ol",{className:"list-decimal pl-4 space-y-1",children:[e.jsxs("li",{children:["Create a project in ",e.jsx("a",{href:"https://console.cloud.google.com/projectcreate",target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-600 dark:text-blue-400",children:"Google Cloud Console"}),"."]}),e.jsxs("li",{children:["Add this ",e.jsx("strong",{children:"Authorized Redirect URI"}),":"]})]}),e.jsx("div",{className:"mt-2 flex gap-2",children:e.jsxs("code",{className:"flex-1 bg-white dark:bg-black/20 p-1.5 rounded border font-mono text-[10px] break-all",children:[window.sbwpData.root,"wp-admin/admin-ajax.php?action=sbwp_oauth_callback"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"client_id",children:"Client ID"}),e.jsx(V,{id:"client_id",placeholder:"xxxx.apps.googleusercontent.com",value:j,onChange:b=>v(b.target.value),className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"client_secret",children:"Client Secret"}),e.jsx(V,{id:"client_secret",type:"password",placeholder:"Client Secret",value:k,onChange:b=>_(b.target.value),className:"font-mono text-xs"})]})]}),e.jsxs(N,{className:"w-full",onClick:async()=>{u("gdrive");try{await be("gdrive","prepare",{client_id:j,client_secret:k});const b=encodeURIComponent(`${window.sbwpData.root}wp-admin/admin-ajax.php?action=sbwp_oauth_callback`),M=encodeURIComponent("https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email"),A=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${j}&redirect_uri=${b}&response_type=code&scope=${M}&access_type=offline&prompt=consent`,$=window.open(A,"sbwp_auth","width=600,height=700"),z=setInterval(()=>{$!=null&&$.closed&&(clearInterval(z),m(),u(null))},1e3);window.addEventListener("message",E=>{var I;((I=E.data)==null?void 0:I.type)==="sbwp_auth_success"&&(clearInterval(z),$==null||$.close(),m(),u(null),h(null))},{once:!0})}catch(b){console.error(b),u(null),alert("Failed to initialize authentication.")}},disabled:i===p.id||!p.global_creds&&(!j||!k),children:[i===p.id?e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(hs,{className:"mr-2 h-4 w-4"}),p.global_creds?"Connect YOUR Google Drive":"Connect Google Drive"]})]}),d===p.id&&["aws","do_spaces","wasabi"].includes(p.id)&&!p.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Access Key"}),e.jsx(V,{value:w.accessKey,onChange:b=>g({...w,accessKey:b.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Secret Key"}),e.jsx(V,{value:w.secretKey,onChange:b=>g({...w,secretKey:b.target.value}),type:"password",className:"font-mono text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Bucket Name"}),e.jsx(V,{value:w.bucket,onChange:b=>g({...w,bucket:b.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Region"}),e.jsx(V,{value:w.region,onChange:b=>g({...w,region:b.target.value}),placeholder:p.id==="do_spaces"?"nyc3":"us-east-1",type:"text",className:"font-mono text-xs"})]})]}),e.jsx(N,{className:"w-full",disabled:i===p.id||!w.accessKey||!w.secretKey||!w.bucket,onClick:async()=>{u(p.id);try{await be(p.id,"connect",{access_key:w.accessKey,secret_key:w.secretKey,bucket:w.bucket,region:w.region||"us-east-1",endpoint:w.endpoint}),m(),h(null),g({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""})}catch(b){console.error(b),alert(b.message||"Connection failed")}finally{u(null)}},children:i===p.id?e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}):"Connect Storage"})]})]},p.id)})]})]})]})})}function rn({onBack:s,onNavigate:t}){const[a,r]=n.useState({retention_limit:5}),[o,x]=n.useState(null),[i,u]=n.useState(null),[d,h]=n.useState(""),[j,v]=n.useState(""),[k,_]=n.useState(!0),[w,g]=n.useState(!1),[l,y]=n.useState(!1),[m,P]=n.useState(!1),[p,f]=n.useState(!1),[b,M]=n.useState(!1),{toast:A}=Z();n.useEffect(()=>{Promise.all([Cs().then(r),window.sbwpData.isPro?da().then(x):Promise.resolve(),ma().then(u)]).catch(console.error).finally(()=>_(!1))},[]);const $=async()=>{i!=null&&i.url&&(await wt(i.url)?(M(!0),setTimeout(()=>M(!1),2e3),A({title:"Copied!",description:"Recovery URL copied to clipboard."})):A({title:"Copy Failed",description:"Please copy the URL manually.",variant:"destructive"}))},z=async()=>{P(!0);try{const c=await xa(j);u(c),v(""),A({title:j?"PIN Set":"PIN Removed",description:j?"Your recovery PIN has been saved.":"Your recovery PIN has been removed."})}catch{A({title:"Error",description:"Failed to save PIN.",variant:"destructive"})}finally{P(!1)}},E=async()=>{if(confirm("Are you sure? This will invalidate your old recovery URL.")){P(!0);try{const c=await ha();u(c),A({title:"Key Regenerated",description:"Your recovery URL has been updated."})}catch{A({title:"Error",description:"Failed to regenerate key.",variant:"destructive"})}finally{P(!1)}}},I=async()=>{y(!0);try{const c=await Qe(d);x(c),h(""),A({title:"API Key Saved",description:"Your OpenAI API key has been saved."})}catch{A({title:"Error",description:"Failed to save API key.",variant:"destructive"})}finally{y(!1)}},F=async()=>{y(!0);try{const c=await Qe("");x(c),A({title:"API Key Removed",description:"Your OpenAI API key has been removed."})}catch{A({title:"Error",description:"Failed to remove API key.",variant:"destructive"})}finally{y(!1)}},S=async()=>{g(!0);try{await Ts(a),A({title:"Settings Saved",description:"Your settings have been updated."})}catch{A({title:"Error",description:"Failed to save settings.",variant:"destructive"})}finally{g(!1)}};return k?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(nn,{open:p,onOpenChange:f}),e.jsxs(N,{variant:"ghost",className:"pl-0 gap-2",onClick:s,children:[e.jsx(ds,{className:"h-4 w-4"}),"Back to Dashboard"]}),e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Configuration"}),e.jsxs(K,{children:[e.jsxs(H,{children:[e.jsx(q,{children:"General Settings"}),e.jsx(Y,{children:"Configure how SafeBackup handles your data."})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(W,{htmlFor:"retention",children:"Local Backup Retention"}),e.jsx(V,{id:"retention",type:"number",min:1,max:50,value:a.retention_limit,onChange:c=>r(C=>({...C,retention_limit:parseInt(c.target.value)||1}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of local backups to keep. Oldest backups will be deleted automatically when this limit is reached."})]}),e.jsxs(N,{onClick:S,disabled:w,children:[w&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]}),e.jsxs(K,{className:a.alerts_enabled?"border-red-500/50 bg-red-500/5":"",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nt,{className:"h-5 w-5 text-red-500"}),e.jsx(q,{children:"Crash Alerts"})]}),a.alerts_enabled&&e.jsx("span",{className:"text-[10px] bg-red-500/20 text-red-600 px-2 py-0.5 rounded-full font-bold",children:"ACTIVE"})]}),e.jsx(Y,{children:"Get notified immediately if your site crashes."})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsxs(W,{htmlFor:"alerts-enabled",className:"flex flex-col space-y-1",children:[e.jsx("span",{children:"Enable Email Alerts"}),e.jsx("span",{className:"font-normal text-xs text-muted-foreground",children:"We'll send you a link to the Recovery Portal if a fatal error is detected."})]}),e.jsx(de,{id:"alerts-enabled",checked:a.alerts_enabled||!1,onCheckedChange:c=>r(C=>({...C,alerts_enabled:c}))})]}),a.alerts_enabled&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsx(W,{htmlFor:"alert-email",children:"Notification Email"}),e.jsx(V,{id:"alert-email",type:"email",placeholder:"admin@example.com",value:a.alert_email||"",onChange:c=>r(C=>({...C,alert_email:c.target.value}))})]}),e.jsxs(N,{onClick:S,disabled:w,variant:a.alerts_enabled?"destructive":"default",children:[w&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Alert Settings"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(K,{className:window.sbwpData.isPro?"border-emerald-500/50 bg-emerald-500/5":"opacity-80",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Cloud Storage"}),window.sbwpData.isPro?e.jsx("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold",children:"PRO ACTIVE"}):e.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full font-bold",children:"FREE"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:window.sbwpData.isPro?"Configure":"Locked"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:window.sbwpData.isPro?"Connect to Google Drive / S3":"Upgrade to enable Cloud Backups"}),window.sbwpData.isPro?e.jsx(N,{size:"sm",variant:"outline",className:"mt-4 w-full h-8 text-xs",onClick:()=>f(!0),children:"Configure Cloud"}):e.jsx(N,{size:"sm",variant:"secondary",className:"mt-4 w-full h-8 text-xs",children:"Get Pro"})]})]}),window.sbwpData.isPro&&e.jsxs(K,{className:"border-emerald-500/50 bg-emerald-500/5",children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(q,{className:"text-sm font-medium",children:"Scheduled Backups"}),e.jsx("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold",children:"PRO ACTIVE"})]}),e.jsxs(X,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Manage"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Automated daily/weekly backups"}),e.jsx(N,{size:"sm",variant:"outline",className:"mt-4 w-full h-8 text-xs",onClick:()=>t("schedules"),children:"Configure Schedules"})]})]})]}),e.jsxs(K,{className:window.sbwpData.isPro?"border-violet-500/50 bg-violet-500/5":"opacity-80",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-5 w-5 text-violet-500"}),e.jsx(q,{children:"AI Assistant"})]}),window.sbwpData.isPro?o!=null&&o.is_configured?e.jsxs("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3"})," CONNECTED"]}):e.jsx("span",{className:"text-[10px] bg-amber-500/20 text-amber-600 px-2 py-0.5 rounded-full font-bold",children:"NOT CONFIGURED"}):e.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx(Y,{children:"Use AI to explain update test results in plain language."})]}),e.jsx(X,{className:"space-y-4",children:window.sbwpData.isPro?e.jsx(e.Fragment,{children:o!=null&&o.is_configured?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-md",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"OpenAI API Key"}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:o.masked_key})]}),e.jsx(N,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600 hover:bg-red-50",onClick:F,disabled:l,children:l?e.jsx(O,{className:"h-4 w-4 animate-spin"}):e.jsx(Ot,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"openai-key",children:"OpenAI API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{id:"openai-key",type:"password",placeholder:"sk-...",value:d,onChange:c=>h(c.target.value)}),e.jsx(N,{onClick:I,disabled:l||!d,children:l?e.jsx(O,{className:"h-4 w-4 animate-spin"}):"Save"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Get your API key from ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-violet-500 hover:underline",children:"platform.openai.com"})]})]})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upgrade to Pro to use AI-powered features like plain-language update reports."})})]}),e.jsxs(K,{className:"border-orange-500/50 bg-orange-500/5",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"h-5 w-5 text-orange-500"}),e.jsx(q,{children:"Recovery Portal"})]}),(i==null?void 0:i.has_pin)&&e.jsxs("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold flex items-center gap-1",children:[e.jsx(_t,{className:"h-3 w-3"})," PIN PROTECTED"]})]}),e.jsx(Y,{children:"Access this URL to recover your site if WordPress crashes."})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{children:"Recovery URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{value:(i==null?void 0:i.url)||"",readOnly:!0,className:"font-mono text-xs bg-slate-50"}),e.jsx(N,{variant:"outline",size:"icon",onClick:$,children:b?e.jsx(Xe,{className:"h-4 w-4 text-emerald-500"}):e.jsx(ms,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Save this URL somewhere safe! It works even when WordPress is broken."})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsx(W,{children:i!=null&&i.has_pin?"Change or Remove PIN":"Set Optional PIN"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{type:"password",placeholder:i!=null&&i.has_pin?"New PIN (or leave empty to remove)":"Enter a PIN (optional)",value:j,onChange:c=>v(c.target.value)}),e.jsx(N,{onClick:z,disabled:m,variant:i!=null&&i.has_pin&&!j?"destructive":"default",children:m?e.jsx(O,{className:"h-4 w-4 animate-spin"}):i!=null&&i.has_pin&&!j?"Remove":"Save"})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(N,{variant:"ghost",size:"sm",className:"text-muted-foreground",onClick:E,disabled:m,children:[e.jsx(_e,{className:"h-3 w-3 mr-2"}),"Regenerate Recovery Key"]})})]})]})]})}function on({onBack:s}){const[t,a]=n.useState([]),[r,o]=n.useState(!1),[x,i]=n.useState(!1),{toast:u}=Z(),d=async()=>{o(!0);try{const k=await(await fetch(`${window.sbwpData.restUrl}/schedules`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();a(k)}catch(v){console.error(v)}finally{o(!1)}};n.useEffect(()=>{d()},[]);const h=async v=>{i(!0);try{(await fetch(`${window.sbwpData.restUrl}/schedules`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({frequency:v,time:"00:00"})})).ok&&(u({title:"Schedule Created",description:`New ${v} schedule added.`}),d())}catch{u({title:"Error",variant:"destructive",description:"Failed to create schedule."})}finally{i(!1)}},j=async v=>{if(confirm("Delete this schedule?"))try{await fetch(`${window.sbwpData.restUrl}/schedules/${v}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}}),u({title:"Schedule Deleted"}),d()}catch{u({title:"Error",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(N,{variant:"ghost",size:"sm",onClick:s,children:[e.jsx(ds,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Scheduled Backups"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your automated backup routines."})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(K,{children:[e.jsxs(H,{children:[e.jsx(q,{children:"Create Schedule"}),e.jsx(Y,{children:"Add a new automated backup task."})]}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs(N,{className:"w-full justify-start",onClick:()=>h("daily"),disabled:x,children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Add Daily Backup"]}),e.jsxs(N,{className:"w-full justify-start",variant:"secondary",onClick:()=>h("weekly"),disabled:x,children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Add Weekly Backup"]})]})]}),e.jsxs(K,{children:[e.jsxs(H,{children:[e.jsx(q,{children:"Active Schedules"}),e.jsx(Y,{children:"Your currently running backup jobs."})]}),e.jsx(X,{children:r?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(O,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No active schedules."}):e.jsx("div",{className:"space-y-2",children:t.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium capitalize",children:[v.frequency," Backup"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Next run: calculated by WP Cron"})]})]}),e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>j(v.id),children:e.jsx(gs,{className:"h-4 w-4 text-red-500"})})]},v.id))})})]})]})]})}function ts(){const[s,t]=n.useState("dashboard");return e.jsx("div",{className:"min-h-screen bg-background p-8 font-sans antialiased text-foreground",children:e.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"SafeBackup & Repair"}),e.jsxs("div",{className:"flex items-center gap-2",children:[window.sbwpData.isPro?e.jsx("span",{className:"text-xs font-medium text-emerald-600 bg-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-400 px-2 py-1 rounded-full border border-emerald-200 dark:border-emerald-800",children:"Pro Active"}):e.jsx("span",{className:"text-xs font-medium text-slate-600 bg-slate-100 dark:bg-slate-900/30 dark:text-slate-400 px-2 py-1 rounded-full border border-slate-200 dark:border-slate-800",children:"Free Edition"}),e.jsx("button",{onClick:()=>t("settings"),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Settings"})]})]}),s==="dashboard"&&e.jsx(an,{onNavigate:t}),s==="settings"&&e.jsx(rn,{onBack:()=>t("dashboard"),onNavigate:t}),s==="schedules"&&e.jsx(on,{onBack:()=>t("dashboard")})]})})}const as=document.getElementById("sbwp-admin-root");if(as)ze.createRoot(as).render(e.jsx(We.StrictMode,{children:e.jsx(ts,{})}));else{const s=document.getElementById("root");s&&ze.createRoot(s).render(e.jsx(We.StrictMode,{children:e.jsx(ts,{})}))}
