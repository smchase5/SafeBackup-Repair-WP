import{c as E,r as n,j as e,a as qe,b as F,P as G,d as zs,e as Ks,u as Je,B as Ws,f as Xs,g as Hs,h as X,i as ie,k as Gs,R as Ys,l as qs,m as Js,n as Zs,o as Ze,C as Qs,D as ce,p as de,q as ue,s as me,t as xe,L as _,v as b,w as Te,S as Qe,A as he,T as et,x as st,y as Fe,z as Me,E as tt,F as $,G as L,H as U,I as Y,J as B,K as at,M as Oe,N as $e}from"./globals-ByXEjEg8.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=E("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=E("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=E("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=E("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=E("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.25V14",key:"re2vv1"}],["path",{d:"M22 16a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z",key:"ame013"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=E("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=E("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=E("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=E("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=E("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=E("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=E("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=E("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=E("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=E("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=E("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=E("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=E("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=E("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=E("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=E("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=E("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=E("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=E("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=E("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=E("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function vt(s,t=[]){let a=[];function r(m,i){const c=n.createContext(i);c.displayName=m+"Context";const d=a.length;a=[...a,i];const x=g=>{var P;const{scope:j,children:T,...y}=g,h=((P=j==null?void 0:j[s])==null?void 0:P[d])||c,p=n.useMemo(()=>y,Object.values(y));return e.jsx(h.Provider,{value:p,children:T})};x.displayName=m+"Provider";function v(g,j){var h;const T=((h=j==null?void 0:j[s])==null?void 0:h[d])||c,y=n.useContext(T);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${g}\` must be used within \`${m}\``)}return[x,v]}const o=()=>{const m=a.map(i=>n.createContext(i));return function(c){const d=(c==null?void 0:c[s])||m;return n.useMemo(()=>({[`__scope${s}`]:{...c,[s]:d}}),[c,d])}};return o.scopeName=s,[r,jt(o,...t)]}function jt(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const r=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(m){const i=r.reduce((c,{useScope:d,scopeName:x})=>{const g=d(m)[`__scope${x}`];return{...c,...g}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return a.scopeName=t.scopeName,a}var bt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],rs=bt.reduce((s,t)=>{const a=qe(`Primitive.${t}`),r=n.forwardRef((o,m)=>{const{asChild:i,...c}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:m})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),Pe="Progress",Ee=100,[Nt]=vt(Pe),[kt,St]=Nt(Pe),os=n.forwardRef((s,t)=>{const{__scopeProgress:a,value:r=null,max:o,getValueLabel:m=Ct,...i}=s;(o||o===0)&&!Be(o)&&console.error(Tt(`${o}`,"Progress"));const c=Be(o)?o:Ee;r!==null&&!Ve(r,c)&&console.error(Pt(`${r}`,"Progress"));const d=Ve(r,c)?r:null,x=le(d)?m(d,c):void 0;return e.jsx(kt,{scope:a,value:d,max:c,children:e.jsx(rs.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":le(d)?d:void 0,"aria-valuetext":x,role:"progressbar","data-state":cs(d,c),"data-value":d??void 0,"data-max":c,...i,ref:t})})});os.displayName=Pe;var is="ProgressIndicator",ls=n.forwardRef((s,t)=>{const{__scopeProgress:a,...r}=s,o=St(is,a);return e.jsx(rs.div,{"data-state":cs(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...r,ref:t})});ls.displayName=is;function Ct(s,t){return`${Math.round(s/t*100)}%`}function cs(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function le(s){return typeof s=="number"}function Be(s){return le(s)&&!isNaN(s)&&s>0}function Ve(s,t){return le(s)&&!isNaN(s)&&s<=t&&s>=0}function Tt(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ee}\`.`}function Pt(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ee} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ds=os,Et=ls;const us=n.forwardRef(({className:s,value:t,...a},r)=>e.jsx(ds,{ref:r,className:F("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(Et,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));us.displayName=ds.displayName;async function Dt(){const s=await fetch(`${window.sbwpData.restUrl}/stats`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch stats");return s.json()}async function Rt(){const s=await fetch(`${window.sbwpData.restUrl}/backups`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch backups");return s.json()}async function It(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to delete backup");return t.json()}async function _t(s){const t=await fetch(`${window.sbwpData.restUrl}/backups/${s}/contents`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch backup contents");return t.json()}async function ze(s,t){const a=await fetch(`${window.sbwpData.restUrl}/backups/${s}/restore`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({items:t})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to restore backup")}return a.json()}async function At(){try{const s=await fetch(`${window.sbwpData.restUrl}/backup/progress`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)return{percent:0,message:"Idle"};const t=await s.text();return t?JSON.parse(t):{percent:0,message:"Idle"}}catch{return{percent:0,message:"Idle"}}}async function Ft(){const s=await fetch(`${window.sbwpData.restUrl}/cloud/providers`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(s.status===404)return[];if(!s.ok)throw new Error("Failed to fetch cloud providers");return s.json()}async function ge(s,t,a){const r=await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/connect`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({provider_id:s,action:t,...a})}),o=await r.json();if(!r.ok)throw new Error(o.message||"Failed to connect");return o}async function Mt(){return(await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json()}async function Ot(s){await fetch(`${window.sbwpData.root}wp-json/sbwp/v1/cloud/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify(s)})}async function $t(){const s=await fetch(`${window.sbwpData.restUrl}/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch settings");return s.json()}async function Lt(s){const t=await fetch(`${window.sbwpData.restUrl}/settings`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to save settings");return t.json()}async function Ke(s=!1){const t=await fetch(`${window.sbwpData.restUrl}/backups`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({resume:s})}),a=await t.text();if(!a)throw console.error(`SBWP Fetch Error: Empty response. Status: ${t.status} ${t.statusText}`),new Error(`Empty response from server (Status ${t.status})`);try{const r=JSON.parse(a);if(!t.ok)throw new Error(r.message||"Failed to create backup");return r}catch{throw console.error("JSON Parse Error:",a),new Error("Invalid server response")}}async function Ut(){const s=await fetch(`${window.sbwpData.restUrl}/safe-update/available`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch available updates");return s.json()}async function Bt(s,t=[],a=!1){const r=await fetch(`${window.sbwpData.restUrl}/safe-update/session`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({plugins:s,themes:t,core:a})});if(!r.ok)throw new Error("Failed to create safe update session");return r.json()}async function Vt(s){const t=await fetch(`${window.sbwpData.restUrl}/safe-update/session/${s}`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!t.ok)throw new Error("Failed to fetch session");return t.json()}async function zt(){const s=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch AI settings");return s.json()}async function We(s){const t=await fetch(`${window.sbwpData.restUrl}/settings/ai`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({api_key:s})});if(!t.ok)throw new Error("Failed to save AI settings");return t.json()}async function Kt(s){const t=await fetch(`${window.sbwpData.restUrl}/ai/humanize-report`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({session_id:s})});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to get AI summary")}return t.json()}async function Wt(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to fetch recovery settings");return s.json()}async function Xt(s){const t=await fetch(`${window.sbwpData.restUrl}/recovery/settings`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.sbwpData.nonce},body:JSON.stringify({pin:s})});if(!t.ok)throw new Error("Failed to save recovery PIN");return t.json()}async function Ht(){const s=await fetch(`${window.sbwpData.restUrl}/recovery/regenerate-key`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to regenerate key");return s.json()}async function Gt(){const s=await fetch(`${window.sbwpData.restUrl}/crash-status`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}});if(!s.ok)throw new Error("Failed to get crash status");return s.json()}const Yt=1,qt=1e6;let ye=0;function Jt(){return ye=(ye+1)%Number.MAX_SAFE_INTEGER,ye.toString()}const ve=new Map,Xe=s=>{if(ve.has(s))return;const t=setTimeout(()=>{ve.delete(s),Q({type:"REMOVE_TOAST",toastId:s})},qt);ve.set(s,t)},Zt=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,Yt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Xe(a):s.toasts.forEach(r=>{Xe(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===a||t.toastId===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},re=[];let oe={toasts:[]};function Q(s){oe=Zt(oe,s),re.forEach(t=>{t(oe)})}function Qt({...s}){const t=Jt(),a=o=>Q({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>Q({type:"DISMISS_TOAST",toastId:t});return Q({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:a}}function q(){const[s,t]=n.useState(oe);return n.useEffect(()=>(re.push(t),()=>{const a=re.indexOf(t);a>-1&&re.splice(a,1)}),[s]),{...s,toast:Qt,dismiss:a=>Q({type:"DISMISS_TOAST",toastId:a})}}var ea=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),sa="VisuallyHidden",De=n.forwardRef((s,t)=>e.jsx(G.span,{...s,ref:t,style:{...ea,...s.style}}));De.displayName=sa;var Re="ToastProvider",[Ie,ta,aa]=Ks("Toast"),[ms]=zs("Toast",[aa]),[na,pe]=ms(Re),xs=s=>{const{__scopeToast:t,label:a="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:m=50,children:i}=s,[c,d]=n.useState(null),[x,v]=n.useState(0),g=n.useRef(!1),j=n.useRef(!1);return a.trim()||console.error(`Invalid prop \`label\` supplied to \`${Re}\`. Expected non-empty \`string\`.`),e.jsx(Ie.Provider,{scope:t,children:e.jsx(na,{scope:t,label:a,duration:r,swipeDirection:o,swipeThreshold:m,toastCount:x,viewport:c,onViewportChange:d,onToastAdd:n.useCallback(()=>v(T=>T+1),[]),onToastRemove:n.useCallback(()=>v(T=>T-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:j,children:i})})};xs.displayName=Re;var hs="ToastViewport",ra=["F8"],Ne="toast.viewportPause",ke="toast.viewportResume",ps=n.forwardRef((s,t)=>{const{__scopeToast:a,hotkey:r=ra,label:o="Notifications ({hotkey})",...m}=s,i=pe(hs,a),c=ta(a),d=n.useRef(null),x=n.useRef(null),v=n.useRef(null),g=n.useRef(null),j=Je(t,g,i.onViewportChange),T=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=i.toastCount>0;n.useEffect(()=>{const p=P=>{var C;r.length!==0&&r.every(f=>P[f]||P.code===f)&&((C=g.current)==null||C.focus())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[r]),n.useEffect(()=>{const p=d.current,P=g.current;if(y&&p&&P){const S=()=>{if(!i.isClosePausedRef.current){const u=new CustomEvent(Ne);P.dispatchEvent(u),i.isClosePausedRef.current=!0}},C=()=>{if(i.isClosePausedRef.current){const u=new CustomEvent(ke);P.dispatchEvent(u),i.isClosePausedRef.current=!1}},f=u=>{!p.contains(u.relatedTarget)&&C()},w=()=>{p.contains(document.activeElement)||C()};return p.addEventListener("focusin",S),p.addEventListener("focusout",f),p.addEventListener("pointermove",S),p.addEventListener("pointerleave",w),window.addEventListener("blur",S),window.addEventListener("focus",C),()=>{p.removeEventListener("focusin",S),p.removeEventListener("focusout",f),p.removeEventListener("pointermove",S),p.removeEventListener("pointerleave",w),window.removeEventListener("blur",S),window.removeEventListener("focus",C)}}},[y,i.isClosePausedRef]);const h=n.useCallback(({tabbingDirection:p})=>{const S=c().map(C=>{const f=C.ref.current,w=[f,...ga(f)];return p==="forwards"?w:w.reverse()});return(p==="forwards"?S.reverse():S).flat()},[c]);return n.useEffect(()=>{const p=g.current;if(p){const P=S=>{var w,u,D;const C=S.altKey||S.ctrlKey||S.metaKey;if(S.key==="Tab"&&!C){const R=document.activeElement,A=S.shiftKey;if(S.target===p&&A){(w=x.current)==null||w.focus();return}const M=h({tabbingDirection:A?"backwards":"forwards"}),H=M.findIndex(N=>N===R);je(M.slice(H+1))?S.preventDefault():A?(u=x.current)==null||u.focus():(D=v.current)==null||D.focus()}};return p.addEventListener("keydown",P),()=>p.removeEventListener("keydown",P)}},[c,h]),e.jsxs(Ws,{ref:d,role:"region","aria-label":o.replace("{hotkey}",T),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&e.jsx(Se,{ref:x,onFocusFromOutsideViewport:()=>{const p=h({tabbingDirection:"forwards"});je(p)}}),e.jsx(Ie.Slot,{scope:a,children:e.jsx(G.ol,{tabIndex:-1,...m,ref:j})}),y&&e.jsx(Se,{ref:v,onFocusFromOutsideViewport:()=>{const p=h({tabbingDirection:"backwards"});je(p)}})]})});ps.displayName=hs;var fs="ToastFocusProxy",Se=n.forwardRef((s,t)=>{const{__scopeToast:a,onFocusFromOutsideViewport:r,...o}=s,m=pe(fs,a);return e.jsx(De,{tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:i=>{var x;const c=i.relatedTarget;!((x=m.viewport)!=null&&x.contains(c))&&r()}})});Se.displayName=fs;var ee="Toast",oa="toast.swipeStart",ia="toast.swipeMove",la="toast.swipeCancel",ca="toast.swipeEnd",ws=n.forwardRef((s,t)=>{const{forceMount:a,open:r,defaultOpen:o,onOpenChange:m,...i}=s,[c,d]=Xs({prop:r,defaultProp:o??!0,onChange:m,caller:ee});return e.jsx(Hs,{present:a||c,children:e.jsx(ma,{open:c,...i,ref:t,onClose:()=>d(!1),onPause:ie(s.onPause),onResume:ie(s.onResume),onSwipeStart:X(s.onSwipeStart,x=>{x.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:X(s.onSwipeMove,x=>{const{x:v,y:g}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","move"),x.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${v}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:X(s.onSwipeCancel,x=>{x.currentTarget.setAttribute("data-swipe","cancel"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:X(s.onSwipeEnd,x=>{const{x:v,y:g}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","end"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${v}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),d(!1)})})})});ws.displayName=ee;var[da,ua]=ms(ee,{onClose(){}}),ma=n.forwardRef((s,t)=>{const{__scopeToast:a,type:r="foreground",duration:o,open:m,onClose:i,onEscapeKeyDown:c,onPause:d,onResume:x,onSwipeStart:v,onSwipeMove:g,onSwipeCancel:j,onSwipeEnd:T,...y}=s,h=pe(ee,a),[p,P]=n.useState(null),S=Je(t,N=>P(N)),C=n.useRef(null),f=n.useRef(null),w=o||h.duration,u=n.useRef(0),D=n.useRef(w),R=n.useRef(0),{onToastAdd:A,onToastRemove:W}=h,V=ie(()=>{var l;(p==null?void 0:p.contains(document.activeElement))&&((l=h.viewport)==null||l.focus()),i()}),M=n.useCallback(N=>{!N||N===1/0||(window.clearTimeout(R.current),u.current=new Date().getTime(),R.current=window.setTimeout(V,N))},[V]);n.useEffect(()=>{const N=h.viewport;if(N){const l=()=>{M(D.current),x==null||x()},k=()=>{const I=new Date().getTime()-u.current;D.current=D.current-I,window.clearTimeout(R.current),d==null||d()};return N.addEventListener(Ne,k),N.addEventListener(ke,l),()=>{N.removeEventListener(Ne,k),N.removeEventListener(ke,l)}}},[h.viewport,w,d,x,M]),n.useEffect(()=>{m&&!h.isClosePausedRef.current&&M(w)},[m,w,h.isClosePausedRef,M]),n.useEffect(()=>(A(),()=>W()),[A,W]);const H=n.useMemo(()=>p?ks(p):null,[p]);return h.viewport?e.jsxs(e.Fragment,{children:[H&&e.jsx(xa,{__scopeToast:a,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:H}),e.jsx(da,{scope:a,onClose:V,children:Gs.createPortal(e.jsx(Ie.ItemSlot,{scope:a,children:e.jsx(Ys,{asChild:!0,onEscapeKeyDown:X(c,()=>{h.isFocusedToastEscapeKeyDownRef.current||V(),h.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(G.li,{tabIndex:0,"data-state":m?"open":"closed","data-swipe-direction":h.swipeDirection,...y,ref:S,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:X(s.onKeyDown,N=>{N.key==="Escape"&&(c==null||c(N.nativeEvent),N.nativeEvent.defaultPrevented||(h.isFocusedToastEscapeKeyDownRef.current=!0,V()))}),onPointerDown:X(s.onPointerDown,N=>{N.button===0&&(C.current={x:N.clientX,y:N.clientY})}),onPointerMove:X(s.onPointerMove,N=>{if(!C.current)return;const l=N.clientX-C.current.x,k=N.clientY-C.current.y,I=!!f.current,K=["left","right"].includes(h.swipeDirection),se=["left","up"].includes(h.swipeDirection)?Math.min:Math.max,Bs=K?se(0,l):0,Vs=K?0:se(0,k),fe=N.pointerType==="touch"?10:2,te={x:Bs,y:Vs},Ae={originalEvent:N,delta:te};I?(f.current=te,ae(ia,g,Ae,{discrete:!1})):He(te,h.swipeDirection,fe)?(f.current=te,ae(oa,v,Ae,{discrete:!1}),N.target.setPointerCapture(N.pointerId)):(Math.abs(l)>fe||Math.abs(k)>fe)&&(C.current=null)}),onPointerUp:X(s.onPointerUp,N=>{const l=f.current,k=N.target;if(k.hasPointerCapture(N.pointerId)&&k.releasePointerCapture(N.pointerId),f.current=null,C.current=null,l){const I=N.currentTarget,K={originalEvent:N,delta:l};He(l,h.swipeDirection,h.swipeThreshold)?ae(ca,T,K,{discrete:!0}):ae(la,j,K,{discrete:!0}),I.addEventListener("click",se=>se.preventDefault(),{once:!0})}})})})}),h.viewport)})]}):null}),xa=s=>{const{__scopeToast:t,children:a,...r}=s,o=pe(ee,t),[m,i]=n.useState(!1),[c,d]=n.useState(!1);return fa(()=>i(!0)),n.useEffect(()=>{const x=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(x)},[]),c?null:e.jsx(qs,{asChild:!0,children:e.jsx(De,{...r,children:m&&e.jsxs(e.Fragment,{children:[o.label," ",a]})})})},ha="ToastTitle",gs=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s;return e.jsx(G.div,{...r,ref:t})});gs.displayName=ha;var pa="ToastDescription",ys=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s;return e.jsx(G.div,{...r,ref:t})});ys.displayName=pa;var vs="ToastAction",js=n.forwardRef((s,t)=>{const{altText:a,...r}=s;return a.trim()?e.jsx(Ns,{altText:a,asChild:!0,children:e.jsx(_e,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${vs}\`. Expected non-empty \`string\`.`),null)});js.displayName=vs;var bs="ToastClose",_e=n.forwardRef((s,t)=>{const{__scopeToast:a,...r}=s,o=ua(bs,a);return e.jsx(Ns,{asChild:!0,children:e.jsx(G.button,{type:"button",...r,ref:t,onClick:X(s.onClick,o.onClose)})})});_e.displayName=bs;var Ns=n.forwardRef((s,t)=>{const{__scopeToast:a,altText:r,...o}=s;return e.jsx(G.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function ks(s){const t=[];return Array.from(s.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),wa(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",m=r.dataset.radixToastAnnounceExclude==="";if(!o)if(m){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...ks(r))}}),t}function ae(s,t,a,{discrete:r}){const o=a.originalEvent.currentTarget,m=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:a});t&&o.addEventListener(s,t,{once:!0}),r?Zs(o,m):o.dispatchEvent(m)}var He=(s,t,a=0)=>{const r=Math.abs(s.x),o=Math.abs(s.y),m=r>o;return t==="left"||t==="right"?m&&r>a:!m&&o>a};function fa(s=()=>{}){const t=ie(s);Js(()=>{let a=0,r=0;return a=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(r)}},[t])}function wa(s){return s.nodeType===s.ELEMENT_NODE}function ga(s){const t=[],a=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;a.nextNode();)t.push(a.currentNode);return t}function je(s){const t=document.activeElement;return s.some(a=>a===t?!0:(a.focus(),document.activeElement!==t))}var ya=xs,Ss=ps,Cs=ws,Ts=gs,Ps=ys,Es=js,Ds=_e;const va=ya,Rs=n.forwardRef(({className:s,...t},a)=>e.jsx(Ss,{ref:a,className:F("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));Rs.displayName=Ss.displayName;const ja=Ze("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Is=n.forwardRef(({className:s,variant:t,...a},r)=>e.jsx(Cs,{ref:r,className:F(ja({variant:t}),s),...a}));Is.displayName=Cs.displayName;const ba=n.forwardRef(({className:s,...t},a)=>e.jsx(Es,{ref:a,className:F("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));ba.displayName=Es.displayName;const _s=n.forwardRef(({className:s,...t},a)=>e.jsx(Ds,{ref:a,className:F("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Qs,{className:"h-4 w-4"})}));_s.displayName=Ds.displayName;const As=n.forwardRef(({className:s,...t},a)=>e.jsx(Ts,{ref:a,className:F("text-sm font-semibold",s),...t}));As.displayName=Ts.displayName;const Fs=n.forwardRef(({className:s,...t},a)=>e.jsx(Ps,{ref:a,className:F("text-sm opacity-90",s),...t}));Fs.displayName=Ps.displayName;function Na(){const{toasts:s}=q();return e.jsxs(va,{children:[s.map(function({id:t,title:a,description:r,action:o,...m}){return e.jsxs(Is,{...m,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(As,{children:a}),r&&e.jsx(Fs,{children:r})]}),o,e.jsx(_s,{})]},t)}),e.jsx(Rs,{})]})}function ka({open:s,onOpenChange:t}){const[a,r]=n.useState("loading"),[o,m]=n.useState([]),[i,c]=n.useState([]),[d,x]=n.useState(null),[v,g]=n.useState(""),[j,T]=n.useState(0),[y,h]=n.useState([]),[p,P]=n.useState(null),[S,C]=n.useState(""),[f,w]=n.useState(""),[u,D]=n.useState(!1);n.useEffect(()=>{s?R():(r("loading"),c([]),x(null),P(null),w(""),D(!1),C(""),T(0),h([]))},[s]),n.useEffect(()=>{let l=null;return a==="running"&&d&&(l=setInterval(async()=>{try{const k=await Vt(d);if(k.progress){const I=k.progress.message;g(I),T(k.progress.percent||0),h(K=>K.length===0||K[K.length-1]!==I?[...K,I]:K)}k.status==="completed"?(P(k.result),r("complete")):k.status==="failed"&&(C(k.error_message||"Unknown error"),r("failed"))}catch(k){console.error("Polling error:",k)}},1500)),()=>{l&&clearInterval(l)}},[a,d]);const R=async()=>{r("loading");try{const l=await Ut();m(l.plugins),c(l.plugins.map(k=>k.file||k.slug||"").filter(Boolean)),r("select")}catch{C("Failed to load available updates"),r("error")}},A=l=>{c(k=>k.includes(l)?k.filter(I=>I!==l):[...k,l])},W=()=>{c(o.map(l=>l.file||l.slug||"").filter(Boolean))},V=()=>{c([])},M=async()=>{if(i.length!==0){r("running"),g("Creating test environment...");try{const l=await Bt(i);x(l.session_id),g("Test session created, waiting for results...")}catch{C("Failed to start safe update test"),r("error")}}},H=l=>{switch(l){case"safe":return e.jsx(ne,{className:"h-4 w-4 text-emerald-500"});case"risky":return e.jsx(he,{className:"h-4 w-4 text-yellow-500"});case"unsafe":return e.jsx(we,{className:"h-4 w-4 text-red-500"});default:return e.jsx(_,{className:"h-4 w-4 animate-spin text-muted-foreground"})}},N=l=>{switch(l){case"safe":return"bg-emerald-100 text-emerald-700";case"risky":return"bg-yellow-100 text-yellow-700";case"unsafe":return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return e.jsx(ce,{open:s,onOpenChange:t,children:e.jsxs(de,{className:"sm:max-w-[550px] max-h-[85vh] overflow-y-auto",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Safe Update Tester"}),e.jsx(xe,{children:"Test updates in a temporary sandbox before applying them to your live site."})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[a==="loading"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(_,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading available updates..."})]}),a==="select"&&e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(ne,{className:"h-6 w-6 text-emerald-600"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All plugins and themes are up to date!"}),e.jsx(b,{variant:"outline",onClick:()=>t(!1),children:"Close"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o.length," update",o.length!==1?"s":""," available"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:W,children:"Select All"}),e.jsx(b,{variant:"ghost",size:"sm",onClick:V,children:"Select None"})]})]}),e.jsx("div",{className:"border rounded-lg divide-y max-h-60 overflow-y-auto",children:o.map(l=>{const k=l.file||l.slug||"",I=i.includes(k);return e.jsxs("label",{className:`flex items-center gap-3 p-3 cursor-pointer hover:bg-slate-50 transition-colors ${I?"bg-blue-50/50":""}`,children:[e.jsx("input",{type:"checkbox",checked:I,onChange:()=>A(k),className:"rounded border-slate-300"}),e.jsx(ts,{className:"h-4 w-4 text-slate-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:l.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.current_version," → ",l.new_version]})]}),l.requires_php&&e.jsxs("span",{className:"text-[10px] bg-slate-100 px-1.5 py-0.5 rounded",children:["PHP ",l.requires_php,"+"]})]},k)})}),e.jsxs(b,{className:"w-full",disabled:i.length===0,onClick:M,children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Test ",i.length," Update",i.length!==1?"s":""]})]})}),a==="running"&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Te,{className:"h-8 w-8 text-blue-600 animate-spin"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold",children:"Running Safe Update Test"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:v||"Starting..."})]})]}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out",style:{width:`${j}%`}})}),e.jsxs("div",{className:"bg-slate-950 text-slate-50 p-3 rounded-md font-mono text-xs h-32 overflow-y-auto border border-slate-800",children:[y.map((l,k)=>{const I=k===y.length-1;return e.jsxs("div",{className:`flex items-start gap-1 ${I?"text-emerald-400":"text-slate-500"}`,children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:I?"animate-pulse":"",children:l}),I&&e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]},k)}),y.length===0&&e.jsxs("div",{className:"flex items-center gap-1 text-emerald-400",children:[e.jsx("span",{className:"text-slate-600",children:">"}),e.jsx("span",{className:"animate-pulse",children:"Initializing..."}),e.jsx("span",{className:"inline-block w-2 h-4 bg-emerald-400 animate-[blink_1s_infinite] ml-0.5"})]})]}),e.jsxs("p",{className:"text-xs text-center text-muted-foreground",children:[j<50?"Downloading updates...":"Testing updates..."," Please don't close this window."]})]}),a==="complete"&&p&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${N(p.summary.overall_status)}`,children:[p.summary.overall_status==="safe"&&"✓ Safe to Update",p.summary.overall_status==="risky"&&"⚠ Proceed with Caution",p.summary.overall_status==="unsafe"&&"✗ Issues Detected"]})}),e.jsx("div",{className:"border rounded-lg divide-y",children:p.items.plugins.map(l=>e.jsxs("div",{className:"p-3 flex items-start gap-3",children:[H(l.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:l.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[l.from_version," → ",l.to_version]}),l.issues.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:l.issues.map((k,I)=>e.jsx("div",{className:"text-xs bg-red-50 text-red-700 p-2 rounded",children:k.message},I))})]})]},l.slug))}),p.health_checks.length>0&&e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Health Checks"}),e.jsx("div",{className:"space-y-1",children:p.health_checks.map((l,k)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.status_code===200&&!l.wsod_detected?e.jsx(ne,{className:"h-3 w-3 text-emerald-500"}):e.jsx(we,{className:"h-3 w-3 text-red-500"}),e.jsx("span",{children:l.label}),e.jsxs("span",{className:"text-muted-foreground",children:["(",l.status_code,")"]})]},k))})]}),window.sbwpData.isPro&&d&&e.jsxs("div",{className:"border border-violet-200 rounded-lg p-3 bg-violet-50/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qe,{className:"h-4 w-4 text-violet-500"}),e.jsx("span",{className:"text-sm font-medium",children:"AI Explanation"})]}),f?e.jsx("p",{className:"text-sm text-slate-700",children:f}):e.jsx(b,{size:"sm",variant:"outline",className:"text-violet-600 border-violet-200 hover:bg-violet-100",onClick:async()=>{D(!0);try{const l=await Kt(d);w(l.summary)}catch{w("Could not generate AI summary. Please check your API key in Settings.")}finally{D(!1)}},disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-4 w-4 animate-spin mr-2"})," Generating..."]}):e.jsx(e.Fragment,{children:"Explain in Plain English"})})]}),e.jsxs("div",{className:"flex gap-2",children:[p.summary.overall_status==="safe"&&e.jsx(b,{className:"flex-1 bg-emerald-600 hover:bg-emerald-700",onClick:()=>window.location.href="/wp-admin/update-core.php",children:"Apply Updates"}),e.jsx(b,{variant:"outline",className:p.summary.overall_status==="safe"?"":"flex-1",onClick:()=>t(!1),children:"Close"})]})]}),(a==="failed"||a==="error")&&e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Test Failed"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:S})]}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(b,{variant:"outline",onClick:R,children:"Try Again"}),e.jsx(b,{variant:"ghost",onClick:()=>t(!1),children:"Close"})]})]})]})]})})}function Sa({open:s,onOpenChange:t}){const[a,r]=n.useState("idle"),[o,m]=n.useState(0),[i,c]=n.useState(0),[d,x]=n.useState(null),v=async()=>{r("scanning"),m(0),c(0);const g=setInterval(()=>{m(j=>{const T=j+5;return T>90?90:T}),c(j=>j+1)},200);try{const T=await(await fetch(`${window.sbwpData.restUrl}/conflict-scan/start`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();clearInterval(g),m(100),T.culprit?(r("found"),x(T.culprit)):r("clean")}catch(j){clearInterval(g),r("idle"),console.error(j)}};return e.jsx(ce,{open:s,onOpenChange:t,children:e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Automated Conflict Scanner"}),e.jsx(xe,{children:"Automatically diagnose plugin conflicts by simulating binary searches."})]}),e.jsxs("div",{className:"py-6 space-y-6",children:[a==="idle"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(ot,{className:"h-8 w-8 text-orange-600"})}),e.jsx("p",{className:"text-muted-foreground",children:"This tool will temporarily simulate deactivating plugins to identify which one is causing errors on your site."}),e.jsx(b,{size:"lg",onClick:v,className:"bg-orange-600 hover:bg-orange-700",children:"Start Auto-Diagnosis"})]}),a==="scanning"&&e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx(_,{className:"h-12 w-12 animate-spin text-orange-500 mx-auto"}),e.jsx("h3",{className:"font-semibold text-lg",children:"Scanning Plugins..."}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Checked ",i," plugins so far"]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden w-full",children:e.jsx("div",{className:"h-full bg-orange-500 transition-all duration-300",style:{width:`${o}%`}})})]}),a==="found"&&d&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-800",children:[e.jsx(he,{className:"h-6 w-6"}),e.jsx("h3",{className:"font-bold text-lg",children:"Conflict Detected!"})]}),e.jsxs("div",{className:"bg-white p-3 rounded border border-red-100",children:[e.jsx("p",{className:"font-semibold",children:d.name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono mt-1",children:d.file})]}),e.jsxs("p",{className:"text-sm text-red-700",children:[e.jsx("strong",{children:"Issue:"})," ",d.reason]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(b,{variant:"destructive",className:"flex-1",children:"Deactivate Plugin"}),e.jsx(b,{variant:"outline",className:"flex-1",onClick:()=>t(!1),children:"Ignore"})]})]}),a==="clean"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx(ne,{className:"h-8 w-8 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-lg",children:"No Conflicts Found"}),e.jsx("p",{className:"text-muted-foreground",children:"your plugins appear to be working correctly together."}),e.jsx(b,{variant:"outline",onClick:()=>t(!1),children:"Close"})]})]})]})})}const Ms=n.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"w-full overflow-auto",children:e.jsx("table",{ref:a,className:F("w-full caption-bottom text-sm",s),...t})}));Ms.displayName="Table";const Os=n.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:F("[&_tr]:border-b",s),...t}));Os.displayName="TableHeader";const $s=n.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:F("[&_tr:last-child]:border-0",s),...t}));$s.displayName="TableBody";const Ca=n.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:F("bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Ca.displayName="TableFooter";const Ce=n.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:F("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));Ce.displayName="TableRow";const J=n.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:F("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));J.displayName="TableHead";const Z=n.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:F("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));Z.displayName="TableCell";const Ta=n.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:F("mt-4 text-sm text-muted-foreground",s),...t}));Ta.displayName="TableCaption";var Pa=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ea=Pa.reduce((s,t)=>{const a=qe(`Primitive.${t}`),r=n.forwardRef((o,m)=>{const{asChild:i,...c}=o,d=i?a:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:m})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),Da="Label",Ls=n.forwardRef((s,t)=>e.jsx(Ea.label,{...s,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=s.onMouseDown)==null||o.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));Ls.displayName=Da;var Us=Ls;const Ra=Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),O=n.forwardRef(({className:s,...t},a)=>e.jsx(Us,{ref:a,className:F(Ra(),s),...t}));O.displayName=Us.displayName;function Ia(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+r[o]}function _a({backup:s,open:t,onOpenChange:a,onComplete:r}){const[o,m]=n.useState("initial"),[i,c]=n.useState("full"),[d,x]=n.useState(!1),[v,g]=n.useState(null),[j,T]=n.useState([]),[y,h]=n.useState([]),{toast:p}=q();n.useEffect(()=>{t&&(m("initial"),c("full"),x(!1),g(null),T([]),h([]))},[t]);const P=async()=>{if(s){x(!0);try{const w=await _t(s.id);g(w),m("select")}catch{p({title:"Error",description:"Failed to load backup contents.",variant:"destructive"})}finally{x(!1)}}},S=async()=>{if(s){m("restoring");try{i==="full"?await ze(s.id):await ze(s.id,{plugins:j,themes:y}),p({title:"Restore Complete",description:"The backup has been restored successfully."}),r(),a(!1),setTimeout(()=>window.location.reload(),1500)}catch(w){m("initial"),p({title:"Restore Failed",description:w.message||"An error occurred during restore.",variant:"destructive"})}}},C=w=>{T(u=>u.includes(w)?u.filter(D=>D!==w):[...u,w])},f=w=>{h(u=>u.includes(w)?u.filter(D=>D!==w):[...u,w])};return s?e.jsx(ce,{open:t,onOpenChange:w=>!d&&a(w),children:e.jsxs(de,{className:"sm:max-w-2xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Restore Backup"}),e.jsxs(xe,{children:["Created on ",s.created_at," • ",Ia(s.size_bytes)]})]}),o==="initial"&&e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-4 text-red-900 dark:text-red-100 flex gap-3",children:[e.jsx(he,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-1",children:"Warning"}),e.jsx("div",{className:"text-sm opacity-90",children:"Restoring will overwrite existing files and database. This action cannot be undone."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="full"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>c("full"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"h-5 w-5 text-emerald-500"}),e.jsx("h3",{className:"font-semibold",children:"Full Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restore everything: Files, Database, Plugins, and Themes."})]}),e.jsxs("div",{className:`border-2 rounded-lg p-4 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors ${i==="partial"?"border-primary bg-slate-50 dark:bg-slate-900":"border-muted"}`,onClick:()=>c("partial"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ts,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-semibold",children:"Partial Restore"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select specific Plugins or Themes to restore. Database is NOT restored."})]})]})]}),o==="select"&&v&&e.jsxs("div",{className:"py-4",children:[e.jsxs(et,{defaultValue:"plugins",children:[e.jsxs(st,{children:[e.jsxs(Fe,{value:"plugins",children:["Plugins (",v.plugins.length,")"]}),e.jsxs(Fe,{value:"themes",children:["Themes (",v.themes.length,")"]})]}),e.jsx(Me,{value:"plugins",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:v.plugins.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No plugins found in backup."}):e.jsx("div",{className:"space-y-2",children:v.plugins.map(w=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`plugin-${w}`,checked:j.includes(w),onChange:()=>C(w),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(O,{htmlFor:`plugin-${w}`,className:"flex-1 cursor-pointer font-medium",children:w})]},w))})}),e.jsx(Me,{value:"themes",className:"mt-4 max-h-[300px] overflow-y-auto border rounded-md p-2",children:v.themes.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No themes found in backup."}):e.jsx("div",{className:"space-y-2",children:v.themes.map(w=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:[e.jsx("input",{type:"checkbox",id:`theme-${w}`,checked:y.includes(w),onChange:()=>f(w),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(O,{htmlFor:`theme-${w}`,className:"flex-1 cursor-pointer font-medium",children:w})]},w))})})]}),e.jsx("div",{className:"flex justify-between items-center mt-4 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Selected: ",j.length," plugins, ",y.length," themes"]})})]}),o==="restoring"&&e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(_,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Restoring Backup..."}),e.jsxs("p",{className:"text-muted-foreground max-w-sm mx-auto",children:["Please wait while we restore your ",i==="full"?"site":"items",". Do not close this window."]})]}),e.jsxs(tt,{children:[o==="initial"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(b,{onClick:()=>i==="full"?S():P(),disabled:d,children:[d&&e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}),i==="full"?"Start Restore":"Next Step"]})]}),o==="select"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"outline",onClick:()=>m("initial"),children:"Back"}),e.jsxs(b,{onClick:S,disabled:j.length===0&&y.length===0,children:["Start Restore (",j.length+y.length," items)"]})]})]})]})}):null}function Aa(s){return s?new Date(s).toLocaleString():"Unknown"}function Fa(s){const t=typeof s=="string"?parseInt(s):s;if(t===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB","TB"],o=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,o)).toFixed(2))+" "+r[o]}function Ma({refreshTrigger:s}){const[t,a]=n.useState([]),[r,o]=n.useState(!0),[m,i]=n.useState(null),[c,d]=n.useState(null),[x,v]=n.useState(!1),{toast:g}=q(),j=async()=>{o(!0);try{const h=await Rt();a(h)}catch(h){console.error(h)}finally{o(!1)}};n.useEffect(()=>{j()},[s]);const T=async h=>{if(confirm("Permanently delete this backup?")){i(h);try{await It(h.toString()),g({title:"Backup Deleted",description:"The backup has been removed."}),j()}catch{g({title:"Error",description:"Failed to delete backup.",variant:"destructive"})}finally{i(null)}}},y=h=>{d(h),v(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(_a,{backup:c,open:x,onOpenChange:v,onComplete:j}),e.jsxs($,{className:"col-span-3",children:[e.jsxs(L,{children:[e.jsx(U,{children:"Existing Backups"}),e.jsx(Y,{children:"Manage your local backup points."})]}),e.jsx(B,{children:r?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(_,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-muted/20 rounded-lg",children:[e.jsx(be,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No backups found."})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ms,{children:[e.jsx(Os,{children:e.jsxs(Ce,{children:[e.jsx(J,{children:"Date"}),e.jsx(J,{children:"Type"}),e.jsx(J,{children:"Size"}),e.jsx(J,{className:"text-right",children:"Actions"})]})}),e.jsx($s,{children:t.map(h=>e.jsxs(Ce,{children:[e.jsx(Z,{className:"font-medium",children:Aa(h.created_at)}),e.jsx(Z,{className:"capitalize",children:h.type}),e.jsx(Z,{children:Fa(h.size_bytes)}),e.jsxs(Z,{className:"text-right",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>y(h),children:e.jsx(ft,{className:"h-4 w-4 text-blue-500 hover:text-blue-700"})}),e.jsx(b,{variant:"ghost",size:"icon",disabled:m===h.id,onClick:()=>T(h.id),children:m===h.id?e.jsx(_,{className:"h-4 w-4 animate-spin"}):e.jsx(ns,{className:"h-4 w-4 text-red-500 hover:text-red-700"})})]})]},h.id))})]})})})]})]})}function Oa({onNavigate:s}){const[t,a]=n.useState(null),[r,o]=n.useState(!0),[m,i]=n.useState(!1),[c,d]=n.useState(!1),[x,v]=n.useState(!1),[g,j]=n.useState(0),[T,y]=n.useState(0),[h,p]=n.useState(""),[P,S]=n.useState(null),{toast:C}=q(),f=async()=>{try{const u=await Dt();a(u)}catch(u){console.error("Failed to load stats",u)}finally{o(!1)}};n.useEffect(()=>{f(),Gt().then(S).catch(console.error)},[]),n.useEffect(()=>{let u;return m?u=setInterval(async()=>{try{const D=await At();y(D.percent),p(D.message)}catch{}},1e3):(y(0),p("")),()=>clearInterval(u)},[m]);const w=async()=>{i(!0),y(1);try{let u=await Ke(!1);if(u.code)throw new Error(u.message);for(;u.status==="processing";)if(u.percent&&y(u.percent),u.message&&p(u.message),u=await Ke(!0),u.code)throw new Error(u.message);C({title:"Backup Complete",description:"Your local backup was created successfully."}),await f(),j(D=>D+1)}catch(u){console.error(u),C({title:"Backup Failed",description:"There was an error creating your backup.",variant:"destructive"})}finally{i(!1)}};return r?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(_,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Na,{}),e.jsx(ka,{open:c,onOpenChange:d}),e.jsx(Sa,{open:x,onOpenChange:v}),(P==null?void 0:P.has_crash)&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-500/20 p-2 rounded-full",children:e.jsx(he,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-800 dark:text-red-200",children:"Site Issues Detected"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 truncate max-w-lg",children:"Recent errors found in debug.log"})]})]}),e.jsxs(b,{variant:"destructive",size:"sm",onClick:()=>window.open(P.recovery_url,"_blank"),children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Open Recovery Portal"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs($,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Last Backup"}),e.jsx(as,{className:"h-4 w-4 text-emerald-500"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.last_backup)||"Never"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t==null?void 0:t.count)||0," total backups"]})]})]}),e.jsxs($,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Storage Usage"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.total_size)||"0 B"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Local storage used"})]})]}),e.jsxs($,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:m?"Backing up...":"Quick Actions"}),e.jsx(Te,{className:`h-4 w-4 text-muted-foreground ${m?"animate-spin":""}`})]}),e.jsx(B,{className:"flex flex-col gap-2",children:m?e.jsxs("div",{className:"space-y-2 w-full",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{const u=(h||"").toLowerCase();return T>=100?e.jsx(lt,{className:"h-4 w-4 text-emerald-500"}):u.includes("exporting")?e.jsx(xt,{className:"h-4 w-4 text-blue-500 animate-pulse"}):u.includes("scanning")?e.jsx(wt,{className:"h-4 w-4 text-yellow-500 animate-pulse"}):u.includes("archiving")?e.jsx(nt,{className:"h-4 w-4 text-orange-500 animate-pulse"}):u.includes("finalizing")?e.jsx(be,{className:"h-4 w-4 text-purple-500 animate-pulse"}):e.jsx(_,{className:"h-4 w-4 animate-spin text-muted-foreground"})})(),e.jsx("span",{children:h||"Starting..."})]}),e.jsxs("span",{children:[T,"%"]})]}),e.jsx(us,{value:T,className:"h-2"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{size:"sm",onClick:w,children:"Backup Now"}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>s("settings"),children:"Settings"})]})})]}),e.jsxs($,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Safe Update"}),e.jsx(rt,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Updates"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Test updates in sandbox"}),e.jsx(b,{size:"sm",className:"mt-4 w-full h-8 text-xs bg-blue-600 hover:bg-blue-500 text-white",onClick:async()=>{window.sbwpData.isPro?d(!0):window.location.href="/wp-admin/update-core.php"},children:window.sbwpData.isPro?"Test Updates":"Go to Updates"})]})]}),e.jsxs($,{className:window.sbwpData.isPro?"border-orange-500/50 bg-orange-500/5":"opacity-80",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Conflict Scanner"}),window.sbwpData.isPro?e.jsx("span",{className:"text-[10px] bg-orange-500/20 text-orange-500 px-2 py-0.5 rounded-full font-bold",children:"PRO ACTIVE"}):e.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full font-bold",children:"LOCKED"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Diagnose"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Find buggy plugins auto-magically"}),e.jsx(b,{size:"sm",variant:window.sbwpData.isPro?"outline":"secondary",className:"mt-4 w-full h-8 text-xs",onClick:()=>window.sbwpData.isPro&&v(!0),children:window.sbwpData.isPro?"Start Scan":"Get Pro"})]})]})]}),e.jsx(Ma,{refreshTrigger:g})]})}const z=n.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:F("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...a}));z.displayName="Input";function $a({open:s,onOpenChange:t}){const[a,r]=n.useState([]),[o,m]=n.useState(!1),[i,c]=n.useState(null),[d,x]=n.useState(null),[v,g]=n.useState(""),[j,T]=n.useState(""),[y,h]=n.useState({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""}),[p,P]=n.useState(5),S=()=>{m(!0),Promise.all([Ft(),Mt()]).then(([f,w])=>{r(f),w.retention_count&&P(w.retention_count)}).catch(console.error).finally(()=>m(!1))};n.useEffect(()=>{s&&S()},[s]);const C=async f=>{c(f);try{await ge(f,"disconnect"),S()}catch(w){console.error(w)}finally{c(null)}};return e.jsx(ce,{open:s,onOpenChange:t,children:e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Cloud Storage Settings"}),e.jsx(xe,{children:"Connect Google Drive to enable automatic off-site backups."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(O,{className:"text-sm font-medium",children:"Retention Limit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of backups to keep per provider."})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(z,{type:"number",min:"1",max:"100",className:"w-20 text-right h-8",value:p,onChange:f=>{P(parseInt(f.target.value)||5)},onBlur:()=>Ot({retention_count:p})})})]}),o&&a.length===0?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(_,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-4",children:[a.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"No providers available."}),a.map(f=>{var w;return e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-slate-100 dark:bg-slate-800",children:e.jsx(ut,{className:"h-5 w-5 text-slate-500"})}),e.jsxs("div",{className:"grid gap-0.5",children:[e.jsx("div",{className:"font-medium text-sm",children:f.name}),e.jsx("div",{className:"text-[10px] text-muted-foreground uppercase flex items-center gap-1",children:f.connected?e.jsxs("span",{className:"text-emerald-600 flex items-center gap-1",children:["Connected ",((w=f.user_info)==null?void 0:w.email)&&`as ${f.user_info.email}`]}):"Not Connected"})]})]}),f.connected?e.jsx(b,{size:"sm",variant:"outline",onClick:()=>C(f.id),disabled:i===f.id,className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:i===f.id?e.jsx(_,{className:"h-4 w-4 animate-spin"}):"Disconnect"}):e.jsxs(b,{size:"sm",variant:"ghost",onClick:()=>x(d===f.id?null:f.id),children:[d===f.id?"Cancel":"Setup",d===f.id?e.jsx(ct,{className:"ml-2 h-4 w-4"}):e.jsx(dt,{className:"ml-2 h-4 w-4"})]})]}),d===f.id&&f.id==="gdrive"&&!f.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[f.global_creds?e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"rounded-md bg-emerald-50 dark:bg-emerald-900/20 p-3 text-xs text-emerald-800 dark:text-emerald-200 flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"✓ Ready to Connect"}),e.jsx("span",{children:"(Secure configuration active)"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Click below to authorize this site to save backups to ",e.jsx("strong",{children:"YOUR"})," Google Drive account."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-md bg-blue-50 dark:bg-blue-900/20 p-3 text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Setup Instructions:"}),e.jsxs("ol",{className:"list-decimal pl-4 space-y-1",children:[e.jsxs("li",{children:["Create a project in ",e.jsx("a",{href:"https://console.cloud.google.com/projectcreate",target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-600 dark:text-blue-400",children:"Google Cloud Console"}),"."]}),e.jsxs("li",{children:["Add this ",e.jsx("strong",{children:"Authorized Redirect URI"}),":"]})]}),e.jsx("div",{className:"mt-2 flex gap-2",children:e.jsxs("code",{className:"flex-1 bg-white dark:bg-black/20 p-1.5 rounded border font-mono text-[10px] break-all",children:[window.sbwpData.root,"wp-admin/admin-ajax.php?action=sbwp_oauth_callback"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"client_id",children:"Client ID"}),e.jsx(z,{id:"client_id",placeholder:"xxxx.apps.googleusercontent.com",value:v,onChange:u=>g(u.target.value),className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"client_secret",children:"Client Secret"}),e.jsx(z,{id:"client_secret",type:"password",placeholder:"Client Secret",value:j,onChange:u=>T(u.target.value),className:"font-mono text-xs"})]})]}),e.jsxs(b,{className:"w-full",onClick:async()=>{c("gdrive");try{await ge("gdrive","prepare",{client_id:v,client_secret:j});const u=encodeURIComponent(`${window.sbwpData.root}wp-admin/admin-ajax.php?action=sbwp_oauth_callback`),D=encodeURIComponent("https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email"),R=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${v}&redirect_uri=${u}&response_type=code&scope=${D}&access_type=offline&prompt=consent`,A=window.open(R,"sbwp_auth","width=600,height=700"),W=setInterval(()=>{A!=null&&A.closed&&(clearInterval(W),S(),c(null))},1e3);window.addEventListener("message",V=>{var M;((M=V.data)==null?void 0:M.type)==="sbwp_auth_success"&&(clearInterval(W),A==null||A.close(),S(),c(null),x(null))},{once:!0})}catch(u){console.error(u),c(null),alert("Failed to initialize authentication.")}},disabled:i===f.id||!f.global_creds&&(!v||!j),children:[i===f.id?e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ss,{className:"mr-2 h-4 w-4"}),f.global_creds?"Connect YOUR Google Drive":"Connect Google Drive"]})]}),d===f.id&&["aws","do_spaces","wasabi"].includes(f.id)&&!f.connected&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-4 animate-in slide-in-from-top-2 fade-in duration-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Access Key"}),e.jsx(z,{value:y.accessKey,onChange:u=>h({...y,accessKey:u.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Secret Key"}),e.jsx(z,{value:y.secretKey,onChange:u=>h({...y,secretKey:u.target.value}),type:"password",className:"font-mono text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Bucket Name"}),e.jsx(z,{value:y.bucket,onChange:u=>h({...y,bucket:u.target.value}),type:"text",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Region"}),e.jsx(z,{value:y.region,onChange:u=>h({...y,region:u.target.value}),placeholder:f.id==="do_spaces"?"nyc3":"us-east-1",type:"text",className:"font-mono text-xs"})]})]}),e.jsx(b,{className:"w-full",disabled:i===f.id||!y.accessKey||!y.secretKey||!y.bucket,onClick:async()=>{c(f.id);try{await ge(f.id,"connect",{access_key:y.accessKey,secret_key:y.secretKey,bucket:y.bucket,region:y.region||"us-east-1",endpoint:y.endpoint}),S(),x(null),h({accessKey:"",secretKey:"",region:"",bucket:"",endpoint:""})}catch(u){console.error(u),alert(u.message||"Connection failed")}finally{c(null)}},children:i===f.id?e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}):"Connect Storage"})]})]},f.id)})]})]})]})})}function La({onBack:s,onNavigate:t}){const[a,r]=n.useState({retention_limit:5}),[o,m]=n.useState(null),[i,c]=n.useState(null),[d,x]=n.useState(""),[v,g]=n.useState(""),[j,T]=n.useState(!0),[y,h]=n.useState(!1),[p,P]=n.useState(!1),[S,C]=n.useState(!1),[f,w]=n.useState(!1),[u,D]=n.useState(!1),{toast:R}=q();n.useEffect(()=>{Promise.all([$t().then(r),window.sbwpData.isPro?zt().then(m):Promise.resolve(),Wt().then(c)]).catch(console.error).finally(()=>T(!1))},[]);const A=async()=>{i!=null&&i.url&&(await at(i.url)?(D(!0),setTimeout(()=>D(!1),2e3),R({title:"Copied!",description:"Recovery URL copied to clipboard."})):R({title:"Copy Failed",description:"Please copy the URL manually.",variant:"destructive"}))},W=async()=>{C(!0);try{const l=await Xt(v);c(l),g(""),R({title:v?"PIN Set":"PIN Removed",description:v?"Your recovery PIN has been saved.":"Your recovery PIN has been removed."})}catch{R({title:"Error",description:"Failed to save PIN.",variant:"destructive"})}finally{C(!1)}},V=async()=>{if(confirm("Are you sure? This will invalidate your old recovery URL.")){C(!0);try{const l=await Ht();c(l),R({title:"Key Regenerated",description:"Your recovery URL has been updated."})}catch{R({title:"Error",description:"Failed to regenerate key.",variant:"destructive"})}finally{C(!1)}}},M=async()=>{P(!0);try{const l=await We(d);m(l),x(""),R({title:"API Key Saved",description:"Your OpenAI API key has been saved."})}catch{R({title:"Error",description:"Failed to save API key.",variant:"destructive"})}finally{P(!1)}},H=async()=>{P(!0);try{const l=await We("");m(l),R({title:"API Key Removed",description:"Your OpenAI API key has been removed."})}catch{R({title:"Error",description:"Failed to remove API key.",variant:"destructive"})}finally{P(!1)}},N=async()=>{h(!0);try{await Lt(a),R({title:"Settings Saved",description:"Your settings have been updated."})}catch{R({title:"Error",description:"Failed to save settings.",variant:"destructive"})}finally{h(!1)}};return j?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(_,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx($a,{open:f,onOpenChange:w}),e.jsxs(b,{variant:"ghost",className:"pl-0 gap-2",onClick:s,children:[e.jsx(es,{className:"h-4 w-4"}),"Back to Dashboard"]}),e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Configuration"}),e.jsxs($,{children:[e.jsxs(L,{children:[e.jsx(U,{children:"General Settings"}),e.jsx(Y,{children:"Configure how SafeBackup handles your data."})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(O,{htmlFor:"retention",children:"Local Backup Retention"}),e.jsx(z,{id:"retention",type:"number",min:1,max:50,value:a.retention_limit,onChange:l=>r(k=>({...k,retention_limit:parseInt(l.target.value)||1}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of local backups to keep. Oldest backups will be deleted automatically when this limit is reached."})]}),e.jsxs(b,{onClick:N,disabled:y,children:[y&&e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs($,{className:window.sbwpData.isPro?"border-emerald-500/50 bg-emerald-500/5":"opacity-80",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Cloud Storage"}),window.sbwpData.isPro?e.jsx("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold",children:"PRO ACTIVE"}):e.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full font-bold",children:"FREE"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:window.sbwpData.isPro?"Configure":"Locked"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:window.sbwpData.isPro?"Connect to Google Drive / S3":"Upgrade to enable Cloud Backups"}),window.sbwpData.isPro?e.jsx(b,{size:"sm",variant:"outline",className:"mt-4 w-full h-8 text-xs",onClick:()=>w(!0),children:"Configure Cloud"}):e.jsx(b,{size:"sm",variant:"secondary",className:"mt-4 w-full h-8 text-xs",children:"Get Pro"})]})]}),window.sbwpData.isPro&&e.jsxs($,{className:"border-emerald-500/50 bg-emerald-500/5",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Scheduled Backups"}),e.jsx("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold",children:"PRO ACTIVE"})]}),e.jsxs(B,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"Manage"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Automated daily/weekly backups"}),e.jsx(b,{size:"sm",variant:"outline",className:"mt-4 w-full h-8 text-xs",onClick:()=>t("schedules"),children:"Configure Schedules"})]})]})]}),e.jsxs($,{className:window.sbwpData.isPro?"border-violet-500/50 bg-violet-500/5":"opacity-80",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-violet-500"}),e.jsx(U,{children:"AI Assistant"})]}),window.sbwpData.isPro?o!=null&&o.is_configured?e.jsxs("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold flex items-center gap-1",children:[e.jsx(Le,{className:"h-3 w-3"})," CONNECTED"]}):e.jsx("span",{className:"text-[10px] bg-amber-500/20 text-amber-600 px-2 py-0.5 rounded-full font-bold",children:"NOT CONFIGURED"}):e.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded-full font-bold",children:"PRO"})]}),e.jsx(Y,{children:"Use AI to explain update test results in plain language."})]}),e.jsx(B,{className:"space-y-4",children:window.sbwpData.isPro?e.jsx(e.Fragment,{children:o!=null&&o.is_configured?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-md",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"OpenAI API Key"}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:o.masked_key})]}),e.jsx(b,{size:"sm",variant:"ghost",className:"text-red-500 hover:text-red-600 hover:bg-red-50",onClick:H,disabled:p,children:p?e.jsx(_,{className:"h-4 w-4 animate-spin"}):e.jsx(yt,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"openai-key",children:"OpenAI API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{id:"openai-key",type:"password",placeholder:"sk-...",value:d,onChange:l=>x(l.target.value)}),e.jsx(b,{onClick:M,disabled:p||!d,children:p?e.jsx(_,{className:"h-4 w-4 animate-spin"}):"Save"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Get your API key from ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-violet-500 hover:underline",children:"platform.openai.com"})]})]})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upgrade to Pro to use AI-powered features like plain-language update reports."})})]}),e.jsxs($,{className:"border-orange-500/50 bg-orange-500/5",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"h-5 w-5 text-orange-500"}),e.jsx(U,{children:"Recovery Portal"})]}),(i==null?void 0:i.has_pin)&&e.jsxs("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-500 px-2 py-0.5 rounded-full font-bold flex items-center gap-1",children:[e.jsx(ht,{className:"h-3 w-3"})," PIN PROTECTED"]})]}),e.jsx(Y,{children:"Access this URL to recover your site if WordPress crashes."})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:"Recovery URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{value:(i==null?void 0:i.url)||"",readOnly:!0,className:"font-mono text-xs bg-slate-50"}),e.jsx(b,{variant:"outline",size:"icon",onClick:A,children:u?e.jsx(Le,{className:"h-4 w-4 text-emerald-500"}):e.jsx(mt,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Save this URL somewhere safe! It works even when WordPress is broken."})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsx(O,{children:i!=null&&i.has_pin?"Change or Remove PIN":"Set Optional PIN"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{type:"password",placeholder:i!=null&&i.has_pin?"New PIN (or leave empty to remove)":"Enter a PIN (optional)",value:v,onChange:l=>g(l.target.value)}),e.jsx(b,{onClick:W,disabled:S,variant:i!=null&&i.has_pin&&!v?"destructive":"default",children:S?e.jsx(_,{className:"h-4 w-4 animate-spin"}):i!=null&&i.has_pin&&!v?"Remove":"Save"})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs(b,{variant:"ghost",size:"sm",className:"text-muted-foreground",onClick:V,disabled:S,children:[e.jsx(Te,{className:"h-3 w-3 mr-2"}),"Regenerate Recovery Key"]})})]})]})]})}function Ua({onBack:s}){const[t,a]=n.useState([]),[r,o]=n.useState(!1),[m,i]=n.useState(!1),{toast:c}=q(),d=async()=>{o(!0);try{const j=await(await fetch(`${window.sbwpData.restUrl}/schedules`,{headers:{"X-WP-Nonce":window.sbwpData.nonce}})).json();a(j)}catch(g){console.error(g)}finally{o(!1)}};n.useEffect(()=>{d()},[]);const x=async g=>{i(!0);try{(await fetch(`${window.sbwpData.restUrl}/schedules`,{method:"POST",headers:{"X-WP-Nonce":window.sbwpData.nonce,"Content-Type":"application/json"},body:JSON.stringify({frequency:g,time:"00:00"})})).ok&&(c({title:"Schedule Created",description:`New ${g} schedule added.`}),d())}catch{c({title:"Error",variant:"destructive",description:"Failed to create schedule."})}finally{i(!1)}},v=async g=>{if(confirm("Delete this schedule?"))try{await fetch(`${window.sbwpData.restUrl}/schedules/${g}`,{method:"DELETE",headers:{"X-WP-Nonce":window.sbwpData.nonce}}),c({title:"Schedule Deleted"}),d()}catch{c({title:"Error",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(b,{variant:"ghost",size:"sm",onClick:s,children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Scheduled Backups"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your automated backup routines."})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs($,{children:[e.jsxs(L,{children:[e.jsx(U,{children:"Create Schedule"}),e.jsx(Y,{children:"Add a new automated backup task."})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs(b,{className:"w-full justify-start",onClick:()=>x("daily"),disabled:m,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Add Daily Backup"]}),e.jsxs(b,{className:"w-full justify-start",variant:"secondary",onClick:()=>x("weekly"),disabled:m,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Add Weekly Backup"]})]})]}),e.jsxs($,{children:[e.jsxs(L,{children:[e.jsx(U,{children:"Active Schedules"}),e.jsx(Y,{children:"Your currently running backup jobs."})]}),e.jsx(B,{children:r?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(_,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No active schedules."}):e.jsx("div",{className:"space-y-2",children:t.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(it,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium capitalize",children:[g.frequency," Backup"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Next run: calculated by WP Cron"})]})]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>v(g.id),children:e.jsx(ns,{className:"h-4 w-4 text-red-500"})})]},g.id))})})]})]})]})}function Ge(){const[s,t]=n.useState("dashboard");return e.jsx("div",{className:"min-h-screen bg-background p-8 font-sans antialiased text-foreground",children:e.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"SafeBackup & Repair"}),e.jsx("div",{className:"flex items-center gap-2",children:window.sbwpData.isPro?e.jsx("span",{className:"text-xs font-medium text-emerald-600 bg-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-400 px-2 py-1 rounded-full border border-emerald-200 dark:border-emerald-800",children:"Pro Active"}):e.jsx("span",{className:"text-xs font-medium text-slate-600 bg-slate-100 dark:bg-slate-900/30 dark:text-slate-400 px-2 py-1 rounded-full border border-slate-200 dark:border-slate-800",children:"Free Edition"})})]}),s==="dashboard"&&e.jsx(Oa,{onNavigate:t}),s==="settings"&&e.jsx(La,{onBack:()=>t("dashboard"),onNavigate:t}),s==="schedules"&&e.jsx(Ua,{onBack:()=>t("dashboard")})]})})}const Ye=document.getElementById("sbwp-admin-root");if(Ye)Oe.createRoot(Ye).render(e.jsx($e.StrictMode,{children:e.jsx(Ge,{})}));else{const s=document.getElementById("root");s&&Oe.createRoot(s).render(e.jsx($e.StrictMode,{children:e.jsx(Ge,{})}))}
